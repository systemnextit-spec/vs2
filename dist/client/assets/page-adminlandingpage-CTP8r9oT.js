import{j as r}from"./react-jsx-runtime-BBsywpoz.js";import{r as n}from"./react-core-KcGD0Z1V.js";import{a as q,D as E,c as b}from"./cmp-dashboard-CvCpAVHs.js";import{O as I}from"./cmp-offerpagemanager-tsx-CBSMHtls.js";import{O as L}from"./cmp-offerpagebuilder-tsx-CGlbnWvD.js";import{O}from"./cmp-offerlandingpage-tsx-C_ZWcrO-.js";import{C as D}from"./cmp-createlandingpageform-tsx-CDZzsz-O.js";import{aW as N,X as T}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";import"./pkg-socket-B8R9XNBE.js";import"./pkg-engine-io-C8bqYME4.js";import"./pkg-@socket.io-component-emitter-B3A4JZne.js";import"./pkg-socket.io-parser-C0hgSYjy.js";import"./cmp-approutes-tsx-T9J5ygBG.js";import"./cmp-skeletonloaders-tsx-Durrj7lG.js";import"./cmp-addnewduemodal-tsx-OjU2U-0e.js";import"./cmp-admincustomization-DQ3Wytgo.js";import"./pkg-toast-Dpd4iwUK.js";import"./pkg-goober-N6sOClW1.js";import"./cmp-gallerypicker-tsx-CnyOus4y.js";import"./cmp-modern-dashboard-C6grFkCj.js";import"./cmp-invoiceprinttemplate-tsx-CUwUe6zE.js";import"./pkg-papaparse-BEpmA8em.js";import"./pkg-xlsx-BljOZNTS.js";import"./page-adminnote-C1Ob2d7z.js";import"./cmp-duehistorymodal-tsx-KQ79TbYj.js";const se=({tenantSubdomain:h=""})=>{const{activeTenantId:i}=q(),[l,s]=n.useState("list"),m=h;console.log("[AdminLandingPage] Using subdomain from prop:",m,"for tenant:",i);const[x,a]=n.useState(null),[p,u]=n.useState(null),[d,f]=n.useState([]),[v,P]=n.useState(0);n.useEffect(()=>{(async()=>{if(i)try{const o=await E.getProducts(i);f(o||[])}catch(o){console.error("Error fetching products:",o),f([])}})()},[i]);const y=()=>{a(null),s("create")},S=e=>{a(e),s("edit")},j=e=>{u(e),s("preview")},g=()=>{s("list"),a(null),P(e=>e+1)},C=async e=>{try{if(!e.productTitle||!e.productTitle.trim())throw new Error("Product title is required");if(!e.imageUrl||!e.imageUrl.trim())throw new Error("Main image is required");if(!e.description||!e.description.trim())throw new Error("Description is required");const o=e.urlSlug?.trim()||e.productTitle.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")+"-"+Date.now().toString(36).slice(-6),w={productId:e.productId||void 0,productTitle:e.productTitle.trim(),searchQuery:"",imageUrl:e.imageUrl.trim(),offerEndDate:e.offerEndDate||new Date(Date.now()+720*60*60*1e3).toISOString(),description:e.description.trim(),productOfferInfo:e.productOfferInfo||"",paymentSectionTitle:e.paymentSectionTitle||"",whyBuySection:e.whyBuySection||"",urlSlug:o,status:e.status,benefits:(e.benefits||[]).filter(t=>t.text?.trim()).map(t=>({id:t.id,text:t.text.trim()})),price:e.price,originalPrice:e.originalPrice,faqHeadline:e.faqHeadline||"",faqs:(e.faqs||[]).filter(t=>t.question?.trim()&&t.answer?.trim()).map(t=>({id:t.id,question:t.question.trim(),answer:t.answer.trim()})),reviewHeadline:e.reviewHeadline||"",reviews:(e.reviews||[]).filter(t=>t.name?.trim()&&t.quote?.trim()).map(t=>({id:t.id,name:t.name.trim(),quote:t.quote.trim(),rating:t.rating||5})),videoLink:e.videoLink||"",productImages:(e.productImages||[]).filter(t=>t?.trim()),backgroundColor:e.backgroundColor||"#FFFFFF",textColor:e.textColor||"#000000"};console.log("[AdminLandingPage] Creating page with data:",w),await b(i,w),g()}catch(o){throw console.error("Error creating landing page:",o),o}},c=()=>{s("list"),a(null),u(null)};return i?l==="preview"&&p?r.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-auto",children:[r.jsxs("div",{className:"sticky top-0 z-10 bg-gray-900 text-white p-3 flex items-center justify-between",children:[r.jsxs("button",{onClick:c,className:"flex items-center gap-2 text-gray-300 hover:text-white",children:[r.jsx(N,{size:20}),"Back to List"]}),r.jsx("span",{className:"text-sm text-gray-400",children:"Preview Mode"}),r.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-800 rounded",children:r.jsx(T,{size:20})})]}),r.jsx(O,{offerPage:p})]}):l==="create"?r.jsx(D,{products:d,tenantId:i,onSave:C,onCancel:c}):l==="edit"?r.jsx(L,{tenantId:i,products:d,editingPage:x,onSave:g,onCancel:c}):r.jsx(I,{tenantId:i,tenantSubdomain:m,onCreateNew:y,onEdit:S,onPreview:j},v):r.jsx("div",{className:"flex items-center justify-center h-full",children:r.jsx("p",{className:"text-gray-400",children:"Please select a tenant"})})};export{se as default};
