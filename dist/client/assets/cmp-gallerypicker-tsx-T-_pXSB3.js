import{j as e}from"./react-jsx-runtime-BBsywpoz.js";import{r}from"./react-core-KcGD0Z1V.js";import{D as O}from"./cmp-dashboard-CwyHj6aR.js";import{n as m}from"./cmp-admincustomization-BgTFiuh2.js";import{I as V,X as P,S as W,G as X,aF as Y,aG as B,aH as K,aI as Q,F as ee,aJ as N,aj as te,C as se,b as ae}from"./icons-chunk-AVFeydwE.js";const E=[],de=({isOpen:j,onClose:p,onSelect:k,multiple:c=!1,onSelectMultiple:C,title:M="Choose from Gallery"})=>{const[g,S]=r.useState([]),[F,z]=r.useState(!0),[u,A]=r.useState(""),[l,f]=r.useState([]),[b,D]=r.useState("All"),[v,$]=r.useState("grid"),[d,y]=r.useState("newest"),[o,h]=r.useState(null),[Z,I]=r.useState(null),[w,x]=r.useState(!1);r.useEffect(()=>{if(!j)return;(async()=>{z(!0);try{const s=await O.get("gallery",E);S(s)}catch(s){console.warn("Failed to load gallery:",s),S(E)}finally{z(!1)}})(),f([]),A(""),h(null)},[j]),r.useEffect(()=>{const t=()=>x(!1);if(w)return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[w]);const T=r.useMemo(()=>["All",...Array.from(new Set(g.map(t=>t.category)))],[g]),i=r.useMemo(()=>{let t=g.filter(s=>{const a=s.title.toLowerCase().includes(u.toLowerCase())||s.category.toLowerCase().includes(u.toLowerCase()),n=b==="All"||s.category===b;return a&&n});switch(d){case"newest":t=[...t].reverse();break;case"oldest":break;case"name-asc":t=[...t].sort((s,a)=>s.title.localeCompare(a.title));break;case"name-desc":t=[...t].sort((s,a)=>a.title.localeCompare(s.title));break}return t},[g,u,b,d]);if(!j)return null;const L=t=>{const s=m(t);c?f(a=>a.includes(s)?a.filter(n=>n!==s):[...a,s]):(k(s),p())},H=()=>{c&&C?C(l.map(t=>m(t))):l.length===1&&k(m(l[0])),p()},R=(t,s)=>{t.stopPropagation(),h(s)},U=t=>{if(!o)return;const s=i.findIndex(n=>n.id===o.id);let a=t==="next"?s+1:s-1;a<0&&(a=i.length-1),a>=i.length&&(a=0),h(i[a])},_=()=>{f(i.map(t=>m(t.imageUrl)))},q=()=>{f([])},G=v==="large"?"grid-cols-2 sm:grid-cols-2 md:grid-cols-3":"grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/70 backdrop-blur-md p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] flex flex-col overflow-hidden animate-in fade-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 bg-gradient-to-r from-violet-50 via-purple-50 to-indigo-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl shadow-lg shadow-purple-500/25",children:e.jsx(V,{size:22,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:M}),e.jsxs("p",{className:"text-sm text-gray-500",children:[g.length," images â€¢ ",i.length," showing"]})]})]}),e.jsx("button",{onClick:p,className:"p-2.5 hover:bg-white rounded-xl transition text-gray-500 hover:text-gray-700 hover:shadow-md",children:e.jsx(P,{size:22})})]}),e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50/50 space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(W,{size:18,className:"absolute left-3.5 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name or category...",value:u,onChange:t=>A(t.target.value),className:"w-full pl-11 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm shadow-sm"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:[e.jsx("button",{onClick:()=>$("grid"),className:`p-3 transition-colors ${v==="grid"?"bg-purple-100 text-purple-600":"text-gray-500 hover:bg-gray-50"}`,title:"Compact Grid",children:e.jsx(X,{size:18})}),e.jsx("button",{onClick:()=>$("large"),className:`p-3 transition-colors ${v==="large"?"bg-purple-100 text-purple-600":"text-gray-500 hover:bg-gray-50"}`,title:"Large Grid",children:e.jsx(Y,{size:18})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:t=>{t.stopPropagation(),x(!w)},className:"flex items-center gap-2 px-4 py-3 bg-white border border-gray-200 rounded-xl text-sm text-gray-600 hover:bg-gray-50 shadow-sm",children:[d.includes("asc")||d==="oldest"?e.jsx(B,{size:16}):e.jsx(K,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Sort"})]}),w&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 bg-white border border-gray-200 rounded-xl shadow-xl py-2 min-w-[160px] z-50 animate-in fade-in slide-in-from-to p-2 duration-200",children:[e.jsx("button",{onClick:()=>{y("newest"),x(!1)},className:`w-full px-4 py-2.5 text-left text-sm hover:bg-purple-50 ${d==="newest"?"text-purple-600 bg-purple-50 font-medium":"text-gray-700"}`,children:"Newest First"}),e.jsx("button",{onClick:()=>{y("oldest"),x(!1)},className:`w-full px-4 py-2.5 text-left text-sm hover:bg-purple-50 ${d==="oldest"?"text-purple-600 bg-purple-50 font-medium":"text-gray-700"}`,children:"Oldest First"}),e.jsx("hr",{className:"my-1"}),e.jsx("button",{onClick:()=>{y("name-asc"),x(!1)},className:`w-full px-4 py-2.5 text-left text-sm hover:bg-purple-50 ${d==="name-asc"?"text-purple-600 bg-purple-50 font-medium":"text-gray-700"}`,children:"Name A-Z"}),e.jsx("button",{onClick:()=>{y("name-desc"),x(!1)},className:`w-full px-4 py-2.5 text-left text-sm hover:bg-purple-50 ${d==="name-desc"?"text-purple-600 bg-purple-50 font-medium":"text-gray-700"}`,children:"Name Z-A"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-1 scrollbar-none",children:[e.jsx(Q,{size:16,className:"text-gray-400 flex-shrink-0"}),T.map(t=>e.jsx("button",{onClick:()=>D(t),className:`px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap ${b===t?"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-md shadow-purple-500/25":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-200"}`,children:t},t))]}),c&&i.length>0&&e.jsxs("div",{className:"flex items-center gap-4 pt-2",children:[e.jsxs("button",{onClick:_,className:"text-sm text-purple-600 hover:text-purple-700 font-medium",children:["Select All (",i.length,")"]}),l.length>0&&e.jsx("button",{onClick:q,className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear Selection"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-gradient-to-b from-gray-50 to-white",children:F?e.jsx("div",{className:`grid ${G} gap-4`,children:Array(12).fill(0).map((t,s)=>e.jsx("div",{className:"aspect-square bg-gradient-to-br from-gray-200 to-gray-100 rounded-xl animate-pulse"},s))}):i.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400",children:[e.jsx("div",{className:"p-6 bg-gray-100 rounded-full mb-4",children:e.jsx(ee,{size:48,className:"opacity-50"})}),e.jsx("p",{className:"font-semibold text-gray-600",children:"No images found"}),e.jsx("p",{className:"text-sm mt-1",children:"Try a different search term or category"})]}):e.jsx("div",{className:`grid ${G} gap-4`,children:i.map((t,s)=>{const a=l.includes(t.imageUrl),n=Z===String(t.id);return e.jsxs("div",{onClick:()=>L(t.imageUrl),onMouseEnter:()=>I(String(t.id)),onMouseLeave:()=>I(null),className:`group relative aspect-square rounded-xl overflow-hidden cursor-pointer transition-all duration-300 ${a?"ring-4 ring-purple-500 ring-offset-2 scale-[0.97] shadow-xl shadow-purple-500/25":"hover:ring-2 hover:ring-purple-300 hover:shadow-lg"}`,style:{animationDelay:`${s*30}ms`},children:[e.jsx("img",{src:m(t.imageUrl),alt:t.title,className:`w-full h-full object-cover transition-transform duration-500 ${n?"scale-110":"scale-100"}`,loading:"lazy"}),e.jsx("div",{className:`absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent transition-opacity duration-300 ${a||n?"opacity-100":"opacity-0"}`}),e.jsx("div",{className:`absolute to p-3 right-3 transition-all duration-300 ${a?"scale-100 opacity-100":"scale-0 opacity-0"}`,children:e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-full p-2 shadow-lg",children:e.jsx(N,{size:14,strokeWidth:3})})}),c&&a&&e.jsx("div",{className:"absolute to p-3 left-3 bg-white text-purple-600 text-xs font-bold w-6 h-6 rounded-full flex items-center justify-center shadow-lg",children:l.indexOf(t.imageUrl)+1}),e.jsx("div",{className:`absolute to p-3 right-3 flex gap-1.5 transition-all duration-300 ${!a&&n?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:e.jsx("button",{onClick:J=>R(J,t),className:"p-2 bg-white/95 rounded-lg text-gray-700 hover:bg-white shadow-lg transition-colors",title:"Preview",children:e.jsx(te,{size:14})})}),e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 p-3 transition-all duration-300 ${a||n?"translate-y-0 opacity-100":"translate-y-full opacity-0"}`,children:[e.jsx("p",{className:"text-white text-sm font-semibold truncate drop-shadow-lg",children:t.title}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx("span",{className:"px-2 py-0.5 bg-white/20 backdrop-blur-sm rounded-full text-white/90 text-[10px] font-medium",children:t.category})})]})]},t.id)})})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("p",{className:"text-sm text-gray-500",children:c?l.length>0?e.jsxs("span",{className:"font-medium text-purple-600",children:[l.length," image",l.length!==1?"s":""," selected"]}):"Click images to select":"Click an image to select"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:p,className:"px-5 py-2.5 text-gray-600 hover:bg-gray-100 rounded-xl transition font-medium text-sm",children:"Cancel"}),c&&e.jsxs("button",{onClick:H,disabled:l.length===0,className:"px-6 py-2.5 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl font-medium text-sm hover:from-purple-700 hover:to-indigo-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg shadow-purple-500/25 disabled:shadow-none",children:[e.jsx(N,{size:16}),"Add Selected ",l.length>0&&`(${l.length})`]})]})]})]})}),o&&e.jsxs("div",{className:"fixed inset-0 z-[250] flex items-center justify-center bg-black/95 p-4",onClick:()=>h(null),children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),U("prev")},className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors z-10",children:e.jsx(se,{size:28})}),e.jsx("button",{onClick:t=>{t.stopPropagation(),U("next")},className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors z-10",children:e.jsx(ae,{size:28})}),e.jsxs("div",{className:"relative max-w-5xl max-h-[85vh] animate-in fade-in zoom-in-95 duration-300",children:[e.jsx("img",{src:m(o.imageUrl),alt:o.title,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl",onClick:t=>t.stopPropagation()}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/90 to-transparent rounded-b-lg",children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold text-lg",children:o.title}),e.jsx("p",{className:"text-white/70 text-sm",children:o.category})]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),L(o.imageUrl)},className:`px-4 py-2 rounded-lg font-medium text-sm transition-all ${l.includes(o.imageUrl)?"bg-purple-600 text-white":"bg-white text-gray-800 hover:bg-gray-100"}`,children:l.includes(o.imageUrl)?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(N,{size:16})," Selected"]}):"Select"})]})})]}),e.jsx("button",{onClick:()=>h(null),className:"absolute to p-4 right-4 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",children:e.jsx(P,{size:24})})]})]})};export{de as G};
