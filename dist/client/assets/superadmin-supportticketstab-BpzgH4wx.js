import{j as e}from"./react-jsx-runtime-BBsywpoz.js";import{r as o}from"./react-core-KcGD0Z1V.js";import{cd as w,S as E,aR as M,c9 as O,aV as W,bi as U,ce as H,ah as C,aO as j,Y as T,a9 as G,bk as S,X as Q,aB as z,bI as D,v as V,aS as X,r as Y,N as J}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";const g={bug:{label:"Bug Report",icon:H,color:"bg-red-100 text-red-700 border-red-200"},feature_request:{label:"Feature Request",icon:U,color:"bg-purple-100 text-purple-700 border-purple-200"},billing:{label:"Billing",icon:W,color:"bg-green-100 text-green-700 border-green-200"},technical:{label:"Technical",icon:O,color:"bg-blue-100 text-blue-700 border-blue-200"},general:{label:"General",icon:M,color:"bg-slate-100 text-slate-700 border-slate-200"}},b={low:{label:"Low",color:"bg-slate-100 text-slate-600"},medium:{label:"Medium",color:"bg-blue-100 text-blue-600"},high:{label:"High",color:"bg-orange-100 text-orange-600"},urgent:{label:"Urgent",color:"bg-red-100 text-red-600"}},K={open:{label:"Open",color:"bg-blue-100 text-blue-600",icon:G},in_progress:{label:"In Progress",color:"bg-yellow-100 text-yellow-600",icon:T},waiting_response:{label:"Waiting Response",color:"bg-purple-100 text-purple-600",icon:j},resolved:{label:"Resolved",color:"bg-green-100 text-green-600",icon:C},closed:{label:"Closed",color:"bg-slate-100 text-slate-600",icon:C}},te=({tickets:r,tenants:Z,onUpdateTicket:f,onReplyTicket:R,onCloseTicket:F})=>{const[i,A]=o.useState(""),[x,P]=o.useState("all"),[p,_]=o.useState("all"),[u,B]=o.useState("all"),[l,m]=o.useState(null),[d,N]=o.useState(""),[L,v]=o.useState(!1),y=r.filter(s=>{const a=s.subject.toLowerCase().includes(i.toLowerCase())||s.description.toLowerCase().includes(i.toLowerCase())||s.tenantName.toLowerCase().includes(i.toLowerCase()),t=x==="all"||s.status===x,c=p==="all"||s.category===p,h=u==="all"||s.priority===u;return a&&t&&c&&h}),$=async()=>{if(!(!l||!d.trim())){v(!0);try{await R(l.id,{senderId:"superadmin",senderName:"Support Team",senderType:"support",message:d}),N("")}catch(s){console.error("Failed to send reply:",s)}finally{v(!1)}}},q=async(s,a)=>{try{await f(s,{status:a}),l?.id===s&&m(t=>t?{...t,status:a}:null)}catch(t){console.error("Failed to update status:",t)}},I=async(s,a)=>{try{await f(s,{assignedTo:a,status:"in_progress"})}catch(t){console.error("Failed to assign ticket:",t)}},n={total:r.length,open:r.filter(s=>s.status==="open").length,inProgress:r.filter(s=>s.status==="in_progress").length,waiting:r.filter(s=>s.status==="waiting_response").length,resolved:r.filter(s=>s.status==="resolved"||s.status==="closed").length,urgent:r.filter(s=>s.priority==="urgent"&&s.status!=="resolved"&&s.status!=="closed").length};return e.jsxs("div",{className:"p-6 flex gap-3 sm:gap-4 lg:gap-6 h-[calc(100vh-64px)]",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(w,{className:"w-7 h-7 text-emerald-500"}),"Support Tickets"]}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Manage merchant support requests and feature requests"})]}),e.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-slate-800",children:n.total}),e.jsx("p",{className:"text-xs text-slate-500",children:"Total"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:n.open}),e.jsx("p",{className:"text-xs text-blue-600",children:"Open"})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3 border border-yellow-200 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:n.inProgress}),e.jsx("p",{className:"text-xs text-yellow-600",children:"In Progress"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 border border-purple-200 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:n.waiting}),e.jsx("p",{className:"text-xs text-purple-600",children:"Waiting"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 border border-green-200 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.resolved}),e.jsx("p",{className:"text-xs text-green-600",children:"Resolved"})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3 border border-red-200 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:n.urgent}),e.jsx("p",{className:"text-xs text-red-600",children:"Urgent"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(E,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search tickets...",value:i,onChange:s=>A(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500"})]}),e.jsxs("select",{value:x,onChange:s=>P(s.target.value),className:"px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"waiting_response",children:"Waiting Response"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("select",{value:p,onChange:s=>_(s.target.value),className:"px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"bug",children:"Bug Reports"}),e.jsx("option",{value:"feature_request",children:"Feature Requests"}),e.jsx("option",{value:"billing",children:"Billing"}),e.jsx("option",{value:"technical",children:"Technical"}),e.jsx("option",{value:"general",children:"General"})]}),e.jsxs("select",{value:u,onChange:s=>B(s.target.value),className:"px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20",children:[e.jsx("option",{value:"all",children:"All Priority"}),e.jsx("option",{value:"urgent",children:"Urgent"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]}),e.jsx("div",{className:"flex-1 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:y.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(w,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-2",children:"No tickets found"}),e.jsx("p",{className:"text-slate-500",children:"No support tickets match your filters"})]}):e.jsx("div",{className:"overflow-y-auto max-h-[calc(100vh-380px)]",children:y.map(s=>{const a=g[s.category],t=b[s.priority],c=K[s.status],h=c.icon;return e.jsx("div",{onClick:()=>m(s),className:`p-4 border-b border-slate-100 hover:bg-slate-50 cursor-pointer transition-colors ${l?.id===s.id?"bg-emerald-50 border-l-4 border-l-emerald-500":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${a.color}`,children:e.jsx(a.icon,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${t.color}`,children:t.label}),e.jsxs("span",{className:`px-2 py-0.5 text-xs rounded-full flex items-center gap-1 ${c.color}`,children:[e.jsx(h,{className:"w-3 h-3"}),c.label]})]}),e.jsx("h4",{className:"font-semibold text-slate-800 truncate",children:s.subject}),e.jsx("p",{className:"text-sm text-slate-600 line-clamp-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(S,{className:"w-3 h-3"}),s.tenantName]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),s.createdAt]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"w-3 h-3"}),s.messages.length]})]})]})]})},s.id)})})})]}),l?e.jsxs("div",{className:"w-[450px] bg-white rounded-xl border border-slate-200 shadow-sm flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full border ${g[l.category].color}`,children:g[l.category].label}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${b[l.priority].color}`,children:b[l.priority].label})]}),e.jsx("h3",{className:"font-bold text-slate-800",children:l.subject})]}),e.jsx("button",{onClick:()=>m(null),className:"p-1 hover:bg-slate-100 rounded",children:e.jsx(Q,{className:"w-5 h-5 text-slate-400"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-3 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-slate-600",children:[e.jsx(S,{className:"w-4 h-4"}),l.tenantName]}),e.jsxs("span",{className:"flex items-center gap-1 text-slate-600",children:[e.jsx(z,{className:"w-4 h-4"}),l.createdAt]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsxs("select",{value:l.status,onChange:s=>q(l.id,s.target.value),className:"flex-1 px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20",children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"waiting_response",children:"Waiting Response"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("button",{onClick:()=>I(l.id,"Support Team"),className:"flex items-center gap-1 px-3 py-2 text-sm bg-emerald-50 text-emerald-700 rounded-lg hover:bg-emerald-100 transition-colors",children:[e.jsx(D,{className:"w-4 h-4"}),"Assign"]})]})]}),e.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[e.jsx("p",{className:"text-sm text-slate-600",children:l.description}),l.tags&&l.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-3",children:l.tags.map(s=>e.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-slate-200 text-slate-600 text-xs rounded",children:[e.jsx(V,{className:"w-3 h-3"}),s]},s))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:l.messages.map(s=>e.jsx("div",{className:`flex ${s.senderType==="support"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[85%] ${s.senderType==="support"?"order-1":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs ${s.senderType==="support"?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-600"}`,children:e.jsx(X,{className:"w-3 h-3"})}),e.jsx("span",{className:"text-xs font-medium text-slate-600",children:s.senderName}),e.jsx("span",{className:"text-xs text-slate-400",children:s.createdAt})]}),e.jsx("div",{className:`p-3 rounded-lg text-sm ${s.senderType==="support"?"bg-emerald-500 text-white":"bg-slate-100 text-slate-700"}`,children:s.message})]})},s.id))}),l.status!=="closed"&&e.jsxs("div",{className:"p-4 border-t border-slate-200",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx("textarea",{value:d,onChange:s=>N(s.target.value),placeholder:"Type your reply...",rows:2,className:"flex-1 px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20 resize-none"})}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("button",{className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>F(l.id),className:"px-3 py-1.5 text-sm text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:"Close Ticket"}),e.jsxs("button",{onClick:$,disabled:L||!d.trim(),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-gradient-to-r from-[#38BDF8] to-[#1E90FF] text-white rounded-lg hover:from-[#2BAEE8] hover:to-[#1A7FE8] transition-colors disabled:opacity-50",children:[e.jsx(J,{className:"w-4 h-4"}),"Send"]})]})]})]})]}):e.jsx("div",{className:"w-[450px] bg-white rounded-xl border border-slate-200 shadow-sm flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-4 sm:p-6 lg:p-8",children:[e.jsx(j,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),e.jsx("h3",{className:"font-semibold text-slate-700 mb-2",children:"Select a ticket"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Choose a ticket from the list to view details and respond"})]})})]})};export{te as default};
