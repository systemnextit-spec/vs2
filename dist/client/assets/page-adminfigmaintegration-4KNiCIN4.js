import{j as e}from"./react-jsx-runtime-BBsywpoz.js";import{r}from"./react-core-KcGD0Z1V.js";import{toast as i}from"./pkg-toast-Dpd4iwUK.js";import{aW as Z,bz as x,bc as _,bA as M,L as y,S as q,aC as Q,E as X,R as Y,aZ as ee,I as se,b8 as te,a9 as re,y as ae,aJ as ie,ak as ne,bB as le}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";import"./pkg-goober-N6sOClW1.js";const pe=({onBack:N,onImportImage:g,tenantId:de})=>{const[d,v]=r.useState(!1),[w,F]=r.useState(!1),[C,I]=r.useState(null),[l,h]=r.useState(""),[D,k]=r.useState(!1),[o,U]=r.useState(null),[c,L]=r.useState(null),[R,T]=r.useState(""),[m,p]=r.useState(null),[P,S]=r.useState(!1),[B,z]=r.useState(!1),[E,K]=r.useState([]),$=s=>{try{const n=new URL(s),t=n.pathname.split("/");let a="";const f=t.indexOf("design"),u=t.indexOf("file"),j=t.indexOf("board");f!==-1&&t[f+1]?a=t[f+1]:u!==-1&&t[u+1]?a=t[u+1]:j!==-1&&t[j+1]&&(a=t[j+1]);const b=t.indexOf("branch");b!==-1&&t[b+1]&&(a=t[b+1]);const O=n.searchParams.get("node-id"),W=O?O.replace("-",":"):"";return a?{fileKey:a,nodeId:W}:null}catch{return null}},G=async()=>{F(!0);try{await new Promise(s=>setTimeout(s,1500)),v(!0),I({name:"Figma User",email:"user@example.com"}),i.success("Connected to Figma successfully!")}catch{i.error("Failed to connect to Figma")}finally{F(!1)}},H=()=>{v(!1),I(null),U(null),L(null),p(null),i.success("Disconnected from Figma")},A=async()=>{if(!l.trim()){i.error("Please enter a Figma URL");return}const s=$(l);if(!s){i.error("Invalid Figma URL. Please use a valid Figma design link.");return}k(!0),U(null),L(null),p(null);try{const{fileKey:n,nodeId:t}=s;await new Promise(a=>setTimeout(a,2e3)),T(`Design from ${n}`),p({fileKey:n,nodeId:t||"root",type:"FRAME",name:"Imported Design"}),K(a=>[{url:l,name:`Design ${a.length+1}`,thumbnail:"",date:new Date().toISOString()},...a.slice(0,9)]),i.success("Design fetched successfully! Use Figma MCP tools for full functionality.")}catch(n){console.error("Failed to fetch design:",n),i.error("Failed to fetch design. Please check the URL and try again.")}finally{k(!1)}},J=()=>{c&&(navigator.clipboard.writeText(c),z(!0),i.success("Code copied to clipboard!"),setTimeout(()=>z(!1),2e3))},V=async()=>{if(!o||!g){i.error("No design to import or gallery not available");return}S(!0);try{await g(o,R||"Figma Import"),i.success("Design imported to gallery!")}catch{i.error("Failed to import design")}finally{S(!1)}};return e.jsxs("div",{className:"p-4 md:p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[N&&e.jsx("button",{onClick:N,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Z,{size:20})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(x,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:"Figma Integration"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Import and preview designs from Figma"})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 sm:p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-full ${d?"bg-green-100":"bg-gray-100"}`,children:d?e.jsx(_,{className:"w-6 h-6 text-green-600"}):e.jsx(M,{className:"w-6 h-6 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:d?"Connected to Figma":"Not Connected"}),C&&e.jsx("p",{className:"text-sm text-gray-500",children:C.email})]})]}),e.jsx("button",{onClick:d?H:G,disabled:w,className:`px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 ${d?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-purple-600 text-white hover:from-[#2BAEE8] hover:to-[#1A7FE8]"}`,children:w?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-4 h-4 animate-spin"}),"Connecting..."]}):d?e.jsxs(e.Fragment,{children:[e.jsx(M,{size:16}),"Disconnect"]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{size:16}),"Connect Figma"]})})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 sm:p-6 mb-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(q,{size:18}),"Fetch Design by URL"]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:l,onChange:s=>h(s.target.value),placeholder:"Paste Figma URL (e.g., https://figma.com/design/abc123/MyDesign?node-id=1-2)",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),l&&e.jsx("button",{onClick:()=>h(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:"Ã—"})]}),e.jsx("button",{onClick:A,disabled:D||!l.trim(),className:"px-6 py-3 bg-gradient-to-r from-[#38BDF8] to-[#1E90FF] text-white rounded-lg font-medium hover:from-[#2BAEE8] hover:to-[#1A7FE8] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:D?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-4 h-4 animate-spin"}),"Fetching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:18}),"Fetch Design"]})})]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Supported formats: Figma design URLs, file URLs, and frame-specific URLs with node-id"})]}),m&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-3 sm:gap-4 lg:gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(X,{size:18}),"Design Preview"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:A,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Refresh",children:e.jsx(Y,{size:16})}),e.jsx("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Open in Figma",children:e.jsx(ee,{size:16})})]})]}),e.jsx("div",{className:"p-6",children:o?e.jsx("img",{src:o,alt:R,className:"w-full h-auto rounded-lg border border-gray-200"}):e.jsxs("div",{className:"aspect-video bg-gray-100 rounded-lg flex flex-col items-center justify-center text-gray-400",children:[e.jsx(x,{size:48,className:"mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Preview will appear here"}),e.jsx("p",{className:"text-xs mt-1",children:"Use Figma MCP tools for screenshots"})]})}),o&&g&&e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsx("button",{onClick:V,disabled:P,className:"w-full px-4 py-2 bg-gradient-to-r from-[#38BDF8] to-[#1E90FF] text-white rounded-lg font-medium hover:from-[#2BAEE8] hover:to-[#1A7FE8] transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:P?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-4 h-4 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{size:16}),"Import to Gallery"]})})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(te,{size:18}),"Design Information"]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"File Key"}),e.jsx("p",{className:"text-sm font-mono bg-gray-50 px-3 py-2 rounded mt-1",children:m.fileKey})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Node ID"}),e.jsx("p",{className:"text-sm font-mono bg-gray-50 px-3 py-2 rounded mt-1",children:m.nodeId||"Root"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("p",{className:"text-sm bg-gray-50 px-3 py-2 rounded mt-1",children:m.type})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-2 text-amber-600 bg-amber-50 p-3 rounded-lg",children:[e.jsx(re,{size:18,className:"flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium",children:"Using Figma MCP"}),e.jsx("p",{className:"text-amber-700 mt-1",children:"For full functionality (screenshots, code generation, metadata), use VS Code's Figma MCP integration with the configured tools."})]})]})})]})]})]}),c&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden mb-6",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ae,{size:18}),"Generated Code"]}),e.jsx("button",{onClick:J,className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors flex items-center gap-2",children:B?e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:14,className:"text-green-600"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:14}),"Copy Code"]})})]}),e.jsx("div",{className:"p-4",children:e.jsx("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm",children:e.jsx("code",{children:c})})})]}),E.length>0&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(le,{size:18}),"Recent Designs"]})}),e.jsx("div",{className:"divide-y divide-gray-100",children:E.map((s,n)=>e.jsxs("div",{onClick:()=>h(s.url),className:"p-4 hover:bg-gray-50 cursor-pointer transition-colors flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(x,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 truncate",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.url})]}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(s.date).toLocaleDateString()})]},n))})]}),e.jsxs("div",{className:"mt-6 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-4 sm:p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"How to use Figma Integration"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center flex-shrink-0 text-sm font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Copy Figma URL"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Open your design in Figma and copy the URL from the browser"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center flex-shrink-0 text-sm font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Paste & Fetch"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Paste the URL above and click Fetch Design to load it"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center flex-shrink-0 text-sm font-bold",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Import or Copy"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Import the design to gallery or copy generated code"})]})]})]})]})]})};export{pe as default};
