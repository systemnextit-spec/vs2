import{j as e}from"./react-jsx-runtime-BBsywpoz.js";import{r as n}from"./react-core-KcGD0Z1V.js";import{aa as O,bv as $,S as ce,P as qe,bw as xe,d as pe,a as me,T as he,C as Oe,b as $e,aQ as Ge,ab as G,aK as Xe,bx as Je,N as Ke,w as Ve,X as ue,an as Qe,ba as Ye,b5 as Ze,E as et,h as tt,L as fe,f as ge,aJ as st}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";const at=[{id:"dashboard",label:"Dashboard",group:"General"},{id:"orders",label:"Orders",group:"Sales"},{id:"products",label:"Products",group:"Sales"},{id:"customers",label:"Customers",group:"Sales"},{id:"inventory",label:"Inventory",group:"Sales"},{id:"catalog",label:"Catalog",group:"Content"},{id:"landing_pages",label:"Landing Pages",group:"Content"},{id:"gallery",label:"Gallery",group:"Content"},{id:"reviews",label:"Reviews",group:"Content"},{id:"expenses",label:"Expenses",group:"Finance"},{id:"income",label:"Income",group:"Finance"},{id:"due_book",label:"Due Book",group:"Finance"},{id:"profit_loss",label:"Profit/Loss",group:"Finance"},{id:"notes",label:"Notes",group:"Finance"},{id:"business_report",label:"Business Report",group:"Reports"},{id:"customization",label:"Customization",group:"System"},{id:"settings",label:"Settings",group:"System"},{id:"admin_control",label:"Admin Control",group:"System"},{id:"tenants",label:"Tenants",group:"System"}],M=["read","write","edit","delete"],ot=({users:y,roles:B=[],onAddUser:be,onUpdateUser:X,onDeleteUser:J,onAddRole:je,onUpdateRole:ye,onDeleteRole:ve,onUpdateUserRole:lt,currentUser:o,tenantId:K,userPermissions:V={}})=>{const[v,we]=n.useState("users"),[h,Q]=n.useState(""),[R,b]=n.useState(!1),[m,w]=n.useState(1),[N,Ne]=n.useState(10),[A,Ce]=n.useState("all"),[T,z]=n.useState(null),C=t=>o?.role==="super_admin"||o?.role==="admin"||o?.role==="tenant_admin"?!0:V.admin_control?V.admin_control.includes(t):!1,Y=C("write")||C("edit"),ke=C("delete"),Z=C("write")||C("edit"),Se=C("delete"),ee=t=>Y?o?.role==="super_admin"?!0:t.email===o?.email?!1:o?.role==="admin"||o?.role==="tenant_admin"?t.role==="staff":o?.role==="staff"?t.role==="staff"&&t.email!==o?.email:!1:!1,Re=t=>t.email===o?.email||!ke?!1:ee(t),[Ae,P]=n.useState(!1),[f,te]=n.useState(null),[D,se]=n.useState(!1),[d,g]=n.useState({name:"",email:"",password:"",phone:"",role:"staff",roleId:"",isActive:!0}),[ze,I]=n.useState(!1),[S,ae]=n.useState(null),[p,k]=n.useState({name:"",description:"",permissions:[]}),le=[{id:"R-98211",customer:"Anika Rahman",avatar:"https://i.pravatar.cc/120?img=32",rating:5,headline:"Lightning fast delivery",message:"Ordered at night and had the phone within 36 hours. Packaging was premium and seal was intact.",product:"iPhone 14 Pro Max 1TB",date:"Dec 01, 2025",status:"published",reply:"Thanks Anika! Glad the express courier met expectations."},{id:"R-98202",customer:"Fahim Reza",avatar:"https://i.pravatar.cc/120?img=15",rating:3,headline:"Good product, slow courier",message:"Gadget works perfectly but delivery partner rescheduled twice. Please fix courier coordination.",product:"Logitech G Pro X Headset",date:"Nov 29, 2025",status:"pending"},{id:"R-98144",customer:"Sadia Tanjin",avatar:"https://i.pravatar.cc/120?img=8",rating:2,headline:"Box slightly damaged",message:"Device ok but retail box arrived dented. Need better bubble-wrap next time.",product:"Xiaomi Smart Air Purifier 4",date:"Nov 25, 2025",status:"flagged"}],[u,ie]=n.useState(le),[F,Pe]=n.useState("all"),[Ie,Fe]=n.useState(le[0]?.id||null),[E,U]=n.useState(""),L=n.useMemo(()=>y.filter(t=>t.role!=="customer"&&(t.name?.toLowerCase().includes(h.toLowerCase())||t.email?.toLowerCase().includes(h.toLowerCase()))&&(A==="all"||(A==="active"?t.isActive!==!1:t.isActive===!1))),[y,h,A]),j=Math.ceil(L.length/N),W=n.useMemo(()=>L.slice((m-1)*N,m*N),[L,m,N]),ne=n.useMemo(()=>y.filter(t=>t.role==="customer"&&(t.name?.toLowerCase().includes(h.toLowerCase())||t.email?.toLowerCase().includes(h.toLowerCase()))),[y,h]),H=n.useMemo(()=>u.filter(t=>{if(!(F==="all"||t.status===F))return!1;if(!h.trim())return!0;const a=h.toLowerCase();return t.customer.toLowerCase().includes(a)||t.product.toLowerCase().includes(a)||t.message.toLowerCase().includes(a)}),[u,h,F]),x=u.find(t=>t.id===Ie)||H[0]||null,_=n.useMemo(()=>{const t=u.filter(i=>i.status==="published").length,s=u.filter(i=>i.status==="pending").length,a=u.filter(i=>i.status==="flagged").length,r=u.length?(u.reduce((i,c)=>i+c.rating,0)/u.length).toFixed(1):"0.0";return{published:t,pending:s,flagged:a,avgRating:r}},[u]),q=(t,s)=>{ie(a=>a.map(r=>r.id===t?{...r,status:s}:r))},Le=()=>{if(!x)return;const t=E.trim();t&&(ie(s=>s.map(a=>a.id===x.id?{...a,reply:t,status:"published"}:a)),U(""))},_e=n.useMemo(()=>at.reduce((t,s)=>({...t,[s.group]:[...t[s.group]||[],s]}),{}),[]),re=t=>{t?(te(t),g({name:t.name,email:t.email,password:"",phone:t.phone||"",role:t.role,roleId:t.roleId||"",isActive:t.isActive!==!1})):(te(null),g({name:"",email:"",password:"",phone:"",role:"staff",roleId:"",isActive:!0})),se(!1),P(!0)},Me=async t=>{if(t.preventDefault(),!d.name||!d.email)return alert("Name and Email required");if(!f&&!d.password)return alert("Password required");b(!0);try{const s={...d,roleId:d.roleId||void 0};f?await X?.(f._id||f.id||"",s):await be?.({...s,tenantId:K}),P(!1)}catch(s){alert(s?.message||"Failed to save user")}finally{b(!1)}},Be=async t=>{if(t.email===o?.email)return alert("Can't delete yourself");if(confirm(`Delete "${t.name}"?`)){b(!0);try{await J?.(t._id||t.id||"")}catch(s){alert(s?.message||"Failed to delete")}finally{b(!1)}}},de=t=>{t?(ae(t),k({name:t.name,description:t.description,permissions:t.permissions||[]})):(ae(null),k({name:"",description:"",permissions:[]})),I(!0)},Te=(t,s)=>{const a=[...p.permissions],r=a.findIndex(i=>i.resource===t);if(r>=0){const i=a[r].actions;if(i.includes(s)){const c=i.filter(He=>He!==s);c.length===0?a.splice(r,1):a[r]={resource:t,actions:c}}else a[r]={resource:t,actions:[...i,s]}}else a.push({resource:t,actions:[s]});k({...p,permissions:a})},De=t=>{const s=[...p.permissions],a=s.findIndex(r=>r.resource===t);a>=0&&s[a].actions.length===4?s.splice(a,1):a>=0?s[a]={resource:t,actions:[...M]}:s.push({resource:t,actions:[...M]}),k({...p,permissions:s})},Ee=(t,s)=>p.permissions.find(a=>a.resource===t)?.actions.includes(s)??!1,Ue=async t=>{if(t.preventDefault(),!p.name)return alert("Role name required");b(!0);try{S?await ye(S._id||S.id||"",p):await je({...p,tenantId:K}),I(!1)}catch(s){alert(s?.message||"Failed to save role")}finally{b(!1)}},We=async t=>{if(t.isSystem)return alert("Cannot delete system roles");const s=y.filter(a=>a.roleId===(t._id||t.id)).length;if(s>0)return alert(`Role assigned to ${s} user(s). Reassign first.`);if(confirm(`Delete "${t.name}"?`)){b(!0);try{await ve(t._id||t.id||"")}catch(a){alert(a?.message||"Failed to delete")}finally{b(!1)}}},oe=t=>({super_admin:"Owner",tenant_admin:"Manager",admin:"Admin",staff:"Staff"})[t||""]||t||"Unknown",l={container:{background:"#f9f9f9",minHeight:"100vh",padding:"20px"},mainCard:{background:"white",borderRadius:"8px",padding:"20px",display:"flex",flexDirection:"column",gap:"20px"},headerRow:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"16px"},title:{fontFamily:"'Lato', sans-serif",fontWeight:700,fontSize:"22px",color:"#023337",letterSpacing:"0.11px",margin:0},controlsRow:{display:"flex",alignItems:"center",gap:"24px",flexWrap:"wrap"},searchBox:{display:"flex",alignItems:"center",gap:"8px",background:"#f9f9f9",borderRadius:"8px",padding:"8px 12px",width:"292px",height:"34px"},searchInput:{border:"none",background:"transparent",outline:"none",fontFamily:"'Poppins', sans-serif",fontSize:"12px",color:"#7b7b7b",flex:1},searchButton:{fontFamily:"'Poppins', sans-serif",fontSize:"12px",color:"black",background:"transparent",border:"none",cursor:"pointer"},filterDropdown:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:"#f9f9f9",borderRadius:"8px",padding:"8px 12px",fontFamily:"'Poppins', sans-serif",fontSize:"12px",color:"black",border:"none",cursor:"pointer"},addRoleButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",background:"linear-gradient(to right, #38bdf8, #1e90ff)",borderRadius:"8px",padding:"6px 16px 6px 12px",height:"48px",width:"142px",border:"none",cursor:"pointer"},addRoleText:{fontFamily:"'Lato', sans-serif",fontWeight:700,fontSize:"15px",color:"white",letterSpacing:"-0.3px"},addUserButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",background:"linear-gradient(to right, #10b981, #059669)",borderRadius:"8px",padding:"6px 16px 6px 12px",height:"48px",width:"142px",border:"none",cursor:"pointer"},tableHeader:{display:"grid",gridTemplateColumns:"40px 50px 70px 1fr 1fr 100px 120px 130px 90px 70px",alignItems:"center",height:"48px",background:"linear-gradient(to right, #e0f7fa, #b2ebf2)",borderRadius:"4px 4px 0 0",padding:"0 16px"},tableHeaderCell:{fontFamily:"'Poppins', sans-serif",fontWeight:500,fontSize:"16px",color:"black"},tableRow:{display:"grid",gridTemplateColumns:"40px 50px 70px 1fr 1fr 100px 120px 130px 90px 70px",alignItems:"center",height:"68px",borderBottom:"0.5px solid #b9b9b9",padding:"0 16px"},checkbox:{width:"20px",height:"20px",background:"white",border:"1.5px solid #eaf8e7",borderRadius:"4px",cursor:"pointer"},cellText:{fontFamily:"'Poppins', sans-serif",fontWeight:400,fontSize:"12px",color:"#1d1a1a"},avatarContainer:{width:"40px",height:"40px",borderRadius:"8px",background:"linear-gradient(to right, #38bdf8, #1e90ff)",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},statusBadge:{display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"2px 9px",borderRadius:"30px",background:"#c1ffbc",fontFamily:"'Poppins', sans-serif",fontWeight:500,fontSize:"12px",color:"#085e00"},statusBadgeInactive:{background:"#ffeeba",color:"#856404"},actionButton:{width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",background:"transparent",border:"none",padding:0},paginationContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"20px"},paginationButton:{display:"flex",alignItems:"center",gap:"4px",padding:"10px 12px 10px 8px",background:"white",border:"1px solid #eee",borderRadius:"8px",fontFamily:"'Lato', sans-serif",fontWeight:500,fontSize:"15px",color:"#afafaf",cursor:"pointer"},paginationButtonActive:{boxShadow:"0px 1px 3px 0px rgba(0,0,0,0.2)",color:"black"},pageNumber:{display:"flex",alignItems:"center",justifyContent:"center",width:"36px",height:"36px",borderRadius:"4px",fontFamily:"'Lato', sans-serif",fontWeight:700,fontSize:"15px",cursor:"pointer",border:"none"},pageNumberActive:{background:"#dff5ff",color:"#1e90ff"},pageNumberInactive:{background:"white",border:"1px solid #d1d5db",color:"#023337"}};return e.jsxs("div",{style:l.container,children:[e.jsxs("div",{style:l.mainCard,children:[e.jsxs("div",{style:l.headerRow,children:[e.jsx("h2",{style:l.title,children:"Admin Control"}),e.jsx("div",{style:{display:"flex",gap:"4px",background:"#f0f0f0",padding:"4px",borderRadius:"8px"},children:["users","roles"].map(t=>e.jsxs("button",{onClick:()=>we(t),style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 16px",borderRadius:"6px",fontFamily:"'Poppins', sans-serif",fontWeight:500,fontSize:"13px",transition:"all 0.2s",border:"none",cursor:"pointer",background:v===t?"linear-gradient(to right, #38bdf8, #1e90ff)":"transparent",color:v===t?"white":"#666"},children:[t==="users"&&e.jsx(O,{size:14}),t==="roles"&&e.jsx($,{size:14}),t.charAt(0).toUpperCase()+t.slice(1)]},t))})]}),v==="users"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:l.headerRow,children:e.jsxs("div",{style:l.controlsRow,children:[e.jsxs("div",{style:l.searchBox,children:[e.jsx(ce,{size:20,color:"#7b7b7b"}),e.jsx("input",{type:"text",placeholder:"Search Category",value:h,onChange:t=>{Q(t.target.value),w(1)},style:l.searchInput}),e.jsx("button",{style:l.searchButton,children:"Search"})]}),e.jsxs("select",{value:A,onChange:t=>{Ce(t.target.value),w(1)},style:l.filterDropdown,children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsxs("select",{value:N,onChange:t=>{Ne(Number(t.target.value)),w(1)},style:l.filterDropdown,children:[e.jsx("option",{value:10,children:"10 Admin"}),e.jsx("option",{value:25,children:"25 Admin"}),e.jsx("option",{value:50,children:"50 Admin"})]}),Z&&e.jsxs("button",{onClick:()=>de(),style:l.addRoleButton,children:[e.jsx(qe,{size:24,color:"white"}),e.jsx("span",{style:l.addRoleText,children:"Add Role"})]}),Y&&e.jsxs("button",{onClick:()=>re(),style:l.addUserButton,children:[e.jsx(xe,{size:20,color:"white"}),e.jsx("span",{style:l.addRoleText,children:"Add User"})]})]})}),e.jsxs("div",{style:{background:"white"},children:[e.jsxs("div",{className:"hidden md:block",children:[e.jsxs("div",{style:l.tableHeader,children:[e.jsx("div",{children:e.jsx("input",{type:"checkbox",style:l.checkbox})}),e.jsx("div",{style:l.tableHeaderCell,children:"SL"}),e.jsx("div",{style:l.tableHeaderCell,children:"Picture"}),e.jsx("div",{style:l.tableHeaderCell,children:"Name"}),e.jsx("div",{style:l.tableHeaderCell,children:"Username"}),e.jsx("div",{style:l.tableHeaderCell,children:"Role"}),e.jsx("div",{style:l.tableHeaderCell,children:"Last Login"}),e.jsx("div",{style:l.tableHeaderCell,children:"Registration At"}),e.jsx("div",{style:l.tableHeaderCell,children:"Status"}),e.jsx("div",{style:l.tableHeaderCell,children:"Action"})]}),W.map((t,s)=>{const a=(m-1)*N+s+1,r=t._id||t.id||t.email;return e.jsxs("div",{style:l.tableRow,children:[e.jsx("div",{children:e.jsx("input",{type:"checkbox",style:l.checkbox})}),e.jsx("div",{style:{...l.cellText,textAlign:"center"},children:a}),e.jsx("div",{children:e.jsx("div",{style:l.avatarContainer,children:t.avatar?e.jsx("img",{src:t.avatar,alt:t.name,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx("span",{style:{color:"white",fontWeight:700,fontSize:"14px"},children:t.name?.charAt(0).toUpperCase()})})}),e.jsx("div",{style:l.cellText,children:t.name}),e.jsx("div",{style:l.cellText,children:t.email?.split("@")[0]||"-"}),e.jsx("div",{style:l.cellText,children:oe(t.role)}),e.jsx("div",{style:l.cellText,children:t.lastLogin?new Date(t.lastLogin).toLocaleDateString("en-GB"):"-"}),e.jsx("div",{style:l.cellText,children:t.createdAt?new Date(t.createdAt).toLocaleDateString("en-GB"):"-"}),e.jsx("div",{children:e.jsx("span",{style:{...l.statusBadge,...t.isActive===!1?l.statusBadgeInactive:{}},children:t.isActive!==!1?"Publish":"Inactive"})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{onClick:()=>z(T===r?null:r),style:l.actionButton,children:e.jsx(pe,{size:20,color:"#666"})}),T===r&&e.jsxs("div",{style:{position:"absolute",right:0,top:"100%",background:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:"120px",zIndex:10,overflow:"hidden"},children:[X&&ee(t)&&e.jsxs("button",{onClick:()=>{re(t),z(null)},style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",fontFamily:"'Poppins', sans-serif",fontSize:"14px",color:"#1e90ff",background:"transparent",border:"none",width:"100%",textAlign:"left",cursor:"pointer"},onMouseEnter:i=>i.currentTarget.style.background="#f5f5f5",onMouseLeave:i=>i.currentTarget.style.background="transparent",children:[e.jsx(me,{size:16})," Edit"]}),J&&Re(t)&&e.jsxs("button",{onClick:()=>{Be(t),z(null)},style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",fontFamily:"'Poppins', sans-serif",fontSize:"14px",color:"#dc2626",background:"transparent",border:"none",width:"100%",textAlign:"left",cursor:"pointer"},onMouseEnter:i=>i.currentTarget.style.background="#fef2f2",onMouseLeave:i=>i.currentTarget.style.background="transparent",children:[e.jsx(he,{size:16})," Delete"]})]})]})]},r)}),W.length===0&&e.jsxs("div",{style:{padding:"48px",textAlign:"center",color:"#777"},children:[e.jsx(O,{size:32,style:{margin:"0 auto 8px",opacity:.5}}),"No users found."]})]}),e.jsx("div",{className:"md:hidden",children:W.map((t,s)=>{const a=t._id||t.id||t.email;return e.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #eee",display:"flex",gap:"12px"},children:[e.jsx("div",{style:l.avatarContainer,children:t.avatar?e.jsx("img",{src:t.avatar,alt:t.name,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx("span",{style:{color:"white",fontWeight:700},children:t.name?.charAt(0).toUpperCase()})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsx("span",{style:{fontFamily:"'Poppins', sans-serif",fontWeight:500,fontSize:"14px",color:"#1d1a1a"},children:t.name}),e.jsx("span",{style:{...l.statusBadge,...t.isActive===!1?l.statusBadgeInactive:{}},children:t.isActive!==!1?"Publish":"Inactive"})]}),e.jsx("p",{style:{fontFamily:"'Poppins', sans-serif",fontSize:"12px",color:"#777",marginTop:"4px"},children:t.email}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"8px"},children:[e.jsx("span",{style:{fontFamily:"'Poppins', sans-serif",fontSize:"12px",color:"#777"},children:oe(t.role)}),e.jsx("button",{onClick:()=>z(T===a?null:a),style:l.actionButton,children:e.jsx(pe,{size:20,color:"#666"})})]})]})]},a)})})]}),L.length>0&&e.jsxs("div",{style:l.paginationContainer,children:[e.jsxs("button",{onClick:()=>w(t=>Math.max(1,t-1)),disabled:m===1,style:{...l.paginationButton,opacity:m===1?.5:1},children:[e.jsx(Oe,{size:20,color:"#afafaf"}),"Previous"]}),e.jsx("div",{style:{display:"flex",gap:"12px"},children:Array.from({length:Math.min(5,j)},(t,s)=>{let a;return j<=5||m<=3?a=s+1:m>=j-2?a=j-4+s:a=m-2+s,e.jsx("button",{onClick:()=>w(a),style:{...l.pageNumber,...m===a?l.pageNumberActive:l.pageNumberInactive},children:a},a)})}),e.jsxs("button",{onClick:()=>w(t=>Math.min(j,t+1)),disabled:m===j||j===0,style:{...l.paginationButton,...l.paginationButtonActive,opacity:m===j?.5:1},children:["Next",e.jsx($e,{size:20,color:"black"})]})]})]}),v==="roles"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[B.filter(t=>t._id||t.id).map(t=>{const s=t._id||t.id,a=y.filter(i=>i.roleId===s).length,r=t.permissions?.reduce((i,c)=>i+(c.actions?.length||0),0)||0;return e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4 sm:p-5 hover:border-emerald-500/30 transition group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2 text-sm sm:text-base",children:[e.jsx($,{size:16,className:"text-emerald-400 flex-shrink-0"}),t.name]}),t.isSystem&&e.jsx("span",{className:"text-xs text-amber-400",children:"System"})]}),!t.isSystem&&Z&&e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition",children:[e.jsx("button",{onClick:()=>de(t),className:"p-2 hover:bg-white/10 rounded text-slate-400 hover:text-emerald-400 min-w-[44px] min-h-[44px] flex items-center justify-center",children:e.jsx(me,{size:14})}),Se&&e.jsx("button",{onClick:()=>We(t),className:"p-2 hover:bg-white/10 rounded text-slate-400 hover:text-red-400 min-w-[44px] min-h-[44px] flex items-center justify-center",children:e.jsx(he,{size:14})})]})]}),e.jsx("p",{className:"text-slate-500 text-xs sm:text-sm mb-4 line-clamp-2",children:t.description||"No description"}),e.jsxs("div",{className:"flex gap-4 text-xs text-slate-500 pt-3 border-t border-white/10",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(O,{size:12}),a," users"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ge,{size:12}),r," perms"]})]})]},s)}),B.length===0&&e.jsx("div",{className:"col-span-full text-center py-12 text-slate-500",children:"No roles yet"})]}),v==="reviews"&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-3 sm:p-4",children:[e.jsx("p",{className:"text-xs uppercase text-slate-500",children:"Published"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-emerald-400",children:_.published})]}),e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-3 sm:p-4",children:[e.jsx("p",{className:"text-xs uppercase text-slate-500",children:"Pending"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-amber-400",children:_.pending})]}),e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-3 sm:p-4",children:[e.jsx("p",{className:"text-xs uppercase text-slate-500",children:"Flagged"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-400",children:_.flagged})]}),e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-3 sm:p-4",children:[e.jsx("p",{className:"text-xs uppercase text-slate-500",children:"Avg Rating"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-white",children:_.avgRating}),e.jsx(G,{className:"text-yellow-400 fill-yellow-400 w-4 h-4 sm:w-[18px] sm:h-[18px]"})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","published","pending","flagged"].map(t=>e.jsx("button",{onClick:()=>Pe(t),className:`px-3 sm:px-4 py-2 sm:py-2.5 rounded-lg text-xs font-medium transition min-h-[44px] ${F===t?"bg-emerald-500 text-white":"bg-white/5 text-slate-400 hover:text-white border border-white/10"}`,children:t==="all"?"All":t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 md:gap-3 sm:gap-4 lg:gap-6",children:[e.jsx("div",{className:"xl:col-span-2 bg-white/5 rounded-2xl border border-white/10 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[700px] text-sm",children:[e.jsx("thead",{className:"bg-white/5 text-slate-400 text-xs uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left",children:"Customer"}),e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left hidden sm:table-cell",children:"Product"}),e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left",children:"Rating"}),e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-3 sm:px-4 py-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/5",children:[H.map(t=>e.jsxs("tr",{className:`hover:bg-white/5 cursor-pointer ${x?.id===t.id?"bg-emerald-500/10":""}`,onClick:()=>{Fe(t.id),U(t.reply||"")},children:[e.jsxs("td",{className:"px-3 sm:px-4 py-3",children:[e.jsx("div",{className:"font-medium text-white text-xs sm:text-sm",children:t.customer}),e.jsx("div",{className:"text-slate-500 text-xs",children:t.date})]}),e.jsx("td",{className:"px-3 sm:px-4 py-3 text-slate-400 text-xs sm:text-sm hidden sm:table-cell",children:t.product}),e.jsx("td",{className:"px-3 sm:px-4 py-3",children:e.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(s=>e.jsx(G,{size:12,className:s<=t.rating?"text-yellow-400 fill-yellow-400":"text-slate-600"},s))})}),e.jsx("td",{className:"px-3 sm:px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.status==="published"?"text-emerald-300 bg-emerald-500/20":t.status==="pending"?"text-amber-300 bg-amber-500/20":"text-red-300 bg-red-500/20"}`,children:t.status})}),e.jsx("td",{className:"px-3 sm:px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),q(t.id,"published")},className:"p-2 hover:bg-white/10 rounded text-slate-400 hover:text-emerald-400 min-w-[44px] min-h-[44px] flex items-center justify-center",title:"Publish",children:e.jsx(Xe,{size:14})}),e.jsx("button",{onClick:s=>{s.stopPropagation(),q(t.id,"flagged")},className:"p-2 hover:bg-white/10 rounded text-slate-400 hover:text-red-400 min-w-[44px] min-h-[44px] flex items-center justify-center",title:"Flag",children:e.jsx(Je,{size:14})})]})})]},t.id)),H.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-slate-500",children:"No reviews found"})})]})]})})}),e.jsx("div",{className:"bg-white/5 rounded-2xl border border-white/10 p-4 sm:p-5",children:x?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:x.avatar,alt:x.customer,className:"w-10 h-10 sm:w-12 sm:h-12 rounded-xl object-cover"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white text-sm sm:text-base",children:x.customer}),e.jsx("p",{className:"text-xs text-slate-500",children:x.product})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white text-sm sm:text-base",children:x.headline}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-400 mt-1",children:x.message})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-slate-500 mb-1",children:"Rating"}),e.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(t=>e.jsx(G,{size:16,className:t<=x.rating?"text-yellow-400 fill-yellow-400":"text-slate-600"},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs uppercase text-slate-500",children:"Reply"}),e.jsx("textarea",{className:"w-full bg-white/5 border border-white/10 rounded-lg text-sm text-white p-3 h-24 focus:outline-none focus:ring-2 focus:ring-emerald-500/50",placeholder:"Write a reply...",value:E,onChange:t=>U(t.target.value)}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("button",{onClick:Le,className:"flex-1 flex items-center justify-center gap-2 bg-emerald-500 hover:bg-emerald-600 text-white text-sm font-medium px-4 py-2.5 rounded-lg transition min-h-[44px]",children:[e.jsx(Ke,{size:14})," Send Reply"]}),e.jsx("button",{onClick:()=>x&&q(x.id,"pending"),className:"px-4 py-2.5 text-xs font-medium rounded-lg border border-white/20 text-slate-400 hover:text-white min-h-[44px]",children:"Mark Pending"})]}),x.reply&&!E&&e.jsxs("div",{className:"p-3 text-xs rounded-lg bg-white/5 border border-white/10 text-slate-400 flex items-start gap-2",children:[e.jsx(Ve,{size:12,className:"mt-0.5 text-emerald-400 flex-shrink-0"}),e.jsx("span",{children:x.reply})]})]})]}):e.jsx("div",{className:"text-center text-slate-500 py-10",children:"Select a review to manage"})})]})]}),v==="customers"&&e.jsxs("div",{className:"bg-white/5 rounded-2xl border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-3 sm:p-4 border-b border-white/10",children:e.jsxs("div",{className:"relative max-w-full sm:max-w-sm",children:[e.jsx(ce,{size:16,className:"absolute left-3 to p-3 text-slate-500"}),e.jsx("input",{type:"text",placeholder:"Search customers...",value:h,onChange:t=>Q(t.target.value),className:"w-full pl-9 pr-4 py-2.5 bg-white/5 border border-white/10 rounded-lg text-white text-sm placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/50 min-h-[44px]"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[700px] text-sm",children:[e.jsx("thead",{className:"bg-white/5 text-slate-400 text-xs uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left",children:"Customer"}),e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left",children:"Email"}),e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left hidden sm:table-cell",children:"Phone"}),e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left",children:"Status"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/5",children:[ne.map(t=>e.jsxs("tr",{className:"hover:bg-white/5",children:[e.jsx("td",{className:"px-3 sm:px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-9 sm:h-9 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 font-bold text-xs sm:text-sm flex-shrink-0",children:t.name?.charAt(0).toUpperCase()||"?"}),e.jsx("div",{className:"font-medium text-white text-xs sm:text-sm",children:t.name||"Unknown"})]})}),e.jsx("td",{className:"px-3 sm:px-4 py-3 text-slate-400 text-xs sm:text-sm",children:t.email}),e.jsx("td",{className:"px-3 sm:px-4 py-3 text-slate-400 text-xs sm:text-sm hidden sm:table-cell",children:t.phone||"-"}),e.jsx("td",{className:"px-3 sm:px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.isActive!==!1?"text-emerald-300 bg-emerald-500/20":"text-red-300 bg-red-500/20"}`,children:t.isActive!==!1?"Active":"Inactive"})})]},t._id||t.id||t.email)),ne.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-8 text-center text-slate-500",children:"No customers found"})})]})]})})]})]}),Ae&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-3 sm:p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl w-full max-w-md max-h-[95vh] sm:max-h-[90vh] border border-white/10 flex flex-col",children:[e.jsxs("div",{className:"p-4 sm:p-5 border-b border-white/10 flex justify-between items-center flex-shrink-0",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(xe,{className:"text-emerald-400 w-[18px] h-[18px] sm:w-5 sm:h-5"}),f?"Edit User":"Add User"]}),e.jsx("button",{onClick:()=>P(!1),className:"text-slate-400 hover:text-white p-2 min-w-[44px] min-h-[44px] flex items-center justify-center",children:e.jsx(ue,{size:18})})]}),e.jsxs("form",{id:"userForm",onSubmit:Me,className:"p-4 sm:p-5 space-y-4 overflow-y-auto flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-1",children:"Name *"}),e.jsx("input",{type:"text",required:!0,value:d.name,onChange:t=>g({...d,name:t.target.value}),className:"w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 min-h-[44px]",placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-1",children:"Email *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Qe,{size:16,className:"absolute left-3 to p-3.5 text-slate-500"}),e.jsx("input",{type:"email",required:!0,disabled:!!f,value:d.email,onChange:t=>g({...d,email:t.target.value}),className:"w-full pl-9 pr-3 py-2.5 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 disabled:opacity-50 min-h-[44px]",placeholder:"john@example.com"})]})]}),!f&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-1",children:"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ye,{size:16,className:"absolute left-3 to p-3.5 text-slate-500"}),e.jsx("input",{type:D?"text":"password",required:!0,minLength:6,value:d.password,onChange:t=>g({...d,password:t.target.value}),className:"w-full pl-9 pr-11 py-2.5 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 min-h-[44px]",placeholder:"Min 6 chars"}),e.jsx("button",{type:"button",onClick:()=>se(!D),className:"absolute right-1 top-1 text-slate-500 hover:text-white w-10 h-10 flex items-center justify-center rounded",children:D?e.jsx(Ze,{size:16}):e.jsx(et,{size:16})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-1",children:"Phone"}),e.jsxs("div",{className:"relative",children:[e.jsx(tt,{size:16,className:"absolute left-3 to p-3.5 text-slate-500"}),e.jsx("input",{type:"tel",value:d.phone,onChange:t=>g({...d,phone:t.target.value}),className:"w-full pl-9 pr-3 py-2.5 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 min-h-[44px]",placeholder:"+880 1XXX"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-1",children:"Role"}),e.jsxs("select",{value:d.role,onChange:t=>g({...d,role:t.target.value}),disabled:o?.role==="staff"||o?.role==="tenant_admin",className:"w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px]",children:[e.jsx("option",{value:"staff",className:"bg-slate-900",children:"Staff"}),o?.role==="super_admin"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"admin",className:"bg-slate-900",children:"Admin"}),e.jsx("option",{value:"tenant_admin",className:"bg-slate-900",children:"Tenant Admin"}),e.jsx("option",{value:"super_admin",className:"bg-slate-900",children:"Super Admin"})]})]}),(o?.role==="staff"||o?.role==="tenant_admin")&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Only super admin can change base role"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-1",children:"Custom Role"}),e.jsxs("select",{value:d.roleId,onChange:t=>g({...d,roleId:t.target.value}),className:"w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 min-h-[44px]",children:[e.jsx("option",{value:"",className:"bg-slate-900",children:"None"}),B.filter(t=>t._id||t.id).map(t=>e.jsx("option",{value:t._id||t.id,className:"bg-slate-900",children:t.name},t._id||t.id))]})]})]}),f&&e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-400 cursor-pointer min-h-[44px]",children:[e.jsx("input",{type:"checkbox",checked:d.isActive,onChange:t=>g({...d,isActive:t.target.checked}),className:"w-5 h-5 rounded bg-white/10 border-white/20 text-emerald-500"}),"Active (can login)"]})]}),e.jsxs("div",{className:"flex gap-3 p-4 sm:p-5 border-t border-white/10 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>P(!1),className:"flex-1 py-2.5 border border-white/20 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 min-h-[44px]",children:"Cancel"}),e.jsxs("button",{type:"submit",form:"userForm",disabled:R,className:"flex-1 py-2.5 bg-emerald-500 hover:bg-emerald-600 rounded-lg text-white font-medium flex items-center justify-center gap-2 disabled:opacity-50 min-h-[44px]",children:[R?e.jsx(fe,{size:16,className:"animate-spin"}):e.jsx(ge,{size:16}),f?"Update":"Create"]})]})]})}),ze&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-3 sm:p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl w-full max-w-full sm:max-w-3xl max-h-[95vh] sm:max-h-[90vh] flex flex-col border border-white/10 mx-3 sm:mx-0",children:[e.jsxs("div",{className:"p-4 sm:p-5 border-b border-white/10 flex justify-between items-center flex-shrink-0",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx($,{className:"text-emerald-400 w-[18px] h-[18px] sm:w-5 sm:h-5"}),S?"Edit Role":"Create Role"]}),e.jsx("button",{onClick:()=>I(!1),className:"text-slate-400 hover:text-white p-2 min-w-[44px] min-h-[44px] flex items-center justify-center",children:e.jsx(ue,{size:18})})]}),e.jsxs("form",{id:"roleForm",onSubmit:Ue,className:"flex-1 overflow-y-auto p-4 sm:p-5 space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-1",children:"Name *"}),e.jsx("input",{type:"text",required:!0,value:p.name,onChange:t=>k({...p,name:t.target.value}),className:"w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 min-h-[44px]",placeholder:"Order Manager"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-1",children:"Description"}),e.jsx("input",{type:"text",value:p.description,onChange:t=>k({...p,description:t.target.value}),className:"w-full px-3 py-2.5 bg-white/5 border border-white/10 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 min-h-[44px]",placeholder:"Brief description..."})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3",children:[e.jsx("label",{className:"text-sm text-slate-400",children:"Permissions"}),e.jsx("div",{className:"flex gap-2 text-xs text-slate-500",children:M.map(t=>e.jsx("span",{className:"px-2 py-1 bg-white/5 rounded",children:t[0].toUpperCase()},t))})]}),e.jsx("div",{className:"bg-white/5 rounded-xl border border-white/10 divide-y divide-white/10",children:Object.entries(_e).map(([t,s])=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 sm:px-4 py-2 bg-white/5 text-xs font-semibold text-emerald-400 uppercase",children:t}),e.jsx("div",{className:"divide-y divide-white/5",children:s.map(a=>{const i=p.permissions.find(c=>c.resource===a.id)?.actions.length||0;return e.jsxs("div",{className:"px-3 sm:px-4 py-3 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-4 hover:bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("button",{type:"button",onClick:()=>De(a.id),className:`w-6 h-6 sm:w-6 sm:h-6 rounded flex items-center justify-center text-xs border transition flex-shrink-0 ${i===4?"bg-emerald-500 border-emerald-500 text-white":i>0?"bg-emerald-500/30 border-emerald-500/50 text-emerald-400":"bg-white/5 border-white/20 text-slate-500"}`,children:i===4?e.jsx(st,{size:12}):i>0?i:""}),e.jsx("span",{className:"text-xs sm:text-sm text-white truncate",children:a.label})]}),e.jsx("div",{className:"flex gap-1 sm:gap-1 w-full sm:w-auto justify-start sm:justify-end",children:M.map(c=>e.jsx("button",{type:"button",onClick:()=>Te(a.id,c),className:`min-w-[44px] min-h-[44px] sm:w-10 sm:h-10 rounded text-xs font-medium transition flex items-center justify-center ${Ee(a.id,c)?c==="read"?"bg-emerald-500/30 text-emerald-300":c==="write"?"bg-blue-500/30 text-blue-300":c==="edit"?"bg-amber-500/30 text-amber-300":"bg-red-500/30 text-red-300":"bg-white/5 text-slate-500 hover:bg-white/10"}`,children:c[0].toUpperCase()},c))})]},a.id)})})]},t))})]})]}),e.jsxs("div",{className:"p-4 sm:p-5 border-t border-white/10 flex gap-3 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>I(!1),className:"flex-1 py-2.5 border border-white/20 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 min-h-[44px]",children:"Cancel"}),e.jsxs("button",{type:"submit",form:"roleForm",disabled:R,className:"flex-1 py-2.5 bg-emerald-500 hover:bg-emerald-600 rounded-lg text-white font-medium flex items-center justify-center gap-2 disabled:opacity-50 min-h-[44px]",children:[R?e.jsx(fe,{size:16,className:"animate-spin"}):e.jsx(ge,{size:16}),S?"Update Role":"Create Role"]})]})]})})]})};export{ot as default};
