import{j as r}from"./react-jsx-runtime-BBsywpoz.js";import{r as s}from"./react-core-KcGD0Z1V.js";import{O as x}from"./cmp-offerlandingpage-tsx-C_ZWcrO-.js";import{a as h,j as b,k as y}from"./cmp-dashboard-CwyHj6aR.js";import{aL as j,L as P,a9 as w}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";import"./pkg-socket-D1bUdbwx.js";import"./pkg-engine-io-BZqIjJKj.js";import"./pkg-@socket.io-component-emitter-Dkula2eQ.js";import"./pkg-socket.io-parser-CafqElEs.js";import"./cmp-approutes-tsx-DORRjFJg.js";import"./cmp-skeletonloaders-tsx-Durrj7lG.js";import"./cmp-addnewduemodal-tsx-OjU2U-0e.js";import"./cmp-admincustomization-BgTFiuh2.js";import"./pkg-toast-Dpd4iwUK.js";import"./pkg-goober-N6sOClW1.js";import"./cmp-gallerypicker-tsx-T-_pXSB3.js";import"./cmp-modern-dashboard-C6grFkCj.js";import"./cmp-invoiceprinttemplate-tsx-CUwUe6zE.js";import"./pkg-papaparse-BEpmA8em.js";import"./pkg-xlsx-BljOZNTS.js";import"./page-adminnote-C1Ob2d7z.js";import"./cmp-duehistorymodal-tsx-KQ79TbYj.js";const Q=({websiteConfig:l})=>{const{activeTenantId:o,tenants:f}=h(),[n,m]=s.useState(null),[d,i]=s.useState(!0),[p,c]=s.useState(null),a=(()=>{if(typeof window>"u")return null;const e=window.location.pathname.replace(/^\/+|\/+$/g,"");return e.startsWith("offer/")?e.replace("offer/",""):e&&/^[a-z0-9-]+$/i.test(e)?e:null})(),u=f.find(e=>e.id===o)?.subdomain;s.useEffect(()=>{(async()=>{if(!(!a||!o)){i(!0),c(null);try{const t=await b(a,o,!0);m(t)}catch(t){console.error("[PublicOfferPage] Error fetching offer page:",t),c("Offer page not found")}finally{i(!1)}}})()},[a,o]);const g=async e=>{try{if(!o)throw new Error("No active tenant");await y(e.offerPageId);const t={id:`#${Math.floor(1e3+Math.random()*9e3)}`,customer:e.name,phone:e.phone,location:e.address,quantity:e.quantity,amount:(n?.price||0)*e.quantity,date:new Date().toISOString(),productName:n?.productTitle,productId:n?.productId,source:"landing_page",landingPageId:e.offerPageId,status:"Pending"};if(!(await fetch(`https://allinbangla.com/api/orders/${o}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("Failed to create order")}catch(t){throw console.error("[PublicOfferPage] Order submission error:",t),t}};return d?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-50 to-pink-50",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse",children:r.jsx(j,{className:"text-white",size:32})}),r.jsx(P,{className:"w-8 h-8 animate-spin text-purple-600 mx-auto mb-3"}),r.jsx("p",{className:"text-gray-500 font-medium",children:"Loading offer..."})]})}):p||!n?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[r.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(w,{className:"text-red-500",size:32})}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Offer Not Found"}),r.jsx("p",{className:"text-gray-500 mb-6",children:"The offer you're looking for doesn't exist or has been removed."}),r.jsx("a",{href:"/",className:"inline-flex items-center gap-2 px-3 sm:px-4 lg:px-6 py-3 bg-purple-600 text-white rounded-xl font-semibold hover:bg-purple-700 transition-colors",children:"Go to Homepage"})]})}):r.jsx(x,{offerPage:n,onOrder:g,tenantSubdomain:u,websiteConfig:l})};export{Q as default};
