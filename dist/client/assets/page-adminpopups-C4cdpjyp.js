import{j as e}from"./react-jsx-runtime-BBsywpoz.js";import{r as i}from"./react-core-KcGD0Z1V.js";import{D as w}from"./cmp-dashboard-CvCpAVHs.js";import{n as P}from"./cmp-admincustomization-DQ3Wytgo.js";import{X as k,P as O,S as R,aE as M,T as B,I as Q,aA as $,g as q,f as X}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";import"./pkg-socket-B8R9XNBE.js";import"./pkg-engine-io-C8bqYME4.js";import"./pkg-@socket.io-component-emitter-B3A4JZne.js";import"./pkg-socket.io-parser-C0hgSYjy.js";import"./cmp-approutes-tsx-T9J5ygBG.js";import"./cmp-skeletonloaders-tsx-Durrj7lG.js";import"./cmp-addnewduemodal-tsx-OjU2U-0e.js";import"./cmp-modern-dashboard-C6grFkCj.js";import"./pkg-toast-Dpd4iwUK.js";import"./pkg-goober-N6sOClW1.js";import"./cmp-invoiceprinttemplate-tsx-CUwUe6zE.js";import"./pkg-papaparse-BEpmA8em.js";import"./pkg-xlsx-BljOZNTS.js";import"./page-adminnote-C1Ob2d7z.js";import"./cmp-duehistorymodal-tsx-KQ79TbYj.js";import"./cmp-gallerypicker-tsx-CnyOus4y.js";const me=({onBack:S,tenantId:c})=>{const[n,b]=i.useState([]),[C,o]=i.useState(!1),[m,f]=i.useState(null),[u,D]=i.useState(""),[x,A]=i.useState("All"),[d,j]=i.useState(1),g=10,[s,r]=i.useState({name:"",image:"",url:"",urlType:"Internal",priority:0,status:"Draft"});i.useEffect(()=>{c&&E()},[c]);const E=async()=>{const t=await w.get("popups",[],c);b(t)},h=async t=>{await w.save("popups",t,c),b(t)},I=()=>{f(null),r({name:"",image:"",url:"",urlType:"Internal",priority:0,status:"Draft"}),o(!0)},T=t=>{f(t),r(t),o(!0)},F=async t=>{if(!confirm("Are you sure you want to delete this popup?"))return;const a=n.filter(l=>l.id!==t);await h(a)},z=async()=>{if(!s.name||!s.image){alert("Please fill in required fields: Name and Image");return}let t;if(m)t=n.map(a=>{if(a.id===m.id){const l=s.status||"Draft";return{...a,name:s.name||a.name,image:s.image||a.image,url:s.url||a.url,urlType:s.urlType||a.urlType,priority:s.priority??a.priority,status:l,updatedAt:new Date().toISOString()}}return a});else{const a={name:s.name||"",image:s.image||"",url:s.url||"",urlType:s.urlType||"Internal",priority:s.priority||0,status:s.status||"Draft",id:Date.now(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};t=[...n,a]}await h(t),o(!1),r({name:"",image:"",url:"",urlType:"Internal",priority:0,status:"Draft"})},L=t=>{const a=t.target.files?.[0];if(!a)return;const l=new FileReader;l.onloadend=()=>{r({...s,image:l.result})},l.readAsDataURL(a)},N=i.useMemo(()=>n.filter(t=>{const a=t.name.toLowerCase().includes(u.toLowerCase()),l=x==="All"||t.status===x;return a&&l}),[n,u,x]),p=Math.ceil(N.length/g),v=N.slice((d-1)*g,d*g),U=async t=>{const a=t.status==="Draft"?"Publish":"Draft",l=n.map(y=>y.id===t.id?{...y,status:a,updatedAt:new Date().toISOString()}:y);await h(l)};return e.jsxs("div",{className:"min-h-screen bg-[#F8FAFC]",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:S,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx(k,{size:24,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Popup Management"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create and manage store popups"})]})]}),e.jsxs("button",{onClick:I,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-[#38BDF8] to-[#1E90FF] text-white rounded-lg hover:from-[#2BAEE8] hover:to-[#1A7FE8] transition",children:[e.jsx(O,{size:20}),"Add Popup"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6 border border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search popups...",value:u,onChange:t=>D(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsx("div",{className:"flex gap-2",children:["All","Publish","Draft"].map(t=>e.jsxs("button",{onClick:()=>A(t),className:`px-4 py-2 rounded-lg transition ${x===t?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[t,t!=="All"&&e.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full bg-white/20 text-xs",children:n.filter(a=>a.status===t).length})]},t))})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[600px]",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Image"}),e.jsx("th",{className:"px-3 sm:px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-3 sm:px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"URL"}),e.jsx("th",{className:"px-3 sm:px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"URL Type"}),e.jsx("th",{className:"px-3 sm:px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e.jsx("th",{className:"px-3 sm:px-4 lg:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-3 sm:px-4 lg:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-3 sm:px-4 lg:px-6 py-12 text-center text-gray-500",children:'No popups found. Click "Add Popup" to create one.'})}):v.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsx("td",{className:"px-3 sm:px-4 lg:px-6 py-4 whitespace-nowrap",children:e.jsx("img",{src:P(t.image),alt:t.name,className:"h-12 w-16 object-cover rounded border border-gray-200"})}),e.jsx("td",{className:"px-3 sm:px-4 lg:px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name})}),e.jsx("td",{className:"px-3 sm:px-4 lg:px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:t.url||"-"})}),e.jsx("td",{className:"px-3 sm:px-4 lg:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:t.urlType||"-"})}),e.jsx("td",{className:"px-3 sm:px-4 lg:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:t.priority||"-"})}),e.jsx("td",{className:"px-3 sm:px-4 lg:px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>U(t),className:`px-3 py-1 rounded-full text-xs font-semibold ${t.status==="Publish"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:t.status})}),e.jsx("td",{className:"px-3 sm:px-4 lg:px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>T(t),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit",children:e.jsx(M,{size:16})}),e.jsx("button",{onClick:()=>F(t.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete",children:e.jsx(B,{size:16})})]})})]},t.id))})]})}),p>1&&e.jsxs("div",{className:"px-3 sm:px-4 lg:px-6 py-4 border-t border-gray-200 flex items-center justify-between bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",d," of ",p]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>j(t=>Math.max(1,t-1)),disabled:d===1,className:"px-3 py-1 border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-gray-700",children:"Previous"}),e.jsx("button",{onClick:()=>j(t=>Math.min(p,t+1)),disabled:d===p,className:"px-3 py-1 border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-gray-700",children:"Next"})]})]})]})]}),C&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-gray-200",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-3 sm:px-4 lg:px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:m?"Edit Popup":"Add New Popup"}),e.jsx("button",{onClick:()=>o(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx(k,{size:20,className:"text-gray-600"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Popup Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.name,onChange:t=>r({...s,name:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., Friday Up To 50% Off"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Popup Image ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:s.image,onChange:t=>r({...s,image:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Image URL or upload below"})}),e.jsxs("label",{className:"px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-200 transition flex items-center gap-2",children:[e.jsx(Q,{size:18,className:"text-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Upload"}),e.jsx("input",{type:"file",accept:"image/*",onChange:L,className:"hidden"})]})]}),s.image&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:P(s.image),alt:"Preview",className:"max-h-40 rounded border border-gray-200"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link URL (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",value:s.url,onChange:t=>r({...s,url:t.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"/products or https://example.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL Type"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:s.urlType,onChange:t=>r({...s,urlType:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent appearance-none cursor-pointer",children:[e.jsx("option",{value:"Internal",children:"Internal"}),e.jsx("option",{value:"External",children:"External"})]}),e.jsx(q,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",size:18})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority (Display Order)"}),e.jsx("input",{type:"number",value:s.priority,onChange:t=>r({...s,priority:parseInt(t.target.value)||0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"0",min:"0"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lower numbers appear first"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"Draft",checked:s.status==="Draft",onChange:t=>r({...s,status:t.target.value}),className:"w-4 h-4 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Draft"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"Publish",checked:s.status==="Publish",onChange:t=>r({...s,status:t.target.value}),className:"w-4 h-4 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Publish"})]})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-3 sm:px-4 lg:px-6 py-4 flex items-center justify-end gap-3 rounded-b-xl",children:[e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition",children:"Cancel"}),e.jsxs("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-[#38BDF8] to-[#1E90FF] text-white rounded-lg hover:from-[#2BAEE8] hover:to-[#1A7FE8] transition",children:[e.jsx(X,{size:18}),"Save Popup"]})]})]})})]})};export{me as default};
