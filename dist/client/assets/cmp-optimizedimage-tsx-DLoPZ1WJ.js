import{j as i}from"./react-jsx-runtime-BBsywpoz.js";import{r as o}from"./react-core-KcGD0Z1V.js";import{n as v,g as w}from"./cmp-admincustomization-DQ3Wytgo.js";const c="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",f=e=>!!e&&e.trim().toLowerCase().startsWith("data:"),d=e=>!!e&&e.trim().toLowerCase().startsWith("blob:");(()=>{if(typeof window>"u")return!1;try{if(import.meta?.env?.MODE==="test")return!1}catch{}try{const t=document.createElement("canvas").toDataURL("image/webp");return typeof t=="string"&&t.includes("data:image/webp")}catch{return!1}})();const C=e=>{if(f(e)||d(e))return e.trim();const t=v(e);return t?t.includes("unsplash.com")?t.replace(/w=\d+/,"w=40").replace(/q=\d+/,"q=30"):t.includes("allinbangla.com")||t.includes("/uploads/")?`${t}${t.includes("?")?"&":"?"}w=40&q=30`:c:c},S=e=>e?e<=320?"thumb":e<=480?"small":e<=720?"medium":e<=1024?"large":"full":"medium",F=(e,t)=>{if(!e)return c;if(f(e)||d(e))return e.trim();const s=v(e);return w(s,S(t))||s||c},M=(e,t)=>{if(!e||f(e)||d(e))return"";const s=v(e);if(!s)return"";const n=[320,480,720,960,1280].filter(r=>!t||r<=Math.max(t,1280));return n.map(r=>w(s,S(r))).filter(Boolean).map((r,a)=>`${r} ${n[a]}w`).join(", ")},T=o.memo(({src:e,alt:t,className:s="",width:n,height:p,priority:r=!1,placeholder:a="empty",objectFit:h="cover",onLoad:E,onError:I,rootMargin:y="400px",eager:l=!1,style:$})=>{const[u,O]=o.useState(!1),[B,L]=o.useState(!1),[A,N]=o.useState(!1),[b,j]=o.useState(r||l),g=o.useRef(null);o.useEffect(()=>{if(r||l||b)return;if(typeof IntersectionObserver>"u"){j(!0);return}const x=new IntersectionObserver(([P])=>{P.isIntersecting&&(j(!0),x.disconnect())},{rootMargin:y,threshold:.01});return g.current&&x.observe(g.current),()=>x.disconnect()},[r,l,b,y]);const U=()=>{O(!0),E?.()},k=()=>{if(!A&&e&&!f(e)&&!d(e)){N(!0);return}L(!0),I?.()},m=e?.trim()||"",R=A?m:F(m,n),z=A?"":M(m,n),D=a==="blur"?C(m):c,q=n?`(max-width: ${n}px) 100vw, ${n}px`:"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw";return B?i.jsx("div",{className:`bg-gray-100 flex items-center justify-center ${s}`,style:{width:n,height:p},children:i.jsx("span",{className:"text-gray-400 text-xs",children:"Failed to load"})}):i.jsxs("div",{className:`relative overflow-hidden ${s}`,ref:g,children:[!u&&a==="blur"&&i.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse","aria-hidden":"true"}),!u&&a==="blur"&&i.jsx("img",{src:D,alt:"",className:"absolute inset-0 w-full h-full object-cover filter blur-lg scale-110","aria-hidden":"true"}),!u&&(a==="empty"||a==="skeleton")&&i.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse"}),b&&i.jsx("img",{src:R,srcSet:z||void 0,sizes:z?q:void 0,alt:t,width:n,height:p,loading:r||l?"eager":"lazy",decoding:r?"sync":"async",onLoad:U,onError:k,className:`w-full h-full transition-opacity duration-300 ${h==="contain"?"object-contain":"object-cover"} ${u?"opacity-100":"opacity-0"}`,style:$,...r?{fetchpriority:"high"}:{}})]})});T.displayName="OptimizedImage";export{T as O};
