import{j as e}from"./react-jsx-runtime-BBsywpoz.js";import{r as l}from"./react-core-KcGD0Z1V.js";import{toast as h}from"./pkg-toast-Dpd4iwUK.js";import{g as N}from"./cmp-addnewduemodal-tsx-OjU2U-0e.js";import{L as u,c as w,R as H,S as T,g,bk as $,aB as E,bf as D,ah as U,Y as k}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";import"./pkg-goober-N6sOClW1.js";const z=()=>{if(typeof window>"u")return"https://allinbangla.com/api";const t=window.location.hostname;if(t==="localhost"||t==="127.0.0.1"||t.endsWith(".localhost"))return"http://localhost:5001/api";const n=t.split("."),x=n.length>2?n.slice(-2).join("."):t;return`${window.location.protocol}//${x}/api`},S=z(),F={pending:{label:"Pending",color:"bg-yellow-100 text-yellow-700 border-yellow-200",icon:k},"in-progress":{label:"In Progress",color:"bg-blue-100 text-blue-700 border-blue-200",icon:u},completed:{label:"Completed",color:"bg-green-100 text-green-700 border-green-200",icon:U},rejected:{label:"Rejected",color:"bg-red-100 text-red-700 border-red-200",icon:D}},B={Low:{label:"Low",color:"bg-slate-100 text-slate-600"},Standard:{label:"Standard",color:"bg-blue-100 text-blue-600"},"High (ASAP)":{label:"High (ASAP)",color:"bg-red-100 text-red-600"}},_=()=>{const[t,n]=l.useState([]),[x,f]=l.useState(!0),[o,C]=l.useState(""),[i,A]=l.useState("all"),[c,P]=l.useState("all"),[b,j]=l.useState(null),y=async()=>{f(!0);try{const s=N(),a=await(await fetch(`${S}/tenants/app-requests/all`,{headers:{Authorization:s.Authorization||""}})).json();a.success&&n(a.requests)}catch(s){console.error("Error fetching app requests:",s),h.error("Failed to load app requests")}finally{f(!1)}};l.useEffect(()=>{y()},[]);const L=async(s,r)=>{j(s);try{const a=N(),p=await(await fetch(`${S}/tenants/app-requests/${s}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:a.Authorization||""},body:JSON.stringify({status:r})})).json();if(p.success)n(I=>I.map(m=>m.id===s?{...m,status:r}:m)),h.success("Status updated successfully");else throw new Error(p.error)}catch(a){console.error("Error updating status:",a),h.error("Failed to update status")}finally{j(null)}},v=t.filter(s=>{const r=s.appTitle.toLowerCase().includes(o.toLowerCase())||s.description.toLowerCase().includes(o.toLowerCase())||(s.tenantName||"").toLowerCase().includes(o.toLowerCase()),a=i==="all"||s.status===i,d=c==="all"||s.priority===c;return r&&a&&d}),R=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(u,{className:"w-8 h-8 animate-spin text-teal-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(w,{className:"w-7 h-7 text-teal-600"}),"App Requests"]}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Manage mobile app requests from tenants"})]}),e.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[e.jsx(H,{className:"w-4 h-4"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Requests"})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-xl p-4 border border-yellow-200",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-700",children:t.filter(s=>s.status==="pending").length}),e.jsx("div",{className:"text-sm text-yellow-600",children:"Pending"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:t.filter(s=>s.status==="in-progress").length}),e.jsx("div",{className:"text-sm text-blue-600",children:"In Progress"})]}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-4 border border-green-200",children:[e.jsx("div",{className:"text-2xl font-bold text-green-700",children:t.filter(s=>s.status==="completed").length}),e.jsx("div",{className:"text-sm text-green-600",children:"Completed"})]})]}),e.jsx("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search by app title, description, or tenant...",value:o,onChange:s=>C(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:i,onChange:s=>A(s.target.value),className:"appearance-none pl-4 pr-10 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-teal-500 bg-white cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsx(g,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:c,onChange:s=>P(s.target.value),className:"appearance-none pl-4 pr-10 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-teal-500 bg-white cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Priority"}),e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Standard",children:"Standard"}),e.jsx("option",{value:"High (ASAP)",children:"High (ASAP)"})]}),e.jsx(g,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"})]})]})}),e.jsx("div",{className:"space-y-4",children:v.length===0?e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 lg:p-8 border border-gray-200 text-center",children:[e.jsx(w,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No app requests found"}),e.jsx("p",{className:"text-gray-500 mt-1",children:o||i!=="all"||c!=="all"?"Try adjusting your filters":"App requests from tenants will appear here"})]}):v.map(s=>{const r=F[s.status],a=B[s.priority],d=r.icon;return e.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200 hover:border-teal-300 transition-colors",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.appTitle}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${a.color}`,children:a.label})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:s.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:s.tenantName||s.tenantId})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:R(s.createdAt)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Platforms:"}),s.platforms.android&&e.jsx("span",{className:"bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs",children:"Android"}),s.platforms.ios&&e.jsx("span",{className:"bg-gray-100 text-gray-700 px-2 py-0.5 rounded text-xs",children:"iOS"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full border ${r.color}`,children:[e.jsx(d,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:r.label})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:s.status,onChange:p=>L(s.id,p.target.value),disabled:b===s.id,className:"appearance-none pl-3 pr-8 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-teal-500 bg-white cursor-pointer text-sm disabled:opacity-50",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),b===s.id?e.jsx(u,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 animate-spin text-teal-600"}):e.jsx(g,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none"})]})]})]})},s.id)})})]})};export{_ as default};
