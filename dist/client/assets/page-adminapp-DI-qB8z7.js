const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/cmp-dashboard-CwyHj6aR.js","assets/react-jsx-runtime-BBsywpoz.js","assets/react-core-KcGD0Z1V.js","assets/pkg-eventemitter3-CXfM2dhT.js","assets/pkg-socket-D1bUdbwx.js","assets/pkg-engine-io-BZqIjJKj.js","assets/pkg-@socket.io-component-emitter-Dkula2eQ.js","assets/pkg-socket.io-parser-CafqElEs.js","assets/cmp-approutes-tsx-DORRjFJg.js","assets/cmp-skeletonloaders-tsx-Durrj7lG.js","assets/cmp-addnewduemodal-tsx-OjU2U-0e.js","assets/icons-chunk-AVFeydwE.js","assets/cmp-admincustomization-BgTFiuh2.js","assets/pkg-toast-Dpd4iwUK.js","assets/pkg-goober-N6sOClW1.js","assets/cmp-gallerypicker-tsx-T-_pXSB3.js","assets/cmp-modern-dashboard-C6grFkCj.js","assets/cmp-invoiceprinttemplate-tsx-CUwUe6zE.js","assets/pkg-papaparse-BEpmA8em.js","assets/pkg-xlsx-BljOZNTS.js","assets/page-adminnote-C1Ob2d7z.js","assets/cmp-duehistorymodal-tsx-KQ79TbYj.js","assets/page-admincustomization-CKFkx9BN.js","assets/page-admin-misc-9t9NRjQp.js","assets/cmp-comingsoonmodal-tsx-Df-osLaF.js","assets/cmp-richtexteditor-tsx-CETSPEY1.js","assets/page-admincontrolnew-Ctue68ov.js","assets/page-admindeliverysettings-9hODfXRd.js","assets/page-admincouriersettings-COL_c04q.js","assets/page-admindailytarget-BYaZKL-e.js","assets/page-admingallery-4QzAulc3.js","assets/page-adminpopups-D07bgjGN.js","assets/page-adminfacebookpixel-FgBu_dPn.js","assets/page-admingtm-DDFX95ZQ.js","assets/page-adminlandingpage-LLMAXpbg.js","assets/cmp-offerpagemanager-tsx-BU8S1gwI.js","assets/cmp-offerpagebuilder-tsx-BSnvb4-Q.js","assets/cmp-offerlandingpage-tsx-C_ZWcrO-.js","assets/cmp-createlandingpageform-tsx-CDZzsz-O.js","assets/cmp-storestudio-D7XXsQK0.js","assets/pkg-@dnd-kit-core-4YIDk7Uu.js","assets/react-dom-B3Ccfrsk.js","assets/scheduler-CWG1rEj-.js","assets/pkg-@dnd-kit-utilities--PP7VXwB.js","assets/pkg-@dnd-kit-accessibility-SF-Pdgkw.js","assets/pkg-@dnd-kit-sortable-CjzoCWK2.js","assets/page-adminsupport-M64vdZps.js","assets/page-adminfigmaintegration-4KNiCIN4.js","assets/page-adminexpenses-D8ZrEAFT.js","assets/page-adminincome-Bgk-Ur8v.js","assets/page-adminduelist-B5Y7eGO9.js"])))=>i.map(i=>d[i]);
import{_ as c}from"./cmp-approutes-tsx-DORRjFJg.js";import{j as n}from"./react-jsx-runtime-BBsywpoz.js";import{r as s,R as lt}from"./react-core-KcGD0Z1V.js";import{L as ut,F as _t,D as P,a as pt,b as gt,e as mt}from"./cmp-dashboard-CwyHj6aR.js";import{g as je,a as $,b as J,u as ht,c as ft,e as yt,f as Dt,h as bt,j as wt,k as St}from"./cmp-addnewduemodal-tsx-OjU2U-0e.js";import{toast as m}from"./pkg-toast-Dpd4iwUK.js";import{PageSkeleton as Et,ActivityLogSkeleton as At,CustomersSkeleton as Pt,InventorySkeleton as xt,ProductsSkeleton as Rt,OrdersSkeleton as kt,DashboardSkeleton as vt}from"./cmp-skeletonloaders-tsx-Durrj7lG.js";import{A as jt}from"./cmp-aichatassistant-tsx-Dg6eI0Im.js";import Ot from"./page-adminduelist-B5Y7eGO9.js";import{S as Ct}from"./cmp-subscriptionrenewalpopup-tsx-laai0A3h.js";import{S as Lt}from"./cmp-subscriptionnotification-tsx-CfCms1bK.js";const H=30,Oe=7,zt=26;function It(e,_=new Date){if(!e||!e.packageStartDate)return{daysRemaining:H,daysOverdue:0,isExpired:!1,isInGracePeriod:!1,isBlocked:!1,shouldShowNotification:!1,shouldShowRenewalPopup:!1,canDismissPopup:!0,expiryDate:new Date(Date.now()+H*24*60*60*1e3),packageEndDate:new Date(Date.now()+H*24*60*60*1e3),graceEndDate:new Date(Date.now()+(H+Oe)*24*60*60*1e3)};const t=e.packageDays||H,p=e.gracePeriodDays||Oe,h=new Date(e.packageStartDate),d=new Date(h);d.setDate(d.getDate()+t);const D=new Date(d);D.setDate(D.getDate()+p);const l=1440*60*1e3,g=new Date(_.getFullYear(),_.getMonth(),_.getDate()),N=new Date(d.getFullYear(),d.getMonth(),d.getDate()).getTime()-g.getTime(),b=Math.ceil(N/l),E=b<0?Math.abs(b):0,R=b<=0,f=R&&E<=p,v=e.isBlocked||E>p,B=t-b>=zt&&b>0;let j=!1;if(e.lastNotificationShown){const A=new Date(e.lastNotificationShown),U=new Date(A.getFullYear(),A.getMonth(),A.getDate());j=g.getTime()===U.getTime()}const O=B&&!j,F=R,C=f;return{daysRemaining:Math.max(0,b),daysOverdue:E,isExpired:R,isInGracePeriod:f,isBlocked:v,shouldShowNotification:O,shouldShowRenewalPopup:F,canDismissPopup:C,expiryDate:d,packageEndDate:d,graceEndDate:D}}function Ie(e){return`subscription_notification_dismissed_${e}`}function Ft(e){try{const _=Ie(e),t=localStorage.getItem(_);if(!t)return!1;const p=new Date(t),h=new Date;return p.getFullYear()===h.getFullYear()&&p.getMonth()===h.getMonth()&&p.getDate()===h.getDate()}catch{return!1}}function Ut(e){try{const _=Ie(e);localStorage.setItem(_,new Date().toISOString())}catch{}}const Tt="subscription_popup_dismissed_";function Fe(e){return`${Tt}${e}`}function Vt(e){if(!e)return!1;try{return sessionStorage.getItem(Fe(e))==="true"}catch{return!1}}function Nt(e){if(e)try{sessionStorage.setItem(Fe(e),"true")}catch{}}function Bt({tenantId:e,subscription:_,enabled:t=!0}){const[p,h]=s.useState(!1),[d,D]=s.useState(!1),l=s.useMemo(()=>It(_),[_]);s.useEffect(()=>{if(e&&t){const f=Ft(e);h(f);const v=Vt(e);D(v)}},[e,t]);const g=s.useCallback(()=>{e&&(Ut(e),h(!0))},[e]),x=s.useCallback(()=>{e&&l.canDismissPopup&&(Nt(e),D(!0))},[e,l.canDismissPopup]),N=s.useCallback(()=>{},[]),b=t&&l.shouldShowNotification&&!p&&!l.isExpired,E=t&&l.shouldShowRenewalPopup&&!d,R=s.useMemo(()=>{if(l.isBlocked)return"Your subscription has expired. Please renew to continue using the platform.";if(l.isInGracePeriod){const f=7-l.daysOverdue;return`Your subscription expired ${l.daysOverdue} day${l.daysOverdue!==1?"s":""} ago. You have ${f} day${f!==1?"s":""} left to renew before your account is blocked.`}return l.isExpired?"Your subscription has expired. Please renew to continue.":l.daysRemaining<=4?`Your subscription expires in ${l.daysRemaining} day${l.daysRemaining!==1?"s":""}. Renew now to avoid service interruption.`:""},[l]);return{status:l,showNotification:b,dismissNotification:g,showRenewalPopup:E,dismissRenewalPopup:x,canDismissPopup:l.canDismissPopup,handleRenew:N,isBlocked:l.isBlocked,daysRemaining:l.daysRemaining,daysOverdue:l.daysOverdue,expiryMessage:R}}const Mt=s.lazy(()=>c(()=>import("./cmp-dashboard-CwyHj6aR.js").then(e=>e.r),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),Yt=s.lazy(()=>c(()=>import("./cmp-dashboard-CwyHj6aR.js").then(e=>e.t),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),$t=s.lazy(()=>c(()=>import("./cmp-dashboard-CwyHj6aR.js").then(e=>e.v),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),Ht=s.lazy(()=>c(()=>import("./page-admincustomization-CKFkx9BN.js"),__vite__mapDeps([22,1,2,3,13,14,12,15,0,4,5,6,7,8,9,10,11,16,17,18,19,20,21]))),Gt=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.A),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),Wt=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.a),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),Xt=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.b),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),Kt=s.lazy(()=>c(()=>import("./page-admincontrolnew-Ctue68ov.js"),__vite__mapDeps([26,1,2,3,11]))),Jt=s.lazy(()=>c(()=>import("./cmp-dashboard-CwyHj6aR.js").then(e=>e.w),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),Qt=s.lazy(()=>c(()=>import("./cmp-dashboard-CwyHj6aR.js").then(e=>e.x),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),qt=s.lazy(()=>c(()=>import("./cmp-dashboard-CwyHj6aR.js").then(e=>e.y),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),Zt=s.lazy(()=>c(()=>import("./page-admindeliverysettings-9hODfXRd.js"),__vite__mapDeps([27,1,2,3,13,14,11]))),es=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.c),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),ts=s.lazy(()=>c(()=>import("./page-admincouriersettings-COL_c04q.js"),__vite__mapDeps([28,1,2,3,13,14,10,11]))),ss=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.d),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),os=s.lazy(()=>c(()=>import("./page-admindailytarget-BYaZKL-e.js"),__vite__mapDeps([29,1,2,3,11]))),ns=s.lazy(()=>c(()=>import("./page-admingallery-4QzAulc3.js"),__vite__mapDeps([30,1,2,3,0,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),as=s.lazy(()=>c(()=>import("./page-adminpopups-D07bgjGN.js"),__vite__mapDeps([31,1,2,3,0,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),is=s.lazy(()=>c(()=>import("./page-adminfacebookpixel-FgBu_dPn.js"),__vite__mapDeps([32,1,2,3,11]))),rs=s.lazy(()=>c(()=>import("./page-admingtm-DDFX95ZQ.js"),__vite__mapDeps([33,1,2,3,0,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),cs=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.e),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),Ce=s.lazy(()=>c(()=>import("./page-adminlandingpage-LLMAXpbg.js"),__vite__mapDeps([34,1,2,3,0,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,35,36,37,38]))),ds=s.lazy(()=>c(()=>import("./cmp-storestudio-D7XXsQK0.js").then(e=>e.i),__vite__mapDeps([39,8,1,2,3,9,13,14,40,41,42,43,44,45,11]))),ls=s.lazy(()=>c(()=>import("./page-adminsupport-M64vdZps.js"),__vite__mapDeps([46,1,2,3,10,11,13,14,25]))),us=s.lazy(()=>c(()=>import("./page-adminfigmaintegration-4KNiCIN4.js"),__vite__mapDeps([47,1,2,3,13,14,11]))),_s=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.f),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),ps=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.g),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),gs=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.h),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),ms=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.i),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),hs=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.j),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),fs=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.k),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),ys=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.l),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),Ds=s.lazy(()=>c(()=>import("./page-adminexpenses-D8ZrEAFT.js"),__vite__mapDeps([48,1,2,3,0,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),bs=s.lazy(()=>c(()=>import("./page-adminincome-Bgk-Ur8v.js"),__vite__mapDeps([49,1,2,3,0,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),ws=s.lazy(()=>c(()=>import("./page-admin-misc-9t9NRjQp.js").then(e=>e.m),__vite__mapDeps([23,1,2,3,9,12,13,14,15,0,4,5,6,7,8,10,11,16,17,18,19,20,21,24,25]))),Ss=s.lazy(()=>c(()=>import("./page-adminduelist-B5Y7eGO9.js"),__vite__mapDeps([50,1,2,3,10,11,21]))),Es=({section:e})=>{switch(e){case"dashboard":return n.jsx(vt,{});case"orders":return n.jsx(kt,{});case"products":return n.jsx(Rt,{});case"inventory":return n.jsx(xt,{});case"customers_reviews":return n.jsx(Pt,{});case"activity_log":return n.jsx(At,{});default:return n.jsx(Et,{})}},As=({children:e,onSwitchView:_,activePage:t,onNavigate:p,logo:h,user:d,onLogout:D,tenants:l,activeTenantId:g,activeTenantSubdomain:x,onTenantChange:N,isTenantSwitching:b,onOpenChatCenter:E,hasUnreadChat:R,userPermissions:f={},onOrderNotificationClick:v})=>{const I=t.startsWith("settings")?"settings":t,[B,j]=s.useState(""),{hostTenantSlug:O,tenants:F,activeTenantId:C}=pt();s.useEffect(()=>{const T=(()=>{if(O)return O;if(x)return x;const V=F.find(S=>S.id===C||S._id===C);if(V?.subdomain)return V.subdomain;const L=l?.find(S=>S.id===g||S._id===g);return L?.subdomain?L.subdomain:""})();T?j(T):g&&P.listTenants().then(V=>{const L=V.find(S=>S.id===g||S._id===g);L?.subdomain&&j(L.subdomain)}).catch(()=>{})},[O,x,F,C,l,g]);const A=B,{notifications:U,unreadCount:G,markAsRead:Q}=gt({tenantId:g,autoFetch:!0,autoConnect:!0,pollingInterval:3e4});return n.jsx(mt,{sidebarProps:{activeItem:I,onNavigate:p,onLogoutClick:D,userRole:d?.role,permissions:f},headerProps:{user:d,tenantId:g,tenantSubdomain:A,currentPage:t,searchQuery:"",onSearchChange:()=>{},onSearch:()=>{},onNavigate:p,notificationCount:G,notifications:U,onMarkNotificationRead:Q,onOrderNotificationClick:v,unreadChatCount:R?1:0,onChatClick:E},children:n.jsx("div",{className:"animate-fade-in",children:e})})},Ue={dashboard:"/dashboard",orders:"/orders",products:"/products",inventory:"/inventory",customers_reviews:"/customers",customization:"/customization",landing_pages:"/landing-pages",store_studio:"/store-studio",gallery:"/gallery",admin_control:"/admin-control",business_report:"/reports",business_report_purchase:"/reports",business_report_expense:"/reports",business_report_income:"/reports",business_report_due_book:"/reports",business_report_profit_loss:"/reports",business_report_contact_list:"/reports",business_report_note:"/reports",expenses:"/expenses",income:"/income",purchases:"/purchases",due_book:"/due-book",activity_log:"/activity",support:"/support",tutorial:"/tutorial",profile:"/profile",settings:"/settings",catalog_categories:"/catalog/categories",catalog_subcategories:"/catalog/subcategories",catalog_childcategories:"/catalog/child-categories",catalog_brands:"/catalog/brands",catalog_tags:"/catalog/tags"},Le=()=>{const e=window.location.pathname.replace(/^\/admin/,"").replace(/^\//,"")||"dashboard";for(const[_,t]of Object.entries(Ue))if(t.replace(/^\//,"")===e)return _;return e},ze=(e,_,t)=>{if(!_)return!1;const p=_.role;if(p==="super_admin"||p==="admin"&&e!=="tenants"||p==="tenant_admin"&&e!=="tenants")return!0;if(p==="staff"){if(e==="dashboard")return!0;if(t){const d={orders:"orders",products:"products",landing_pages:"landing_pages",popups:"landing_pages",inventory:"inventory",customers:"customers",reviews:"reviews",daily_target:"daily_target",gallery:"gallery",catalog_categories:"catalog",catalog_subcategories:"catalog",catalog_childcategories:"catalog",catalog_brands:"catalog",catalog_tags:"catalog",business_report_purchase:"business_report",business_report_expense:"business_report",business_report_income:"business_report",business_report_due_book:"business_report",business_report_profit_loss:"business_report",business_report_contact_list:"business_report",business_report_note:"business_report",due_list:"due_book",expenses:"expenses",income:"income",purchases:"purchases",due_book:"due_book",settings:"settings",manage_shop:"settings",settings_delivery:"settings",settings_payment:"settings",settings_courier:"settings",settings_facebook_pixel:"settings",settings_gtm:"settings",settings_marketing:"settings",settings_domain:"settings",admin:"admin_control",carousel:"customization",banner:"customization",popup:"customization",website_info:"customization",theme_view:"customization",theme_colors:"customization",tenants:"tenants"}[e];if(d&&t[d])return t[d].includes("read")}return!1}return!1},Bs=({user:e,userPermissions:_={},activeTenantId:t,tenants:p,orders:h,products:d,logo:D,themeConfig:l,websiteConfig:g,deliveryConfig:x,paymentMethods:N,courierConfig:b,facebookPixelConfig:E,chatMessages:R,onLogout:f,onUpdateOrder:v,onAddProduct:I,onUpdateProduct:B,onDeleteProduct:j,onBulkDeleteProducts:O,onBulkUpdateProducts:F,onBulkFlashSale:C,onUpdateLogo:A,onUpdateTheme:U,onUpdateWebsiteConfig:G,onUpdateDeliveryConfig:Q,onUpdatePaymentMethods:ie,onUpdateCourierConfig:T,onUpdateProfile:V,onTenantChange:L,isTenantSwitching:S,onSwitchToStore:Te,onOpenAdminChat:re,hasUnreadChat:ce,onCreateTenant:Ps,onDeleteTenant:xs,onRefreshTenants:Rs,isTenantCreating:ks,deletingTenantId:vs,landingPages:de,onCreateLandingPage:le,onUpsertLandingPage:ue,onToggleLandingPublish:_e,onAddOrder:Ve})=>{const[o,W]=s.useState(()=>Le()),[Ne,pe]=s.useState(null),Be=s.useCallback(a=>{pe(a),W("orders"),window.history.pushState({page:"orders"},"","/admin/orders")},[]),u=a=>{if(ze(a,e,_)){W(a);const i=Ue[a]||"/"+a;window.history.pushState({page:a},"","/admin"+i)}else m.error("You do not have permission to access this page"),W("dashboard"),window.history.pushState({page:"dashboard"},"","/admin/dashboard")};lt.useEffect(()=>{const a=()=>{const i=Le();ze(i,e,_)&&W(i)};return window.addEventListener("popstate",a),()=>window.removeEventListener("popstate",a)},[e,_]);const[X,ge]=s.useState([]),[me,he]=s.useState([]),[fe,ye]=s.useState([]),[q,De]=s.useState([]),[be,we]=s.useState([]),[Me,M]=s.useState([]),[Ye,K]=s.useState([]),[Se,$e]=s.useState(!1),[Ee,Z]=s.useState(null);s.useEffect(()=>{if(!t||!e||Se)return;let a=!0;return(async()=>{try{const[r,k,w,z,ae,ct,dt,ke]=await Promise.all([$(),J(),P.getCatalog("categories",[],t),P.getCatalog("subcategories",[],t),P.getCatalog("childcategories",[],t),P.getCatalog("brands",[],t),P.getCatalog("tags",[],t),fetch("/api/courier/config",{headers:{"X-Tenant-Id":t,...je()}}).then(ve=>ve.ok?ve.json():null).catch(()=>null)]);if(!a)return;M(r),K(k),ge(w),he(z),ye(ae),De(ct),we(dt),ke&&T(ke),$e(!0)}catch(r){console.error("Failed to load admin data",r)}})(),()=>{a=!1}},[t,e,Se]);const Y=(a,i)=>({add:r=>{a(k=>{const w=[...k,{...r,tenantId:r?.tenantId||t}];return P.save(i,w,t),w})},update:r=>{a(k=>{const w=k.map(z=>z.id===r.id?{...r,tenantId:r?.tenantId||t}:z);return P.save(i,w,t),w})},delete:r=>{a(k=>{const w=k.filter(z=>z.id!==r);return P.save(i,w,t),w})}}),ee=Y(ge,"categories"),te=Y(he,"subcategories"),se=Y(ye,"childcategories"),oe=Y(De,"brands"),ne=Y(we,"tags"),Ae=e?.role==="super_admin",y=p.find(a=>a.id===t||a._id===t)||null,He=Ae?p:y?[y]:[],Ge=Ae?L:void 0,{showNotification:Pe,showRenewalPopup:We,dismissNotification:Xe,dismissRenewalPopup:Ke,canDismissPopup:Je,handleRenew:xe,isBlocked:Qe,daysRemaining:qe,daysOverdue:Ze,expiryMessage:et}=Bt({tenantId:t,subscription:y?.subscription,enabled:!!y&&e?.role!=="super_admin"}),tt=async a=>{try{await Dt({name:a.name,description:a.description||"",permissions:a.permissions||[],tenantId:a.tenantId||t});const i=await J();K(i),m.success("Role created successfully")}catch(i){console.error("Failed to create role:",i);const r=i instanceof Error?i.message:"Failed to create role";throw m.error(r),i}},st=async(a,i)=>{try{await yt(a,i);const r=await J();K(r),m.success("Role updated successfully")}catch(r){throw console.error("Failed to update role:",r),m.error(r instanceof Error?r.message:"Failed to update role"),r}},ot=async a=>{try{await ft(a);const i=await J();K(i),m.success("Role deleted successfully")}catch(i){throw console.error("Failed to delete role:",i),m.error(i instanceof Error?i.message:"Failed to delete role"),i}},nt=async(a,i)=>{try{await ht(a,i);const r=await $();M(r),m.success("User role updated successfully")}catch(r){console.error("Failed to update user role:",r),m.error(r instanceof Error?r.message:"Failed to update user role")}},at=async a=>{try{await St({...a,role:a.role||"staff"});const i=await $();M(i),m.success("User created successfully")}catch(i){console.error("Failed to create user:",i);const r=i instanceof Error?i.message:"Failed to create user";throw m.error(r),i}},it=async(a,i)=>{try{await wt(a,i);const r=await $();M(r),m.success("User updated successfully")}catch(r){throw console.error("Failed to update user:",r),m.error(r instanceof Error?r.message:"Failed to update user"),r}},rt=async a=>{try{await bt(a);const i=await $();M(i),m.success("User deleted successfully")}catch(i){throw console.error("Failed to delete user:",i),m.error(i instanceof Error?i.message:"Failed to delete user"),i}},Re=a=>{const i=y?.subdomain,r=window.location.protocol,w=window.location.host.split(".").slice(-2).join("."),ae=`${i?`${r}//${i}.${w}`:window.location.origin}/${a.urlSlug}`;window.open(ae,"_blank")};return n.jsxs(ut,{tenantId:t,children:[n.jsx(Ct,{isOpen:We,onClose:Ke,onRenew:xe,canDismiss:Je,daysOverdue:Ze,isBlocked:Qe,expiryMessage:et}),o==="dashboard"?n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{style:{position:"fixed",top:"80px",left:"280px",right:"24px",zIndex:9998},children:n.jsx(Lt,{isVisible:Pe,onDismiss:Xe,daysRemaining:qe,onRenew:xe})}),n.jsx(_t,{orders:h,products:d,tenantId:t,tenantSubdomain:y?.subdomain||"",user:e||void 0,onNavigate:u,onLogoutClick:f,hasUnreadChat:ce,onOpenAdminChat:re})]}):n.jsxs(As,{onSwitchView:Te,activePage:o,onNavigate:u,logo:D,user:e||void 0,onLogout:f,tenants:He,activeTenantId:t,activeTenantSubdomain:y?.subdomain,onTenantChange:Ge,isTenantSwitching:S,onOpenChatCenter:re,hasUnreadChat:ce,userPermissions:_,onOrderNotificationClick:Be,children:[n.jsx(s.Suspense,{fallback:n.jsx(Es,{section:o}),children:o==="orders"?n.jsx(Mt,{orders:h,courierConfig:b,onUpdateOrder:v,products:d,tenantId:t,onNewOrder:Ve,initialSelectedOrderId:Ne,onClearSelectedOrderId:()=>pe(null)}):o==="products"?n.jsx(Yt,{products:d,categories:X,brands:q,onAddProduct:()=>{Z(null),u("product-upload")},onEditProduct:a=>{Z(a),u("product-upload")},onDeleteProduct:j,onCloneProduct:a=>I({...a,id:Date.now(),name:a.name+" (Copy)"}),onBulkDelete:O,onBulkStatusUpdate:(a,i)=>F(a,{status:i}),onBulkFlashSale:C,onBulkImport:a=>{a.forEach(i=>I(i))}}):o==="product-upload"?n.jsx($t,{categories:X,subCategories:me,childCategories:fe,brands:q,tags:be,onAddProduct:Ee?B:I,onBack:()=>{Z(null),u("products")},onNavigate:u,editProduct:Ee}):o==="store_studio"?n.jsx(ds,{tenantId:t,onBack:()=>u("manage_shop"),products:d}):o==="landing_pages"?n.jsx(Ce,{tenantSubdomain:y?.subdomain||"",products:d,landingPages:de,onCreateLandingPage:le,onUpdateLandingPage:ue,onTogglePublish:_e,onPreviewLandingPage:Re}):o==="due_list"?n.jsx(Ot,{user:e,onLogout:f}):o==="inventory"?n.jsx(Qt,{products:d,tenantId:t}):o==="popups"?n.jsx(as,{onBack:()=>u("dashboard"),tenantId:t}):o==="customers_reviews"?n.jsx(ss,{orders:h,products:d,activeTenantId:t}):o==="daily_target"?n.jsx(os,{}):o==="gallery"?n.jsx(ns,{}):o==="figma"?n.jsx(us,{onBack:()=>u("gallery"),tenantId:t}):o==="billing"?n.jsx(_s,{tenant:y,onUpgrade:()=>u("settings")}):o==="tutorial"?n.jsx(ps,{}):o==="activity_log"?n.jsx(ms,{tenantId:t}):o==="profile"?n.jsx(hs,{user:e,onUpdateProfile:V,activeTenant:y}):o==="manage_shop"?n.jsx(Xt,{onNavigate:u,tenantId:t,websiteConfig:g,tenantSubdomain:y?.subdomain}):o==="settings"?n.jsx(Wt,{courierConfig:b,onUpdateCourierConfig:T,onNavigate:u,activeTenant:y,logo:D,onUpdateLogo:A}):o==="sms_marketing"?n.jsx(gs,{tenantId:t,onBack:()=>u("manage_shop")}):o==="support"?n.jsx(ls,{user:e,activeTenant:y}):o==="settings_delivery"?n.jsx(Zt,{configs:x,onSave:Q,onBack:()=>u("settings")}):o==="settings_payment"?n.jsx(es,{tenantId:t,onBack:()=>u("settings"),onUpdatePaymentMethods:ie}):o==="settings_courier"?n.jsx(ts,{config:b,onSave:T,onBack:()=>u("settings"),tenantId:t}):o==="settings_facebook_pixel"?n.jsx(is,{config:E,onSave:async a=>{await fetch("/api/facebook-pixel/config",{method:"POST",headers:{"Content-Type":"application/json","X-Tenant-Id":t,...je()},body:JSON.stringify(a)}),m.success("Facebook Pixel config saved")},onBack:()=>u("settings_marketing")}):o==="settings_gtm"?n.jsx(rs,{onBack:()=>u("settings_marketing"),tenantId:t}):o==="settings_marketing"?n.jsx(cs,{onBack:()=>u("settings"),onNavigate:u}):o==="settings_domain"?n.jsx(fs,{onBack:()=>u("settings"),tenantId:t}):o==="settings_rewards"?n.jsx(ys,{tenantId:t,onBack:()=>u("settings")}):o==="admin_control"?n.jsx(Kt,{users:Me,roles:Ye,onAddUser:at,onUpdateUser:it,onDeleteUser:rt,onAddRole:tt,onUpdateRole:st,onDeleteRole:ot,onUpdateUserRole:nt,currentUser:e,tenantId:t,userPermissions:_}):o.startsWith("catalog_")?n.jsx(Jt,{view:o,onNavigate:u,categories:X,subCategories:me,childCategories:fe,brands:q,tags:be,onAddCategory:ee.add,onUpdateCategory:ee.update,onDeleteCategory:ee.delete,onAddSubCategory:te.add,onUpdateSubCategory:te.update,onDeleteSubCategory:te.delete,onAddChildCategory:se.add,onUpdateChildCategory:se.update,onDeleteChildCategory:se.delete,onAddBrand:oe.add,onUpdateBrand:oe.update,onDeleteBrand:oe.delete,onAddTag:ne.add,onUpdateTag:ne.update,onDeleteTag:ne.delete}):o==="expenses"?n.jsx(Ds,{tenantId:t}):o==="income"?n.jsx(bs,{tenantId:t}):o==="purchases"?n.jsx(ws,{products:d,tenantId:t,categories:X}):o==="due_book"?n.jsx(Ss,{user:e,onLogout:f}):o==="business_report"||o.startsWith("business_report_")?n.jsx(qt,{initialTab:o,orders:h,products:d,user:e,onLogout:f,tenantId:t}):o==="website_content_landing_page"?n.jsx(Ce,{tenantSubdomain:y?.subdomain||"",products:d,landingPages:de,onCreateLandingPage:le,onUpdateLandingPage:ue,onTogglePublish:_e,onPreviewLandingPage:Re}):o==="website_content"||o==="carousel"||o==="campaigns"||o==="popup"||o==="website_info"||o==="chat_settings"||o==="website_content_carousel"||o==="website_content_banners"||o==="website_content_popups"?n.jsx(Gt,{tenantId:t,logo:D,onUpdateLogo:A,themeConfig:l??void 0,onUpdateTheme:U,websiteConfig:g,onUpdateWebsiteConfig:G,products:d,initialTab:o==="website_content"||o==="website_content_carousel"?"carousel":o==="website_content_banners"?"campaigns":o==="website_content_popups"?"popup":o}):n.jsx(Ht,{tenantId:t,logo:D,onUpdateLogo:A,themeConfig:l??void 0,onUpdateTheme:U,websiteConfig:g,onUpdateWebsiteConfig:G,products:d,initialTab:o==="customization"?"theme_view":o})}),n.jsx(jt,{tenantId:t,shopName:y?.name,onNavigate:u})]})]})};export{Bs as A};
