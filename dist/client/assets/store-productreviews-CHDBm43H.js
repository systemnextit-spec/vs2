import{j as e}from"./react-jsx-runtime-BBsywpoz.js";import{r as a}from"./react-core-KcGD0Z1V.js";import{D as F}from"./cmp-dashboard-CvCpAVHs.js";import n from"./pkg-toast-Dpd4iwUK.js";import{ab as g,X as V,N as W,a3 as B,aK as G,b$ as Y}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";import"./pkg-socket-B8R9XNBE.js";import"./pkg-engine-io-C8bqYME4.js";import"./pkg-@socket.io-component-emitter-B3A4JZne.js";import"./pkg-socket.io-parser-C0hgSYjy.js";import"./cmp-approutes-tsx-T9J5ygBG.js";import"./cmp-skeletonloaders-tsx-Durrj7lG.js";import"./cmp-addnewduemodal-tsx-OjU2U-0e.js";import"./cmp-admincustomization-DQ3Wytgo.js";import"./cmp-gallerypicker-tsx-CnyOus4y.js";import"./cmp-modern-dashboard-C6grFkCj.js";import"./cmp-invoiceprinttemplate-tsx-CUwUe6zE.js";import"./pkg-papaparse-BEpmA8em.js";import"./pkg-xlsx-BljOZNTS.js";import"./page-adminnote-C1Ob2d7z.js";import"./cmp-duehistorymodal-tsx-KQ79TbYj.js";import"./pkg-goober-N6sOClW1.js";const xe=({productId:m,productName:q,tenantId:c,user:p,onLoginClick:f})=>{const[o,b]=a.useState([]),[P,y]=a.useState(!0),[j,v]=a.useState(!1),[N,x]=a.useState(!1),[h,w]=a.useState(5),[S,R]=a.useState(""),[i,z]=a.useState(""),[C,D]=a.useState(0);a.useEffect(()=>{E()},[m,c]);const E=async()=>{try{y(!0);const t=await F.getProductReviews(m,c);b(t||[])}catch(t){console.error("Failed to load reviews:",t)}finally{y(!1)}},A=async t=>{if(t.preventDefault(),!p){n.error("Please login to write a review"),f();return}if(!i.trim()){n.error("Please write a review comment");return}if(i.trim().length<10){n.error("Review must be at least 10 characters long");return}v(!0);try{const s=await F.submitReview({productId:m,rating:h,comment:i.trim(),headline:S.trim()||void 0},c);b(l=>[s,...l]),w(5),R(""),z(""),x(!1),n.success("Review submitted successfully! ðŸŽ‰")}catch(s){n.error(s.message||"Failed to submit review")}finally{v(!1)}},u=(t,s,l,M="md")=>{const U=l&&C>0?C:t,$={sm:14,md:20,lg:28};return e.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(d=>e.jsx("button",{type:"button",onClick:()=>s?.(d),onMouseEnter:()=>l?.(d),onMouseLeave:()=>l?.(0),className:`transition-all duration-200 ${s?"cursor-pointer hover:scale-110":"cursor-default"}`,disabled:!s,children:e.jsx(g,{size:$[M],className:`transition-colors ${d<=U?"fill-amber-400 text-amber-400":"text-gray-300"}`})},d))})},k=o.length>0?(o.reduce((t,s)=>t+s.rating,0)/o.length).toFixed(1):"0.0",r=o.filter(t=>t.status==="approved"),L={5:r.filter(t=>t.rating===5).length,4:r.filter(t=>t.rating===4).length,3:r.filter(t=>t.rating===3).length,2:r.filter(t=>t.rating===2).length,1:r.filter(t=>t.rating===1).length};return e.jsxs("div",{className:"space-y-6",children:[r.length>0&&e.jsx("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-4 sm:p-6 border border-amber-100",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-4 lg:gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl font-bold text-gray-900",children:k}),e.jsx("div",{className:"mt-2",children:u(parseFloat(k),void 0,void 0,"md")}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[r.length," reviews"]})]}),e.jsx("div",{className:"flex-1 space-y-2 w-full sm:w-auto",children:[5,4,3,2,1].map(t=>{const s=L[t],l=r.length>0?s/r.length*100:0;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600 w-3",children:t}),e.jsx(g,{size:14,className:"fill-amber-400 text-amber-400"}),e.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-amber-400 to-orange-400 rounded-full transition-all duration-500",style:{width:`${l}%`}})}),e.jsx("span",{className:"text-xs text-gray-500 w-8",children:s})]},t)})})]})}),N&&e.jsxs("form",{onSubmit:A,className:"bg-white rounded-2xl p-4 sm:p-6 border border-gray-200 shadow-lg space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Share Your Experience"}),e.jsx("button",{type:"button",onClick:()=>x(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(V,{size:20,className:"text-gray-500"})})]}),e.jsxs("div",{className:"text-center py-4 bg-gray-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Rate this product"}),e.jsx("div",{className:"flex justify-center",children:u(h,w,D,"lg")}),e.jsx("p",{className:"text-sm font-medium text-gray-700 mt-2",children:["","Poor","Fair","Good","Very Good","Excellent"][h]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Review Title (optional)"}),e.jsx("input",{type:"text",value:S,onChange:t=>R(t.target.value),placeholder:"Summarize your experience...",maxLength:100,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Review"}),e.jsx("textarea",{value:i,onChange:t=>z(t.target.value),placeholder:"Share your thoughts about this product... What did you like? Would you recommend it?",rows:4,minLength:10,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none transition-all"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[i.length,"/500 characters"]})]}),e.jsx("button",{type:"submit",disabled:j||i.length<10,className:"w-full py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white font-bold rounded-xl hover:from-emerald-600 hover:to-teal-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 transition-all shadow-lg hover:shadow-xl active:scale-[0.98]",children:j?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(W,{size:18}),"Submit Review"]})})]}),P?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-10 h-10 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"})}):r.length===0?e.jsxs("div",{className:"text-center py-16 px-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mx-auto mb-4 shadow-inner",children:e.jsx(g,{size:40,className:"text-gray-400"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-2",children:"No reviews yet"}),e.jsx("p",{className:"text-gray-500 mb-6 max-w-sm mx-auto",children:"Be the first to share your thoughts about this product and help others make informed decisions."}),!N&&e.jsxs("button",{onClick:()=>{if(!p){n.error("Please login to write a review"),f();return}x(!0)},className:"inline-flex items-center gap-2 px-3 sm:px-4 lg:px-6 py-3 bg-emerald-500 text-white font-semibold rounded-xl hover:bg-emerald-600 transition-all shadow-lg",children:[e.jsx(B,{size:18}),"Write a Review"]})]}):e.jsx("div",{className:"space-y-4",children:r.map(t=>e.jsx("div",{className:"bg-white rounded-2xl p-5 border border-gray-100 shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-full flex items-center justify-center text-white font-bold text-lg flex-shrink-0 shadow-md",children:t.userName?.charAt(0).toUpperCase()||"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-bold text-gray-900",children:t.userName}),t.isVerifiedPurchase&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full font-medium",children:[e.jsx(G,{size:12}),"Verified Purchase"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-3",children:[u(t.rating,void 0,void 0,"sm"),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(t.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),t.headline&&e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:t.headline}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.comment}),t.reply&&e.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border-l-4 border-emerald-500",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 bg-emerald-500 text-white rounded-full flex items-center justify-center",children:e.jsx(Y,{size:14})}),e.jsxs("span",{className:"font-semibold text-gray-900 text-sm",children:["Response from ",t.repliedBy||"Store"]})]}),e.jsx("p",{className:"text-sm text-gray-700 ml-8",children:t.reply}),t.repliedAt&&e.jsx("p",{className:"text-xs text-gray-500 mt-2 ml-8",children:new Date(t.repliedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]})]})},t.id))})]})};export{xe as ProductReviews,xe as default};
