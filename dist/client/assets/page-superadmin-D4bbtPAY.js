const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/superadmin-overviewtab-DaRE8-Nf.js","assets/react-jsx-runtime-BBsywpoz.js","assets/react-core-KcGD0Z1V.js","assets/pkg-eventemitter3-CXfM2dhT.js","assets/superadmin-ui-9Wkuomel.js","assets/icons-chunk-AVFeydwE.js","assets/superadmin-core-DToOS9qa.js","assets/superadmin-settingstab-C-sxy8_W.js","assets/superadmin-notificationstab-BZKTKl41.js","assets/superadmin-themeconfigtab-BvmAVMTv.js","assets/superadmin-chatconfigtab-CBumBE3M.js","assets/superadmin-subscriptionstab-CkFt01w8.js","assets/pkg-toast-Dpd4iwUK.js","assets/pkg-goober-N6sOClW1.js","assets/superadmin-bulkannouncementstab-DDYH_JL0.js","assets/superadmin-supportticketstab-BpzgH4wx.js","assets/superadmin-merchantsuccesstab-EiTuovWJ.js","assets/superadmin-analyticstab-CUEbX22h.js","assets/cmp-approutes-tsx-DORRjFJg.js","assets/cmp-skeletonloaders-tsx-Durrj7lG.js","assets/superadmin-auditlogstab-BMNRaWvk.js","assets/cmp-addnewduemodal-tsx-OjU2U-0e.js","assets/superadmin-systemhealthtab-BsUPJnmS.js","assets/superadmin-bulkoperationstab-DQ8Z7sLZ.js","assets/superadmin-tutorialstab-CK-Z6R2b.js","assets/superadmin-apkbuildstab-BPWKmk_K.js","assets/superadmin-apprequeststab-Dd_GwcW7.js","assets/superadmin-adsmanagementtab-CJQtUvJ3.js","assets/page-admintenantmanagement-Cne9bRUt.js"])))=>i.map(i=>d[i]);
import{_ as w}from"./cmp-approutes-tsx-DORRjFJg.js";import{j as s}from"./react-jsx-runtime-BBsywpoz.js";import{r as d,R as p}from"./react-core-KcGD0Z1V.js";import{D as j}from"./cmp-dashboard-CwyHj6aR.js";import{g as S}from"./cmp-addnewduemodal-tsx-OjU2U-0e.js";import{toast as i}from"./pkg-toast-Dpd4iwUK.js";import{SuperAdminTabSkeleton as Ue}from"./cmp-skeletonloaders-tsx-Durrj7lG.js";import{S as Be,T as Me}from"./superadmin-ui-9Wkuomel.js";import{bk as Je}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";import"./pkg-socket-D1bUdbwx.js";import"./pkg-engine-io-BZqIjJKj.js";import"./pkg-@socket.io-component-emitter-Dkula2eQ.js";import"./pkg-socket.io-parser-CafqElEs.js";import"./cmp-admincustomization-BgTFiuh2.js";import"./cmp-gallerypicker-tsx-T-_pXSB3.js";import"./cmp-modern-dashboard-C6grFkCj.js";import"./cmp-invoiceprinttemplate-tsx-CUwUe6zE.js";import"./pkg-papaparse-BEpmA8em.js";import"./pkg-xlsx-BljOZNTS.js";import"./page-adminnote-C1Ob2d7z.js";import"./cmp-duehistorymodal-tsx-KQ79TbYj.js";import"./pkg-goober-N6sOClW1.js";const y="https://allinbangla.com";class T{static async getPlans(){const c=await fetch(`${y}/api/subscriptions/plans`);if(!c.ok)throw new Error("Failed to fetch plans");return(await c.json()).data}static async getActivePlans(){const c=await fetch(`${y}/api/subscriptions/plans/active`);if(!c.ok)throw new Error("Failed to fetch active plans");return(await c.json()).data}static async getPlanById(c){const l=await fetch(`${y}/api/subscriptions/plans/${c}`);if(!l.ok)throw new Error("Failed to fetch plan");return(await l.json()).data}static async createPlan(c){const l=await fetch(`${y}/api/subscriptions/plans`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!l.ok){const b=await l.json();throw new Error(b.error||"Failed to create plan")}return(await l.json()).data}static async updatePlan(c,l){const h=await fetch(`${y}/api/subscriptions/plans/${c}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!h.ok){const P=await h.json();throw new Error(P.error||"Failed to update plan")}return(await h.json()).data}static async deletePlan(c){if(!(await fetch(`${y}/api/subscriptions/plans/${c}`,{method:"DELETE"})).ok)throw new Error("Failed to delete plan")}static async getTransactions(c){const l=new URLSearchParams;c?.status&&l.append("status",c.status),c?.tenantId&&l.append("tenantId",c.tenantId),c?.limit&&l.append("limit",c.limit.toString()),c?.skip&&l.append("skip",c.skip.toString());const h=await fetch(`${y}/api/subscriptions/transactions?${l}`);if(!h.ok)throw new Error("Failed to fetch transactions");return h.json()}static async getTransactionById(c){const l=await fetch(`${y}/api/subscriptions/transactions/${c}`);if(!l.ok)throw new Error("Failed to fetch transaction");return(await l.json()).data}static async createTransaction(c){const l=await fetch(`${y}/api/subscriptions/transactions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!l.ok){const b=await l.json();throw new Error(b.error||"Failed to create transaction")}return(await l.json()).data}static async completeTransaction(c){const l=await fetch(`${y}/api/subscriptions/transactions/${c}/complete`,{method:"PATCH"});if(!l.ok)throw new Error("Failed to complete transaction");return(await l.json()).data}static async refundTransaction(c,l,h="super_admin"){const b=await fetch(`${y}/api/subscriptions/transactions/${c}/refund`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:l,refundedBy:h})});if(!b.ok){const I=await b.json();throw new Error(I.error||"Failed to refund transaction")}return(await b.json()).data}static async getInvoices(c){const l=new URLSearchParams;c?.status&&l.append("status",c.status),c?.tenantId&&l.append("tenantId",c.tenantId),c?.limit&&l.append("limit",c.limit.toString()),c?.skip&&l.append("skip",c.skip.toString());const h=await fetch(`${y}/api/subscriptions/invoices?${l}`);if(!h.ok)throw new Error("Failed to fetch invoices");return h.json()}static async getInvoiceById(c){const l=await fetch(`${y}/api/subscriptions/invoices/${c}`);if(!l.ok)throw new Error("Failed to fetch invoice");return(await l.json()).data}static async createInvoice(c){const l=await fetch(`${y}/api/subscriptions/invoices`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!l.ok){const b=await l.json();throw new Error(b.error||"Failed to create invoice")}return(await l.json()).data}static async updateInvoiceStatus(c,l){const h=await fetch(`${y}/api/subscriptions/invoices/${c}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:l})});if(!h.ok)throw new Error("Failed to update invoice status");return(await h.json()).data}static async getTrialSettings(){const c=await fetch(`${y}/api/subscriptions/trial-settings`);if(!c.ok)throw new Error("Failed to fetch trial settings");return(await c.json()).data}static async updateTrialSettings(c){const l=await fetch(`${y}/api/subscriptions/trial-settings`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!l.ok){const b=await l.json();throw new Error(b.error||"Failed to update trial settings")}return(await l.json()).data}static async getStats(){const c=await fetch(`${y}/api/subscriptions/stats`);if(!c.ok)throw new Error("Failed to fetch statistics");return(await c.json()).data}}const He=p.lazy(()=>w(()=>import("./superadmin-overviewtab-DaRE8-Nf.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Ve=p.lazy(()=>w(()=>import("./superadmin-settingstab-C-sxy8_W.js"),__vite__mapDeps([7,1,2,3,5]))),ze=p.lazy(()=>w(()=>import("./superadmin-notificationstab-BZKTKl41.js"),__vite__mapDeps([8,1,2,3,5]))),We=p.lazy(()=>w(()=>import("./superadmin-themeconfigtab-BvmAVMTv.js"),__vite__mapDeps([9,1,2,3,5]))),qe=p.lazy(()=>w(()=>import("./superadmin-chatconfigtab-CBumBE3M.js"),__vite__mapDeps([10,1,2,3,5]))),Ge=p.lazy(()=>w(()=>import("./superadmin-subscriptionstab-CkFt01w8.js"),__vite__mapDeps([11,1,2,3,12,13,5]))),Qe=p.lazy(()=>w(()=>import("./superadmin-bulkannouncementstab-DDYH_JL0.js"),__vite__mapDeps([14,1,2,3,5]))),Ke=p.lazy(()=>w(()=>import("./superadmin-supportticketstab-BpzgH4wx.js"),__vite__mapDeps([15,1,2,3,5]))),Xe=p.lazy(()=>w(()=>import("./superadmin-merchantsuccesstab-EiTuovWJ.js"),__vite__mapDeps([16,1,2,3,5]))),Ye=p.lazy(()=>w(()=>import("./superadmin-analyticstab-CUEbX22h.js"),__vite__mapDeps([17,18,1,2,3,19,5]))),Ze=p.lazy(()=>w(()=>import("./superadmin-auditlogstab-BMNRaWvk.js"),__vite__mapDeps([20,1,2,3,21,5,12,13]))),et=p.lazy(()=>w(()=>import("./superadmin-systemhealthtab-BsUPJnmS.js"),__vite__mapDeps([22,1,2,3,21,5]))),tt=p.lazy(()=>w(()=>import("./superadmin-bulkoperationstab-DQ8Z7sLZ.js"),__vite__mapDeps([23,1,2,3,12,13,5]))),at=p.lazy(()=>w(()=>import("./superadmin-tutorialstab-CK-Z6R2b.js"),__vite__mapDeps([24,1,2,3,5]))),st=p.lazy(()=>w(()=>import("./superadmin-apkbuildstab-BPWKmk_K.js"),__vite__mapDeps([25,1,2,3,21,5,12,13]))),nt=p.lazy(()=>w(()=>import("./superadmin-apprequeststab-Dd_GwcW7.js"),__vite__mapDeps([26,1,2,3,12,13,21,5]))),ot=p.lazy(()=>w(()=>import("./superadmin-adsmanagementtab-CJQtUvJ3.js"),__vite__mapDeps([27,1,2,3,12,13,21,5]))),rt=p.lazy(()=>w(()=>import("./page-admintenantmanagement-Cne9bRUt.js"),__vite__mapDeps([28,1,2,3,5]))),it={platformName:"SystemNext IT",platformUrl:"allinbangla.com",supportEmail:"support@allinbangla.com",supportPhone:"+880 1700-000000",defaultCurrency:"BDT",defaultLanguage:"English",maintenanceMode:!1,allowNewRegistrations:!0,maxTenantsPerUser:5,defaultTrialDays:14,platformLogo:null,platformFavicon:null,smtpHost:"",smtpPort:"587",smtpUser:"",smtpPassword:"",googleAnalyticsId:"",facebookPixelId:""},ct={primaryColor:"#22c55e",secondaryColor:"#ec4899",tertiaryColor:"#9333ea",fontColor:"#0f172a",hoverColor:"#f97316",surfaceColor:"#e2e8f0",darkMode:!1,adminBgColor:"#030407",adminInputBgColor:"#0f172a",adminBorderColor:"#ffffff",adminFocusColor:"#f87171",headerStyle:"style1",mobileHeaderStyle:"style1",categorySectionStyle:"style5",productCardStyle:"style1",footerStyle:"style1",bottomNavStyle:"style1"},lt={enabled:!0,whatsappNumber:"",messengerPageId:"",liveChatEnabled:!1,supportHoursFrom:"09:00",supportHoursTo:"18:00",autoReplyMessage:"Thanks for reaching out! We'll get back to you soon.",offlineMessage:"We're currently offline. Please leave a message and we'll respond during business hours."},dt=[{id:"1",title:"Scheduled Maintenance - December 29th",message:"We will be performing scheduled maintenance on our servers. Expected downtime: 2 hours.",type:"maintenance",channel:"both",targetAudience:"all",status:"scheduled",scheduledAt:"2025-12-29T02:00:00",createdAt:"2 days ago",createdBy:"Super Admin"},{id:"2",title:"New Feature: Instagram Integration",message:"We are excited to announce Instagram Shopping integration is now available for all Enterprise plans!",type:"feature",channel:"both",targetAudience:"active",status:"sent",sentAt:"2025-12-26",createdAt:"3 days ago",createdBy:"Super Admin",openRate:78,clickRate:34},{id:"3",title:"Holiday Season Tips",message:"Maximize your sales this holiday season with these proven strategies...",type:"info",channel:"email",targetAudience:"all",status:"draft",createdAt:"1 day ago",createdBy:"Super Admin"}],g=()=>s.jsx(Ue,{}),Lt=()=>{const[x,c]=d.useState(!0),[l,h]=d.useState("overview"),[b,P]=d.useState(""),[I,W]=d.useState("7d"),[f,C]=d.useState([]),[q,$]=d.useState(!1),[G,O]=d.useState(null),[Q,K]=d.useState(it),[X,D]=d.useState(!1),[Y,Z]=d.useState(ct),[ee,te]=d.useState(lt),[ae,E]=d.useState(dt),[se,A]=d.useState([]),[ut,R]=d.useState(!1),[ne,oe]=d.useState([]),[re,F]=d.useState([]),[_,ie]=d.useState([]),[ce,le]=d.useState([]),[pt,L]=d.useState(!1),[de,U]=d.useState([{id:"1",title:"System Update Available",message:"A new version of the platform is available. Please update at your earliest convenience.",type:"info",targetTenants:"all",createdAt:"2 hours ago",read:!1,priority:"medium"},{id:"2",title:"Payment Processing Issue",message:"We detected an issue with payment processing. Our team is working on resolving it.",type:"warning",targetTenants:"all",createdAt:"5 hours ago",read:!1,priority:"high"}]),m=(()=>{if(typeof window<"u"){const t=window.location.hostname;return t==="localhost"||t==="127.0.0.1"?"http://localhost:5001/api":"https://allinbangla.com/api"}return"https://allinbangla.com/api"})();d.useEffect(()=>{(async()=>{try{const e=await j.listTenants();C(e)}catch(e){console.error("Failed to load tenants:",e)}})()},[]),d.useEffect(()=>{(async()=>{R(!0);try{const e=await fetch(`${m}/support`,{headers:S()});if(e.ok){const r=((await e.json()).data||[]).map(o=>({id:o.id||o._id,tenantId:o.tenantId,tenantName:o.submittedBy?.name||"Unknown Merchant",tenantSubdomain:o.tenantId,subject:o.title||B(o.type),description:o.description,category:M(o.type),priority:o.priority||"medium",status:J(o.status),assignedTo:o.assignedTo?.name,createdAt:k(o.createdAt),updatedAt:k(o.updatedAt),messages:(o.comments||[]).map(n=>({id:n.id||n._id,senderId:n.userId,senderName:n.userName||"Unknown",senderType:n.userId===o.submittedBy?.userId?"merchant":"support",message:n.message,createdAt:k(n.createdAt)})),tags:o.images?.length>0?["has-attachments"]:[]}));A(r)}}catch(e){console.error("Failed to load support tickets:",e)}finally{R(!1)}})()},[m]);const B=t=>{switch(t){case"issue":return"Issue Report";case"feedback":return"Feedback";case"feature":return"Feature Request";default:return"Support Request"}},M=t=>{switch(t){case"issue":return"bug";case"feature":return"feature_request";case"feedback":return"general";default:return"general"}},J=t=>{switch(t){case"pending":return"open";case"in-progress":return"in_progress";case"resolved":return"resolved";case"closed":return"closed";default:return"open"}},k=t=>{if(!t)return"Unknown";const e=new Date(t),r=new Date().getTime()-e.getTime(),o=Math.floor(r/6e4),n=Math.floor(r/36e5),u=Math.floor(r/864e5);return o<1?"Just now":o<60?`${o} min ago`:n<24?`${n} hour${n>1?"s":""} ago`:u<7?`${u} day${u>1?"s":""} ago`:e.toLocaleDateString()};d.useEffect(()=>{(async()=>{if(f.length!==0){L(!0);try{const e=f.slice(0,10).map(async n=>{try{const u=await fetch(`${m}/tenants/${n.id}/stats`,{headers:S()});if(u.ok){const v=await u.json();return{id:n.id,name:n.name,subdomain:n.subdomain,plan:n.plan||"starter",status:n.status,totalOrders:v.data?.orderCount||0,totalRevenue:0,activeUsers:v.data?.userCount||0,lastActivity:n.updatedAt?k(n.updatedAt):"Unknown"}}return null}catch(u){return console.error(`Failed to load stats for tenant ${n.id}:`,u),null}}),r=(await Promise.all(e)).filter(n=>n!==null).sort((n,u)=>u.totalOrders-n.totalOrders).slice(0,5);ie(r);const o=[];f.slice(0,5).forEach((n,u)=>{n.createdAt&&o.push({id:u+1,type:"new_tenant",message:`New tenant "${n.name}" registered`,time:k(n.createdAt),icon:Je})}),le(o.slice(0,5))}catch(e){console.error("Failed to load tenant statistics:",e)}finally{L(!1)}}})()},[f,m]);const N={totalTenants:f.length,activeTenants:f.filter(t=>t.status==="active").length,totalRevenue:_.reduce((t,e)=>t+(e.totalRevenue||0),0),monthlyRevenue:_.reduce((t,e)=>t+(e.totalRevenue||0),0),totalOrders:_.reduce((t,e)=>t+e.totalOrders,0),totalUsers:_.reduce((t,e)=>t+e.activeUsers,0),serverLoad:34,uptime:"99.98%",diskUsage:45,memoryUsage:62},ue=d.useCallback(async(t,e)=>{$(!0);try{const a=await j.seedTenant(t),r=await j.listTenants(!0);return C(r),i.success(`${a.name} created successfully`),a}catch(a){const r=a instanceof Error?a.message:"Failed to create tenant";throw i.error(r),a}finally{$(!1)}},[]),H=d.useCallback(async t=>{O(t);try{await j.deleteTenant(t);const e=await j.listTenants(!0);C(e),i.success("Tenant deleted successfully")}catch(e){const a=e instanceof Error?e.message:"Failed to delete tenant";throw i.error(a),e}finally{O(null)}},[]),pe=d.useCallback(async()=>{try{const t=await j.listTenants(!0);return C(t),t}catch(t){throw console.error("Failed to refresh tenants:",t),t}},[]),he=d.useCallback(async()=>{D(!0);try{await new Promise(t=>setTimeout(t,1e3)),i.success("Platform settings saved successfully")}catch{i.error("Failed to save settings")}finally{D(!1)}},[]),me=d.useCallback(async t=>{try{const e=await fetch("/api/notifications/broadcast",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error("Failed to send notification");const a=await e.json(),r={...t,id:Date.now().toString(),createdAt:"Just now",read:!1};U(o=>[r,...o]),i.success(`Notification sent to ${a.data?.targetTenants||"all"} tenants`)}catch(e){throw i.error("Failed to send notification"),e}},[]),fe=d.useCallback(async t=>{try{if(!(await fetch(`/api/notifications/broadcast/${t}`,{method:"DELETE"})).ok)throw new Error("Failed to delete notification");U(a=>a.filter(r=>r.id!==t)),i.success("Notification deleted")}catch(e){throw i.error("Failed to delete notification"),e}},[]),V=t=>!!(t.headerStyle||t.mobileHeaderStyle||t.categorySectionStyle||t.productCardStyle||t.footerStyle||t.bottomNavStyle),ye=d.useCallback(async t=>{try{if(!(await fetch(`${m}/tenant-data/public/default_theme_config`,{method:"PUT",headers:{"Content-Type":"application/json",...S()},body:JSON.stringify({data:t})})).ok)throw new Error("Failed to save theme");Z(t),i.success("Default theme saved successfully")}catch(e){throw console.error("Failed to save theme:",e),i.error("Failed to save theme"),e}},[m]),ge=d.useCallback(async(t,e)=>{try{if(!(await fetch(`${m}/tenant-data/${t}/theme_config`,{method:"PUT",headers:{"Content-Type":"application/json",...S()},body:JSON.stringify({data:e})})).ok)throw new Error("Failed to apply theme");if(V(e)){const o=await fetch(`${m}/tenant-data/${t}/website_config`,{headers:S()});let n={};o.ok&&(n=(await o.json()).data||{});const u={...n,headerStyle:e.headerStyle||n.headerStyle,mobileHeaderStyle:e.mobileHeaderStyle||n.mobileHeaderStyle,categorySectionStyle:e.categorySectionStyle||n.categorySectionStyle,productCardStyle:e.productCardStyle||n.productCardStyle,footerStyle:e.footerStyle||n.footerStyle,bottomNavStyle:e.bottomNavStyle||n.bottomNavStyle};await fetch(`${m}/tenant-data/${t}/website_config`,{method:"PUT",headers:{"Content-Type":"application/json",...S()},body:JSON.stringify({data:u})})}const r=f.find(o=>(o.id||o._id)===t);i.success(`Theme applied to ${r?.name||"tenant"} successfully`)}catch(a){throw console.error("Failed to apply theme:",a),i.error("Failed to apply theme"),a}},[m,f]),we=d.useCallback(async t=>{try{let e=0,a=0;for(const r of f)try{const o=r.id||r._id;if(!o)continue;if(await fetch(`${m}/tenant-data/${o}/theme_config`,{method:"PUT",headers:{"Content-Type":"application/json",...S()},body:JSON.stringify({data:t})}),V(t)){const n=await fetch(`${m}/tenant-data/${o}/website_config`,{headers:S()});let u={};n.ok&&(u=(await n.json()).data||{});const v={...u,headerStyle:t.headerStyle||u.headerStyle,mobileHeaderStyle:t.mobileHeaderStyle||u.mobileHeaderStyle,categorySectionStyle:t.categorySectionStyle||u.categorySectionStyle,productCardStyle:t.productCardStyle||u.productCardStyle,footerStyle:t.footerStyle||u.footerStyle,bottomNavStyle:t.bottomNavStyle||u.bottomNavStyle};await fetch(`${m}/tenant-data/${o}/website_config`,{method:"PUT",headers:{"Content-Type":"application/json",...S()},body:JSON.stringify({data:v})})}e++}catch(o){a++,console.error("Failed to apply theme to tenant:",o)}a===0?i.success(`Theme applied to all ${e} tenants successfully`):i.success(`Theme applied to ${e} tenants, ${a} failed`)}catch(e){throw console.error("Failed to apply theme to all tenants:",e),i.error("Failed to apply theme to all tenants"),e}},[m,f]),be=d.useCallback(async t=>{try{const e=await fetch(`${m}/tenant-data/${t}/theme_config`,{headers:S()});return e.ok&&(await e.json()).data||null}catch(e){return console.error("Failed to load tenant theme:",e),null}},[m]),Se=d.useCallback(async t=>{try{await new Promise(e=>setTimeout(e,500)),te(t),i.success("Chat configuration saved")}catch(e){throw i.error("Failed to save chat configuration"),e}},[]),Te=d.useCallback(async(t,e)=>{try{await new Promise(a=>setTimeout(a,500)),i.success("Chat settings applied to tenant")}catch(a){throw i.error("Failed to apply chat settings"),a}},[]),ke=d.useCallback(async t=>{try{await new Promise(e=>setTimeout(e,1e3)),i.success("Chat settings applied to all tenants")}catch(e){throw i.error("Failed to apply chat settings to all tenants"),e}},[]),z=d.useCallback(async(t,e,a)=>{try{await new Promise(o=>setTimeout(o,500));const r=f.map(o=>o.id===t?{...o,status:e,...e==="active"&&{approvedAt:new Date().toISOString(),approvedBy:"super_admin"},...e==="inactive"&&a&&{rejectedAt:new Date().toISOString(),rejectedBy:"super_admin",rejectionReason:a},...e==="suspended"&&{suspendedAt:new Date().toISOString(),suspendedBy:"super_admin",suspensionReason:a}}:o);C(r),i.success(`Tenant status updated to ${e}`)}catch(r){throw i.error("Failed to update tenant status"),r}},[f]),je=d.useCallback(async t=>{try{const e=f.find(a=>a.id===t);if(!e)throw new Error("Tenant not found");i.success(`Ghosting as ${e.name}...`),await new Promise(a=>setTimeout(a,1e3)),console.log(`Would redirect to: https://admin.allinbangla.com?tenant=${e.subdomain} with impersonation token`)}catch(e){throw i.error("Failed to login as merchant"),e}},[f]),Ce=d.useCallback(async(t,e,a)=>{try{if(a==="custom"){if(i.loading("Verifying DNS configuration...",{id:"domain-setup"}),!(await j.verifyDomainDNS(t,e))?.dnsVerified)throw i.error(`DNS not configured correctly. Please point ${e} to our server IP first.`,{id:"domain-setup",duration:5e3}),new Error("DNS not configured. Please add an A record pointing to our server.");i.loading("Setting up domain with SSL certificate...",{id:"domain-setup"});const o=await j.setupCustomDomain(t,e);if(o.success)C(n=>n.map(u=>u.id===t?{...u,customDomain:e}:u)),i.success(`Custom domain "${e}" configured successfully with SSL!`,{id:"domain-setup",duration:5e3});else throw new Error(o.message||"Domain setup failed")}else i.error("Subdomain changes are not supported at this time")}catch(r){const o=r instanceof Error?r.message:"Failed to setup domain";throw i.error(o,{id:"domain-setup"}),r}},[]),xe=d.useCallback(async t=>{try{await new Promise(a=>setTimeout(a,500));const e={...t,id:Date.now().toString(),createdAt:"Just now",status:t.scheduledAt?"scheduled":"draft"};E(a=>[e,...a]),i.success("Announcement created successfully")}catch(e){throw i.error("Failed to create announcement"),e}},[]),Ae=d.useCallback(async(t,e)=>{try{await new Promise(a=>setTimeout(a,300)),E(a=>a.map(r=>r.id===t?{...r,...e}:r)),i.success("Announcement updated")}catch(a){throw i.error("Failed to update announcement"),a}},[]),_e=d.useCallback(async t=>{try{await new Promise(e=>setTimeout(e,300)),E(e=>e.filter(a=>a.id!==t)),i.success("Announcement deleted")}catch(e){throw i.error("Failed to delete announcement"),e}},[]),ve=d.useCallback(async t=>{try{await new Promise(e=>setTimeout(e,500)),E(e=>e.map(a=>a.id===t?{...a,status:"sent",sentAt:new Date().toISOString()}:a)),i.success("Announcement sent successfully")}catch(e){throw i.error("Failed to send announcement"),e}},[]),Pe=d.useCallback(async t=>{try{if(!(await fetch(`${m}/support`,{method:"POST",headers:{...S(),"Content-Type":"application/json"},body:JSON.stringify({type:t.category==="bug"?"issue":t.category==="feature_request"?"feature":"feedback",title:t.subject,description:t.description,priority:t.priority,tenantId:t.tenantId})})).ok)throw new Error("Failed to create ticket");const a=await fetch(`${m}/support`,{headers:S()});if(a.ok){const o=((await a.json()).data||[]).map(n=>({id:n.id||n._id,tenantId:n.tenantId,tenantName:n.submittedBy?.name||"Unknown Merchant",tenantSubdomain:n.tenantId,subject:n.title||B(n.type),description:n.description,category:M(n.type),priority:n.priority||"medium",status:J(n.status),assignedTo:n.assignedTo?.name,createdAt:k(n.createdAt),updatedAt:k(n.updatedAt),messages:(n.comments||[]).map(u=>({id:u.id||u._id,senderId:u.userId,senderName:u.userName||"Unknown",senderType:u.userId===n.submittedBy?.userId?"merchant":"support",message:u.message,createdAt:k(u.createdAt)})),tags:n.images?.length>0?["has-attachments"]:[]}));A(o)}i.success("Ticket created")}catch(e){throw i.error("Failed to create ticket"),e}},[m]),Ee=d.useCallback(async(t,e)=>{try{const a={};if(e.status&&(a.status=e.status==="open"?"pending":e.status==="in_progress"?"in-progress":e.status),e.priority&&(a.priority=e.priority),!(await fetch(`${m}/support/${t}`,{method:"PATCH",headers:{...S(),"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw new Error("Failed to update ticket");A(o=>o.map(n=>n.id===t?{...n,...e,updatedAt:"Just now"}:n)),i.success("Ticket updated")}catch(a){throw i.error("Failed to update ticket"),a}},[m]),Ne=d.useCallback(async(t,e)=>{try{const a=await fetch(`${m}/support/${t}/comments`,{method:"POST",headers:{...S(),"Content-Type":"application/json"},body:JSON.stringify({message:e.message})});if(!a.ok)throw new Error("Failed to send reply");const o={id:(await a.json()).data?.id||Date.now().toString(),senderId:e.senderId,senderName:e.senderName,senderType:"support",message:e.message,createdAt:"Just now"};A(n=>n.map(u=>u.id===t?{...u,messages:[...u.messages,o],updatedAt:"Just now",status:"waiting_response"}:u)),i.success("Reply sent")}catch(a){throw i.error("Failed to send reply"),a}},[m]),Ie=d.useCallback(async t=>{try{if(!(await fetch(`${m}/support/${t}`,{method:"PATCH",headers:{...S(),"Content-Type":"application/json"},body:JSON.stringify({status:"closed"})})).ok)throw new Error("Failed to close ticket");A(a=>a.map(r=>r.id===t?{...r,status:"closed",resolvedAt:new Date().toISOString()}:r)),i.success("Ticket closed")}catch(e){throw i.error("Failed to close ticket"),e}},[m]),Fe=d.useCallback(async(t,e)=>{try{await new Promise(a=>setTimeout(a,300)),oe(a=>a.map(r=>r.tenantId===t?{...r,alerts:r.alerts.map(o=>o.id===e?{...o,acknowledged:!0,acknowledgedAt:new Date().toISOString()}:o)}:r)),i.success("Alert acknowledged")}catch(a){throw i.error("Failed to acknowledge alert"),a}},[]),$e=d.useCallback(async(t,e)=>{try{await new Promise(a=>setTimeout(a,300)),i.success(`Opening ${e} for merchant...`)}catch(a){throw i.error("Failed to contact merchant"),a}},[]),Oe=d.useCallback(async(t,e)=>{try{await new Promise(a=>setTimeout(a,300)),F(a=>a.map(r=>r.tenantId===t?{...r,nextFollowUp:e}:r)),i.success("Follow-up scheduled")}catch(a){throw i.error("Failed to schedule follow-up"),a}},[]),De=d.useCallback(async(t,e)=>{try{await new Promise(a=>setTimeout(a,300)),F(a=>a.map(r=>r.tenantId===t?{...r,status:e}:r)),i.success("Merchant status updated")}catch(a){throw i.error("Failed to update status"),a}},[]),Re=d.useCallback(async(t,e)=>{try{await new Promise(a=>setTimeout(a,300)),F(a=>a.map(r=>r.tenantId===t?{...r,notes:e}:r)),i.success("Note saved")}catch(a){throw i.error("Failed to save note"),a}},[]),Le=()=>{switch(l){case"tenants":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(rt,{tenants:f,onCreateTenant:ue,onDeleteTenant:H,onRefreshTenants:pe,onUpdateTenantStatus:z,onLoginAsMerchant:je,onUpdateDomain:Ce,isCreating:q,deletingTenantId:G})});case"subscriptions":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(Ge,{onLoadPlans:async()=>await T.getPlans(),onCreatePlan:async t=>{await T.createPlan(t)},onUpdatePlan:async(t,e)=>{await T.updatePlan(t,e)},onDeletePlan:async t=>{await T.deletePlan(t)},onLoadTransactions:async()=>(await T.getTransactions()).data,onRefundTransaction:async(t,e)=>{await T.refundTransaction(t,e)},onLoadInvoices:async()=>(await T.getInvoices()).data,onLoadTrialSettings:async()=>await T.getTrialSettings(),onUpdateTrialSettings:async t=>{await T.updateTrialSettings(t)}})});case"settings":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(Ve,{platformConfig:Q,setPlatformConfig:K,isSavingSettings:X,onSave:he})});case"notifications":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(ze,{notifications:de,onSendNotification:me,onDeleteNotification:fe,tenants:f})});case"theme-config":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(We,{defaultTheme:Y,onSaveTheme:ye,onApplyToTenant:ge,onApplyToAll:we,tenants:f,onLoadTenantTheme:be})});case"chat-config":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(qe,{chatConfig:ee,onSaveChatConfig:Se,onApplyToTenant:Te,onApplyToAll:ke,tenants:f})});case"announcements":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(Qe,{announcements:ae,tenants:f,onCreateAnnouncement:xe,onUpdateAnnouncement:Ae,onDeleteAnnouncement:_e,onSendAnnouncement:ve})});case"support-tickets":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(Ke,{tickets:se,tenants:f,onCreateTicket:Pe,onUpdateTicket:Ee,onReplyTicket:Ne,onCloseTicket:Ie})});case"merchant-success":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(Xe,{merchantHealth:ne,atRiskMerchants:re,tenants:f,onAcknowledgeAlert:Fe,onContactMerchant:$e,onScheduleFollowUp:Oe,onUpdateMerchantStatus:De,onAddNote:Re})});case"analytics":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(Ye,{systemStats:N,tenants:f})});case"audit-logs":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(Ze,{})});case"system-health":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(et,{systemStats:N})});case"bulk-operations":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(tt,{tenants:f,onBulkStatusChange:async(t,e)=>{for(const a of t)await z(a,e)},onBulkDelete:async t=>{for(const e of t)await H(e)},onBulkEmail:async(t,e,a)=>{await new Promise(r=>setTimeout(r,1e3)),console.log("Bulk email sent:",{tenantIds:t,subject:e,message:a})}})});case"website-config":return s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 sm:p-6 lg:p-8",children:[s.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Website Configuration"}),s.jsx("p",{className:"text-slate-600 mb-6",children:"Configure global website settings for all tenants. This includes SEO, meta tags, and other website-wide settings."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 lg:gap-6",children:[s.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200",children:[s.jsx("h3",{className:"font-semibold text-slate-700 mb-2",children:"Theme Settings"}),s.jsx("p",{className:"text-sm text-slate-500 mb-3",children:"Configure default themes for tenant stores"}),s.jsx("button",{onClick:()=>h("theme-config"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600 transition-colors",children:"Go to Theme Config"})]}),s.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200",children:[s.jsx("h3",{className:"font-semibold text-slate-700 mb-2",children:"Chat Settings"}),s.jsx("p",{className:"text-sm text-slate-500 mb-3",children:"Configure chat widgets for tenant stores"}),s.jsx("button",{onClick:()=>h("chat-config"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600 transition-colors",children:"Go to Chat Config"})]}),s.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200",children:[s.jsx("h3",{className:"font-semibold text-slate-700 mb-2",children:"Notifications"}),s.jsx("p",{className:"text-sm text-slate-500 mb-3",children:"Send notifications to tenant admins"}),s.jsx("button",{onClick:()=>h("notifications"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600 transition-colors",children:"Go to Notifications"})]}),s.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200",children:[s.jsx("h3",{className:"font-semibold text-slate-700 mb-2",children:"Platform Settings"}),s.jsx("p",{className:"text-sm text-slate-500 mb-3",children:"Configure global platform settings"}),s.jsx("button",{onClick:()=>h("settings"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600 transition-colors",children:"Go to Settings"})]})]})]})});case"tutorials":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(at,{})});case"apk-builds":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(st,{tenants:f,onSendNotification:async(t,e)=>{try{if(!(await fetch("/api/notifications/broadcast",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,targetTenants:[t]})})).ok)throw new Error("Failed to send notification")}catch(a){throw a}}})});case"app-requests":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(nt,{})});case"ads-management":return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(ot,{})});default:return s.jsx(p.Suspense,{fallback:s.jsx(g,{}),children:s.jsx(He,{systemStats:N,topTenants:_,recentActivities:ce,onViewAllTenants:()=>h("tenants")})})}};return s.jsxs("div",{className:"min-h-screen bg-slate-50 flex",children:[x&&s.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-30",onClick:()=>c(!1)}),s.jsx(Be,{sidebarOpen:x,setSidebarOpen:c,activeTab:l,setActiveTab:h,totalTenants:N.totalTenants}),s.jsxs("main",{className:`flex-1 transition-all duration-300 ${x?"lg:ml-72":"lg:ml-20"} ml-0`,children:[s.jsx(Me,{sidebarOpen:x,setSidebarOpen:c,searchQuery:b,setSearchQuery:P,selectedPeriod:I,setSelectedPeriod:W}),Le()]})]})};export{Lt as default};
