import{j as e}from"./react-jsx-runtime-BBsywpoz.js";import{r as d}from"./react-core-KcGD0Z1V.js";import{A as F,aa as C,ah as o,ao as u,a9 as L,bn as O,a4 as U,S as B,R as Q,Y as $,aU as R,ae as H,bJ as V,b as X,_ as q,Q as z,an as J,h as Y,aO as G,aB as K,$ as W,bf as Z,ca as ee,cb as se}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";const N={healthy:{label:"Healthy",color:"bg-green-100 text-green-700 border-green-200",icon:o},at_risk:{label:"At Risk",color:"bg-amber-100 text-amber-700 border-amber-200",icon:u},critical:{label:"Critical",color:"bg-red-100 text-red-700 border-red-200",icon:L}},A={no_login:{label:"No Login",icon:V,color:"text-orange-600 bg-orange-50"},sales_drop:{label:"Sales Drop",icon:H,color:"text-red-600 bg-red-50"},no_orders:{label:"No Orders",icon:R,color:"text-amber-600 bg-amber-50"},subscription_expiring:{label:"Subscription Expiring",icon:$,color:"text-purple-600 bg-purple-50"},high_refund_rate:{label:"High Refunds",icon:Q,color:"text-red-600 bg-red-50"},low_inventory:{label:"Low Inventory",icon:u,color:"text-yellow-600 bg-yellow-50"}},ie=({merchantHealth:n,atRiskMerchants:te,onAcknowledgeAlert:v,onContactMerchant:m,onScheduleFollowUp:M,onUpdateMerchantStatus:le,onAddNote:I})=>{const[i,h]=d.useState("overview"),[p,T]=d.useState(""),[g,P]=d.useState("all"),[t,_]=d.useState(null),[c,f]=d.useState(""),[x,w]=d.useState(""),a={total:n.length,healthy:n.filter(s=>s.riskLevel==="healthy").length,atRisk:n.filter(s=>s.riskLevel==="at_risk").length,critical:n.filter(s=>s.riskLevel==="critical").length,avgHealthScore:Math.round(n.reduce((s,l)=>s+l.healthScore,0)/n.length)||0,totalAlerts:n.reduce((s,l)=>s+l.alerts.filter(r=>!r.acknowledged).length,0)},y=n.filter(s=>{const l=s.tenantName.toLowerCase().includes(p.toLowerCase())||s.tenantSubdomain.toLowerCase().includes(p.toLowerCase()),r=g==="all"||s.riskLevel===g;return l&&r}),b=n.flatMap(s=>s.alerts.filter(l=>!l.acknowledged).map(l=>({...l,merchant:s}))).sort((s,l)=>s.severity==="critical"?-1:1),j=s=>s>=80?"text-green-600":s>=50?"text-amber-600":"text-red-600",S=s=>s>=80?"bg-green-500":s>=50?"bg-amber-500":"bg-red-500",D=s=>{switch(s){case"growing":return e.jsx(se,{className:"w-4 h-4 text-green-500"});case"declining":return e.jsx(ee,{className:"w-4 h-4 text-red-500"});case"inactive":return e.jsx(Z,{className:"w-4 h-4 text-slate-400"});default:return e.jsx(W,{className:"w-4 h-4 text-slate-400"})}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(F,{className:"w-7 h-7 text-emerald-500"}),"Merchant Success"]}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Monitor merchant health and identify at-risk accounts"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>h("overview"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${i==="overview"?"bg-emerald-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Overview"}),e.jsxs("button",{onClick:()=>h("at-risk"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${i==="at-risk"?"bg-emerald-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:["At Risk",a.atRisk+a.critical>0&&e.jsx("span",{className:"px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full",children:a.atRisk+a.critical})]}),e.jsxs("button",{onClick:()=>h("alerts"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${i==="alerts"?"bg-emerald-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:["Alerts",a.totalAlerts>0&&e.jsx("span",{className:"px-1.5 py-0.5 bg-amber-500 text-white text-xs rounded-full",children:a.totalAlerts})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"bg-white rounded-xl p-4 border border-slate-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-lg",children:e.jsx(C,{className:"w-5 h-5 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Total"}),e.jsx("p",{className:"text-xl font-bold text-slate-800",children:a.total})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 border border-green-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(o,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600",children:"Healthy"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:a.healthy})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 border border-amber-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:e.jsx(u,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-600",children:"At Risk"}),e.jsx("p",{className:"text-xl font-bold text-amber-600",children:a.atRisk})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 border border-red-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(L,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-600",children:"Critical"}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:a.critical})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 border border-slate-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(O,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Avg Score"}),e.jsx("p",{className:`text-xl font-bold ${j(a.avgHealthScore)}`,children:a.avgHealthScore})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 border border-slate-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:e.jsx(U,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Open Alerts"}),e.jsx("p",{className:"text-xl font-bold text-amber-600",children:a.totalAlerts})]})]})})]}),e.jsxs("div",{className:"flex gap-3 sm:gap-4 lg:gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(B,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search merchants...",value:p,onChange:s=>T(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500"})]}),e.jsxs("select",{value:g,onChange:s=>P(s.target.value),className:"px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20",children:[e.jsx("option",{value:"all",children:"All Risk Levels"}),e.jsx("option",{value:"healthy",children:"Healthy"}),e.jsx("option",{value:"at_risk",children:"At Risk"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),i==="alerts"?e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-slate-200",children:e.jsxs("h3",{className:"font-semibold text-slate-800",children:["Active Alerts (",b.length,")"]})}),b.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(o,{className:"w-12 h-12 text-green-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-2",children:"All Clear!"}),e.jsx("p",{className:"text-slate-500",children:"No active alerts at the moment"})]}):e.jsx("div",{className:"divide-y divide-slate-100 max-h-[600px] overflow-y-auto",children:b.map((s,l)=>{const r=A[s.type];return e.jsx("div",{className:"p-4 hover:bg-slate-50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${r.color}`,children:e.jsx(r.icon,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${s.severity==="critical"?"bg-red-100 text-red-600":"bg-amber-100 text-amber-600"}`,children:s.severity}),e.jsx("span",{className:"text-xs text-slate-500",children:s.triggeredAt})]}),e.jsx("p",{className:"font-medium text-slate-800",children:s.message}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[s.merchant.tenantName," (",s.merchant.tenantSubdomain,")"]})]}),e.jsx("button",{onClick:()=>v(s.merchant.tenantId,s.id),className:"px-3 py-1.5 text-sm bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 transition-colors",children:"Acknowledge"})]})},`${s.merchant.tenantId}-${s.id}-${l}`)})})]}):e.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:y.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(C,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-2",children:"No merchants found"}),e.jsx("p",{className:"text-slate-500",children:"No merchants match your search criteria"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase",children:"Merchant"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-500 uppercase",children:"Health"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-500 uppercase",children:"Last Login"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-500 uppercase",children:"Sales Trend"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-500 uppercase",children:"Alerts"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:y.map(s=>{const l=N[s.riskLevel],r=l.icon,k=s.alerts.filter(E=>!E.acknowledged).length;return e.jsxs("tr",{className:`hover:bg-slate-50 cursor-pointer ${t?.tenantId===s.tenantId?"bg-emerald-50":""}`,onClick:()=>_(s),children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:s.tenantName}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s.tenantSubdomain," • ",s.plan]})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx("div",{className:"w-16 h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${S(s.healthScore)}`,style:{width:`${s.healthScore}%`}})}),e.jsx("span",{className:`text-sm font-semibold ${j(s.healthScore)}`,children:s.healthScore})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs rounded-full border ${l.color}`,children:[e.jsx(r,{className:"w-3 h-3"}),l.label]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("div",{className:"text-sm",children:e.jsx("p",{className:`${s.daysSinceLastLogin>7?"text-red-600 font-medium":"text-slate-600"}`,children:s.daysSinceLastLogin===0?"Today":`${s.daysSinceLastLogin}d ago`})})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[D(s.salesTrend),e.jsxs("span",{className:`text-sm ${s.salesChangePercent>0?"text-green-600":s.salesChangePercent<0?"text-red-600":"text-slate-500"}`,children:[s.salesChangePercent>0?"+":"",s.salesChangePercent,"%"]})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:k>0?e.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-red-100 text-red-600 text-xs font-medium rounded-full",children:k}):e.jsx("span",{className:"text-green-500",children:e.jsx(o,{className:"w-5 h-5 mx-auto"})})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{className:"p-1 hover:bg-slate-100 rounded text-slate-400 hover:text-slate-600",children:e.jsx(X,{className:"w-5 h-5"})})})]},s.tenantId)})})]})})})]}),t&&i!=="alerts"&&e.jsxs("div",{className:"w-[380px] bg-white rounded-xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800",children:t.tenantName}),e.jsx("p",{className:"text-sm text-slate-500",children:t.tenantSubdomain})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full border ${N[t.riskLevel].color}`,children:N[t.riskLevel].label})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Health Score"}),e.jsxs("span",{className:`text-2xl font-bold ${j(t.healthScore)}`,children:[t.healthScore,"/100"]})]}),e.jsx("div",{className:"w-full h-3 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${S(t.healthScore)} transition-all`,style:{width:`${t.healthScore}%`}})})]})]}),e.jsxs("div",{className:"p-4 border-b border-slate-200 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-xs mb-1",children:[e.jsx(q,{className:"w-3 h-3"}),"This Month"]}),e.jsxs("p",{className:"font-bold text-slate-800",children:["৳",t.currentMonthRevenue.toLocaleString()]}),e.jsxs("p",{className:`text-xs ${t.salesChangePercent>=0?"text-green-600":"text-red-600"}`,children:[t.salesChangePercent>=0?"+":"",t.salesChangePercent,"% vs last month"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-xs mb-1",children:[e.jsx(R,{className:"w-3 h-3"}),"Orders (30d)"]}),e.jsx("p",{className:"font-bold text-slate-800",children:t.totalOrders30Days}),e.jsxs("p",{className:"text-xs text-slate-500",children:["vs ",t.totalOrdersPrevious30Days," prev"]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-xs mb-1",children:[e.jsx($,{className:"w-3 h-3"}),"Last Login"]}),e.jsx("p",{className:`font-bold ${t.daysSinceLastLogin>7?"text-red-600":"text-slate-800"}`,children:t.daysSinceLastLogin===0?"Today":`${t.daysSinceLastLogin} days ago`})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-xs mb-1",children:[e.jsx(z,{className:"w-3 h-3"}),"Products"]}),e.jsx("p",{className:"font-bold text-slate-800",children:t.activeProducts}),e.jsx("p",{className:"text-xs text-slate-500",children:"active"})]})]}),t.alerts.filter(s=>!s.acknowledged).length>0&&e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Active Alerts"}),e.jsx("div",{className:"space-y-2",children:t.alerts.filter(s=>!s.acknowledged).map(s=>{const l=A[s.type];return e.jsxs("div",{className:`flex items-start gap-2 p-2 rounded-lg ${l.color}`,children:[e.jsx(l.icon,{className:"w-4 h-4 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium",children:s.message}),e.jsx("p",{className:"text-xs opacity-75",children:s.triggeredAt})]}),e.jsx("button",{onClick:r=>{r.stopPropagation(),v(t.tenantId,s.id)},className:"text-xs underline hover:no-underline",children:"Ack"})]},s.id)})})]}),e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>m(t.tenantId,"email"),className:"flex items-center gap-1 px-3 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 text-sm",children:[e.jsx(J,{className:"w-4 h-4"}),"Email"]}),e.jsxs("button",{onClick:()=>m(t.tenantId,"phone"),className:"flex items-center gap-1 px-3 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 text-sm",children:[e.jsx(Y,{className:"w-4 h-4"}),"Call"]}),e.jsxs("button",{onClick:()=>m(t.tenantId,"message"),className:"flex items-center gap-1 px-3 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 text-sm",children:[e.jsx(G,{className:"w-4 h-4"}),"Message"]})]})]}),e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Schedule Follow-up"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"date",value:c,onChange:s=>f(s.target.value),className:"flex-1 px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20"}),e.jsx("button",{onClick:()=>{c&&(M(t.tenantId,c),f(""))},disabled:!c,className:"px-3 py-2 bg-gradient-to-r from-[#38BDF8] to-[#1E90FF] text-white rounded-lg hover:from-[#2BAEE8] hover:to-[#1A7FE8] disabled:opacity-50 text-sm",children:e.jsx(K,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Add Note"}),e.jsx("textarea",{value:x,onChange:s=>w(s.target.value),placeholder:"Add internal notes about this merchant...",rows:3,className:"w-full px-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/20 resize-none"}),e.jsx("button",{onClick:()=>{x.trim()&&(I(t.tenantId,x),w(""))},disabled:!x.trim(),className:"mt-2 w-full px-3 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 disabled:opacity-50 text-sm",children:"Save Note"})]})]})]})]})};export{ie as default};
