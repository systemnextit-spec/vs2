const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/cmp-pagebuilder-Q00bwv5t.js","assets/react-jsx-runtime-BBsywpoz.js","assets/react-core-KcGD0Z1V.js","assets/pkg-eventemitter3-CXfM2dhT.js","assets/pkg-@dnd-kit-core-4YIDk7Uu.js","assets/react-dom-B3Ccfrsk.js","assets/scheduler-CWG1rEj-.js","assets/pkg-@dnd-kit-utilities--PP7VXwB.js","assets/pkg-@dnd-kit-accessibility-SF-Pdgkw.js","assets/pkg-@dnd-kit-sortable-CjzoCWK2.js","assets/pkg-toast-Dpd4iwUK.js","assets/pkg-goober-N6sOClW1.js","assets/cmp-admincustomization-BgTFiuh2.js","assets/cmp-gallerypicker-tsx-T-_pXSB3.js","assets/cmp-dashboard-CwyHj6aR.js","assets/pkg-socket-D1bUdbwx.js","assets/pkg-engine-io-BZqIjJKj.js","assets/pkg-@socket.io-component-emitter-Dkula2eQ.js","assets/pkg-socket.io-parser-CafqElEs.js","assets/cmp-approutes-tsx-DORRjFJg.js","assets/cmp-skeletonloaders-tsx-Durrj7lG.js","assets/cmp-addnewduemodal-tsx-OjU2U-0e.js","assets/icons-chunk-AVFeydwE.js","assets/cmp-modern-dashboard-C6grFkCj.js","assets/cmp-invoiceprinttemplate-tsx-CUwUe6zE.js","assets/pkg-papaparse-BEpmA8em.js","assets/pkg-xlsx-BljOZNTS.js","assets/page-adminnote-C1Ob2d7z.js","assets/cmp-duehistorymodal-tsx-KQ79TbYj.js","assets/pkg-uuid-EwEgHOG0.js"])))=>i.map(i=>d[i]);
import{_ as $}from"./cmp-approutes-tsx-DORRjFJg.js";import{j as e}from"./react-jsx-runtime-BBsywpoz.js";import{r as d}from"./react-core-KcGD0Z1V.js";import f from"./pkg-toast-Dpd4iwUK.js";import{u as I,a as R,D as T,c as B,P as M}from"./pkg-@dnd-kit-core-4YIDk7Uu.js";import{S as U,v as z,a as Y,u as G}from"./pkg-@dnd-kit-sortable-CjzoCWK2.js";import{C as J}from"./pkg-@dnd-kit-utilities--PP7VXwB.js";import{a9 as P,L as N,f as D,S as _,X as K,b3 as V,aW as Q,b4 as H,E as k,b5 as W,a8 as X,b6 as E,G as q,ah as Z,x as ee,b7 as se}from"./icons-chunk-AVFeydwE.js";const te={cache:"no-store"},re=({product:a,index:i})=>{const{attributes:c,listeners:n,setNodeRef:x,transform:g,transition:b,isDragging:p}=G({id:a.id}),h={transform:J.Transform.toString(g),transition:b,opacity:p?.5:1};return e.jsxs("div",{ref:x,style:h,className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:[e.jsx("button",{...c,...n,className:"p-1 sm:p-2 text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing flex-shrink-0",children:e.jsx(V,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsx("div",{className:"flex-shrink-0 w-10 h-10 sm:w-12 sm:h-12 bg-gray-100 rounded-lg overflow-hidden",children:e.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover",onError:m=>{m.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100"%3E%3Crect fill="%23ddd" width="100" height="100"/%3E%3C/svg%3E'}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-500 bg-gray-100 px-1.5 sm:px-2 py-0.5 rounded flex-shrink-0",children:["#",i+1]}),e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:a.name})]}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 mt-0.5 truncate",children:["$",a.price.toFixed(2),e.jsxs("span",{className:"hidden sm:inline",children:[" Â· ID: ",a.id]})]})]}),e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:a.status==="Active"?e.jsx("span",{className:"text-xs px-1.5 sm:px-2 py-1 bg-green-100 text-green-700 rounded whitespace-nowrap",children:"Active"}):e.jsx("span",{className:"text-xs px-1.5 sm:px-2 py-1 bg-gray-100 text-gray-600 rounded whitespace-nowrap",children:"Inactive"})})]})},ae=({tenantId:a,products:i,currentOrder:c=[],onSave:n})=>{const[x,g]=d.useState([]),[b,p]=d.useState(!1),[h,m]=d.useState(!1),[u,y]=d.useState(""),v=I(R(M,{activationConstraint:{distance:8}}));d.useEffect(()=>{if(i.length===0){g([]);return}if(c&&c.length>0){const s=c.map(o=>i.find(j=>j.id===o)).filter(o=>o!==void 0),r=i.filter(o=>!c.includes(o.id));g([...s,...r])}else g([...i])},[i,c]);const w=s=>{const{active:r,over:o}=s;!o||r.id===o.id||g(j=>{const L=j.findIndex(C=>C.id===r.id),F=j.findIndex(C=>C.id===o.id),O=Y(j,L,F);return m(!0),O})},S=async()=>{p(!0);try{const s=x.map(r=>r.id);await n(s),m(!1),f.success("Product order saved successfully!")}catch(s){console.error("Failed to save product order:",s),f.error("Failed to save product order")}finally{p(!1)}},l=()=>{if(c&&c.length>0){const s=c.map(o=>i.find(j=>j.id===o)).filter(o=>o!==void 0),r=i.filter(o=>!c.includes(o.id));g([...s,...r])}else g([...i]);m(!1)},t=u?x.filter(s=>s.name.toLowerCase().includes(u.toLowerCase())||s.id.toString().includes(u)):x;return i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Products"}),e.jsx("p",{className:"text-gray-600",children:"Add products to your store to manage their display order."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Manage Product Order"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Drag and drop products to change their display order in your store"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[h&&e.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Reset"}),e.jsx("button",{onClick:S,disabled:!h||b,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors whitespace-nowrap",children:b?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{children:"Save Order"})]})})]})]}),h&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx(P,{className:"w-5 h-5 text-yellow-600 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-yellow-900",children:'You have unsaved changes. Click "Save Order" to apply the new product order.'})]}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:u,onChange:s=>y(s.target.value),placeholder:"Search products by name or ID...",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),u&&e.jsx("button",{onClick:()=>y(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(K,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Products"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900 mt-1",children:x.length})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Active Products"}),e.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:x.filter(s=>s.status==="Active").length})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-purple-600 font-medium",children:u?"Filtered":"Showing"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900 mt-1",children:t.length})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(_,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No products match your search"})]}):e.jsx(T,{sensors:v,collisionDetection:B,onDragEnd:w,children:e.jsx(U,{items:t.map(s=>s.id),strategy:z,children:e.jsx("div",{className:"space-y-2",children:t.map((s,r)=>e.jsx(re,{product:s,index:r},s.id))})})})}),e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Tip:"})," The first product in this list will appear first in your store. Drag the products to rearrange them in the order you want them displayed."]})})]})},oe=d.lazy(()=>$(()=>import("./cmp-pagebuilder-Q00bwv5t.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29])).then(a=>({default:a.PageBuilder}))),A=({tenantId:a,onBack:i,products:c=[]})=>{const[n,x]=d.useState({tenantId:a,enabled:!1,productDisplayOrder:[],updatedAt:new Date().toISOString()}),[g,b]=d.useState(!0),[p,h]=d.useState(!1),[m,u]=d.useState("settings"),y=d.useRef(null);d.useEffect(()=>{(async()=>{if(a){b(!0);try{const s=await fetch(`https://allinbangla.com/api/tenant-data/${a}/store_studio_config`,te);if(s.ok){const r=await s.json();x(r.data||{tenantId:a,enabled:!1,productDisplayOrder:[],updatedAt:new Date().toISOString()})}else{const r=await s.json().catch(()=>({})),o=r.message||r.error||"Failed to load store studio configuration";console.error("Failed to fetch store studio config:",o),f.error(o)}}catch(t){console.error("Failed to fetch store studio config:",t),f.error("Failed to load store studio configuration")}finally{b(!1)}}})()},[a]);const v=async()=>{h(!0);try{const t=await fetch(`https://allinbangla.com/api/tenant-data/${a}/store_studio_config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(t.ok)f.success("Store studio configuration saved successfully!");else{const s=await t.json().catch(()=>({})),r=s.message||s.error||"Failed to save configuration";throw new Error(r)}}catch(l){console.error("Failed to save store studio config:",l);const t=l instanceof Error?l.message:"Failed to save configuration";f.error(t)}finally{h(!1)}};d.useEffect(()=>{const l=t=>{(t.ctrlKey||t.metaKey)&&t.key==="s"&&(t.preventDefault(),v())};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)});const w=async()=>{y.current=n;const l={...n,enabled:!n.enabled,updatedAt:new Date().toISOString()};x(l),h(!0);try{const s=await fetch(`https://allinbangla.com/api/tenant-data/${a}/store_studio_config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(s.ok)f.success(`Store Studio ${l.enabled?"enabled":"disabled"}!`),y.current=null;else{const r=await s.json().catch(()=>({})),o=r.message||r.error||"Failed to save configuration";throw new Error(o)}}catch(t){console.error("Failed to toggle store studio:",t);const s=t instanceof Error?t.message:"Failed to update configuration";f.error(s),y.current&&x(y.current)}finally{h(!1)}},S=async l=>{try{if(!(await fetch(`https://allinbangla.com/api/tenant-data/${a}/product_display_order`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({productDisplayOrder:l})})).ok)throw new Error("Failed to save product order");x(r=>({...r,productDisplayOrder:l,updatedAt:new Date().toISOString()}))}catch(t){throw console.error("Failed to save product order:",t),t}};return g?e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(N,{className:"w-12 h-12 animate-spin text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading Store Studio..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 py-4 md:h-16 md:py-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[i&&e.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors flex-shrink-0",title:"Back to Dashboard",children:e.jsx(Q,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg flex-shrink-0",children:e.jsx(H,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-900 truncate",children:"Store Studio"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 hidden sm:block",children:"Design your store without code"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center justify-center sm:justify-start gap-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:n.enabled?"Enabled":"Disabled"}),e.jsx("button",{onClick:w,disabled:p,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${n.enabled?"bg-green-500":"bg-gray-300"} ${p?"opacity-50 cursor-not-allowed":""}`,title:`Click to ${n.enabled?"disable":"enable"} Store Studio`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n.enabled?"translate-x-6":"translate-x-1"}`})}),n.enabled?e.jsx(k,{className:"w-5 h-5 text-green-500"}):e.jsx(W,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("button",{onClick:v,disabled:p,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-sm sm:text-base",children:p?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{children:"Save Changes"})]})})]})]}),e.jsxs("div",{className:"flex gap-1 border-t border-gray-200 -mb-px overflow-x-auto scrollbar-hide",children:[e.jsx("button",{onClick:()=>u("settings"),className:`flex-shrink-0 px-3 sm:px-4 py-3 text-sm font-medium border-b-2 transition-colors ${m==="settings"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsx("span",{children:"Settings"})]})}),e.jsx("button",{onClick:()=>u("layout"),className:`flex-shrink-0 px-3 sm:px-4 py-3 text-sm font-medium border-b-2 transition-colors ${m==="layout"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{className:"whitespace-nowrap",children:"Layout Builder"})]})}),e.jsx("button",{onClick:()=>u("products"),className:`flex-shrink-0 px-3 sm:px-4 py-3 text-sm font-medium border-b-2 transition-colors ${m==="products"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{className:"whitespace-nowrap",children:"Product Order"})]})})]})]})}),e.jsxs("div",{className:m==="layout"?"":"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[m==="settings"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Store Studio Settings"}),e.jsx("div",{className:`p-4 rounded-lg mb-6 ${n.enabled?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[n.enabled?e.jsx(Z,{className:"w-5 h-5 text-green-600 mt-0.5"}):e.jsx(P,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:n.enabled?"Store Studio is Active":"Store Studio is Inactive"}),e.jsx("p",{className:"text-sm text-gray-600",children:n.enabled?"Your custom store design is being displayed to customers. You can edit layouts, colors, and product order in the other tabs.":"Store is using the default design. Enable Store Studio above to start customizing your store layout and appearance."})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ee,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Visual Customization"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Change colors, fonts, spacing, and styling of every element in your store without writing any code."})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(E,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Layout Builder"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Drag and drop sections to create your perfect store layout. Add hero banners, product grids, and more."})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{className:"w-5 h-5 text-green-600"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Product Ordering"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Rearrange products to control which items appear first, second, and so on in your store."})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(k,{className:"w-5 h-5 text-orange-600"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Live Preview"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"See changes in real-time with image and video previews before publishing to customers."})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-900",children:[e.jsx("strong",{children:"Note:"})," Product checkout flow remains unchanged regardless of Store Studio settings. Your customers will have the same smooth checkout experience."]})})]}),m==="layout"&&e.jsx("div",{className:"h-[calc(100vh-120px)]",children:e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(N,{className:"w-12 h-12 animate-spin text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading Layout Builder..."})]})}),children:e.jsx(oe,{tenantId:a})})}),m==="products"&&e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:e.jsx(ae,{tenantId:a,products:c,currentOrder:n.productDisplayOrder,onSave:S})})]})]})},he=Object.freeze(Object.defineProperty({__proto__:null,StoreStudioManager:A,default:A},Symbol.toStringTag,{value:"Module"}));export{he as i,te as n};
