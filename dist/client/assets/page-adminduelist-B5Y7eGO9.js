import{j as e}from"./react-jsx-runtime-BBsywpoz.js";import{r as s}from"./react-core-KcGD0Z1V.js";import{A as L,d as x}from"./cmp-addnewduemodal-tsx-OjU2U-0e.js";import{D as M}from"./cmp-duehistorymodal-tsx-KQ79TbYj.js";import{P as O,S as k,R as S,aI as A}from"./icons-chunk-AVFeydwE.js";import"./pkg-eventemitter3-CXfM2dhT.js";const P=({user:F,onLogout:I})=>{const[o,C]=s.useState("Customer"),[m,i]=s.useState(!1),[g,u]=s.useState(!1),[c,E]=s.useState([]),[p,d]=s.useState([]),[l,f]=s.useState(""),[a,h]=s.useState({from:new Date(new Date().setFullYear(new Date().getFullYear()-1)).toISOString().split("T")[0],to:new Date().toISOString().split("T")[0]}),[r,y]=s.useState(null),[G,j]=s.useState(!1),[Y,N]=s.useState(!1),D=c.reduce((t,n)=>t+(n.totalOwedToMe||0),0),T=c.reduce((t,n)=>t+(n.totalIOweThemNumber||0),0),b=async()=>{j(!0);try{const t=await x.getEntities(o,l);E(t)}catch(t){console.error("Error fetching entities:",t)}finally{j(!1)}},v=async()=>{if(!r){d([]);return}N(!0);try{const t=await x.getTransactions(r._id,a.from,a.to);d(t)}catch(t){console.error("Error fetching transactions:",t)}finally{N(!1)}};s.useEffect(()=>{b(),y(null),d([])},[o,l]),s.useEffect(()=>{v()},[r,a]);const w=c.filter(t=>t.name.toLowerCase().includes(l.toLowerCase())||t.phone.includes(l));return e.jsxs("div",{className:"min-h-screen bg-[#F8FAFC] overflow-x-hidden",children:[e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-3 md:px-4 py-3 sm:py-4 md:py-6",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-0 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-gray-900",children:"Due List"}),e.jsxs("div",{className:"flex flex-col xs:flex-row items-stretch xs:items-center gap-2 sm:gap-3 md:gap-4",children:[e.jsxs("div",{className:"text-center xs:text-left flex-1 xs:flex-initial",children:[e.jsx("p",{className:"text-xs sm:text-sm md:text-sm text-gray-600",children:"You Will Get"}),e.jsxs("p",{className:"text-lg sm:text-xl md:text-2xl font-bold text-red-600",children:["৳",D.toLocaleString()]})]}),e.jsxs("div",{className:"text-center xs:text-left flex-1 xs:flex-initial",children:[e.jsx("p",{className:"text-xs sm:text-sm md:text-sm text-gray-600",children:"You Will Give"}),e.jsxs("p",{className:"text-lg sm:text-xl md:text-2xl font-bold text-green-600",children:["৳",T.toLocaleString()]})]}),e.jsx("button",{onClick:()=>u(!0),className:"px-3 sm:px-4 py-1.5 sm:py-2 bg-gray-900 text-white rounded-lg font-medium hover:bg-gray-800 transition text-xs sm:text-sm",children:"Due History"}),e.jsxs("button",{onClick:()=>i(!0),className:"px-3 sm:px-4 py-1.5 sm:py-2 btn-theme-primary rounded-lg font-medium transition flex items-center justify-center gap-1.5 sm:gap-2 text-xs sm:text-sm",children:[e.jsx(O,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})," ",e.jsx("span",{className:"hidden xs:inline",children:"New Due"}),e.jsx("span",{className:"xs:hidden",children:"Add"})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-3 md:px-4 py-3 sm:py-4 md:py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 sm:gap-4 md:gap-6",children:[e.jsxs("div",{className:"w-full lg:w-72 xl:w-80 flex flex-col gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex gap-1.5 sm:gap-2 border-b border-gray-200 overflow-x-auto scrollbar-hide",children:["Customer","Supplier","Employee"].map(t=>e.jsx("button",{onClick:()=>C(t),className:`px-2 sm:px-3 md:px-4 py-1.5 sm:py-2 font-medium transition text-xs sm:text-sm whitespace-nowrap ${o===t?"text-gray-900 border-b-2 border-gray-900":"text-gray-600 hover:text-gray-900"}`,children:t},t))}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-2 sm:left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search...",value:l,onChange:t=>f(t.target.value),className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500"}),e.jsx("button",{onClick:()=>f(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(S,{size:18})})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden flex-1 flex flex-col bg-white",children:w.length===0?e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 text-sm",children:"You have no transactions"}):e.jsx("div",{className:"overflow-y-auto",children:w.map(t=>e.jsxs("button",{onClick:()=>y(t),className:`w-full p-4 border-b border-gray-100 text-left transition ${r?._id===t._id?"bg-theme-primary/10 border-l-4 border-theme-primary":"hover:bg-gray-50"}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.name}),e.jsx("div",{className:"text-sm text-gray-600",children:t.phone}),e.jsxs("div",{className:"flex gap-4 mt-2 text-sm",children:[e.jsxs("span",{className:"text-red-600",children:["Get: ৳",t.totalOwedToMe]}),e.jsxs("span",{className:"text-green-600",children:["Give: ৳",t.totalIOweThemNumber]})]})]},t._id))})})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 bg-white p-4 rounded-lg border border-gray-200",children:[e.jsx(A,{size:18,className:"text-gray-600"}),e.jsx("input",{type:"date",value:a.from,onChange:t=>h({...a,from:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500"}),e.jsx("span",{className:"text-gray-600",children:"-"}),e.jsx("input",{type:"date",value:a.to,onChange:t=>h({...a,to:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500"}),e.jsx("button",{className:"ml-auto p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx(S,{size:18,className:"text-gray-600"})})]}),e.jsx("div",{className:"flex-1 bg-white rounded-lg border border-gray-200 p-3 sm:p-4 lg:p-6",children:r?p.length===0?e.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:"You have no transactions"}):e.jsx("div",{className:"space-y-4",children:p.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.notes||"Transaction"}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(t.transactionDate).toLocaleDateString()})]}),e.jsxs("div",{className:`text-lg font-bold ${t.direction==="INCOME"?"text-red-600":"text-green-600"}`,children:[t.direction==="INCOME"?"+":"-","৳",t.amount.toLocaleString()]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ml-4 ${t.status==="Paid"?"bg-green-100 text-green-700":t.status==="Cancelled"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:t.status})]},t._id))}):e.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:"Select an entity to view transactions"})})]})]})}),m&&e.jsx(L,{isOpen:m,onClose:()=>i(!1),onSave:async t=>{try{await x.createTransaction(t),i(!1),b(),r?.name===t.entityName&&v()}catch(n){console.error("Error saving transaction:",n),alert("Failed to save transaction")}}}),g&&e.jsx(M,{isOpen:g,onClose:()=>u(!1)})]})};export{P as default};
