import{r as g,R as q}from"./react-core-KcGD0Z1V.js";import{b as ce,d as ue,e as le,g as de}from"./pkg-@dnd-kit-core-4YIDk7Uu.js";import{a as fe,d as B,v as ge,C as F,l as pe}from"./pkg-@dnd-kit-utilities--PP7VXwB.js";function H(e,n,t){const r=e.slice();return r.splice(t<0?r.length+t:t,0,r.splice(n,1)[0]),r}function ve(e,n){return e.reduce((t,r,s)=>{const a=n.get(r);return a&&(t[s]=a),t},Array(e.length))}function E(e){return e!==null&&e>=0}function me(e,n){if(e===n)return!0;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}function be(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const V=e=>{let{rects:n,activeIndex:t,overIndex:r,index:s}=e;const a=H(n,r,t),o=n[s],i=a[s];return!i||!o?null:{x:i.left-o.left,y:i.top-o.top,scaleX:i.width/o.width,scaleY:i.height/o.height}},N={scaleX:1,scaleY:1},Ne=e=>{var n;let{activeIndex:t,activeNodeRect:r,index:s,rects:a,overIndex:o}=e;const i=(n=a[t])!=null?n:r;if(!i)return null;if(s===t){const u=a[o];return u?{x:0,y:t<o?u.top+u.height-(i.top+i.height):u.top-i.top,...N}:null}const d=Ie(a,s,t);return s>t&&s<=o?{x:0,y:-i.height-d,...N}:s<t&&s>=o?{x:0,y:i.height+d,...N}:{x:0,y:0,...N}};function Ie(e,n,t){const r=e[n],s=e[n-1],a=e[n+1];return r?t<n?s?r.top-(s.top+s.height):a?a.top-(r.top+r.height):0:a?a.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const j="Sortable",k=q.createContext({activeIndex:-1,containerId:j,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:V,disabled:{draggable:!1,droppable:!1}});function Ae(e){let{children:n,id:t,items:r,strategy:s=V,disabled:a=!1}=e;const{active:o,dragOverlay:i,droppableRects:d,over:u,measureDroppableContainers:c}=ce(),v=fe(j,t),b=i.rect!==null,f=g.useMemo(()=>r.map(I=>typeof I=="object"&&"id"in I?I.id:I),[r]),T=o!=null,y=o?f.indexOf(o.id):-1,m=u?f.indexOf(u.id):-1,O=g.useRef(f),R=!me(f,O.current),D=m!==-1&&y===-1||R,p=be(a);B(()=>{R&&T&&c(f)},[R,f,T,c]),g.useEffect(()=>{O.current=f},[f]);const S=g.useMemo(()=>({activeIndex:y,containerId:v,disabled:p,disableTransforms:D,items:f,overIndex:m,useDragOverlay:b,sortedRects:ve(f,d),strategy:s}),[y,v,p.draggable,p.droppable,D,f,m,d,b,s]);return q.createElement(k.Provider,{value:S},n)}const xe=e=>{let{id:n,items:t,activeIndex:r,overIndex:s}=e;return H(t,r,s).indexOf(n)},he=e=>{let{containerId:n,isSorting:t,wasDragging:r,index:s,items:a,newIndex:o,previousItems:i,previousContainerId:d,transition:u}=e;return!u||!r||i!==a&&s===o?!1:t?!0:o!==s&&n===d},ye={duration:200,easing:"ease"},K="transform",Re=F.Transition.toString({property:K,duration:0,easing:"linear"}),De={roleDescription:"sortable"};function Se(e){let{disabled:n,index:t,node:r,rect:s}=e;const[a,o]=g.useState(null),i=g.useRef(t);return B(()=>{if(!n&&t!==i.current&&r.current){const d=s.current;if(d){const u=de(r.current,{ignoreTransform:!0}),c={x:d.left-u.left,y:d.top-u.top,scaleX:d.width/u.width,scaleY:d.height/u.height};(c.x||c.y)&&o(c)}}t!==i.current&&(i.current=t)},[n,t,r,s]),g.useEffect(()=>{a&&o(null)},[a]),a}function Le(e){let{animateLayoutChanges:n=he,attributes:t,disabled:r,data:s,getNewIndex:a=xe,id:o,strategy:i,resizeObserverConfig:d,transition:u=ye}=e;const{items:c,containerId:v,activeIndex:b,disabled:f,disableTransforms:T,sortedRects:y,overIndex:m,useDragOverlay:O,strategy:R}=g.useContext(k),D=Ce(r,f),p=c.indexOf(o),S=g.useMemo(()=>({sortable:{containerId:v,index:p,items:c},...s}),[v,s,p,c]),I=g.useMemo(()=>c.slice(c.indexOf(o)),[c,o]),{rect:M,node:$,isOver:U,setNodeRef:z}=ue({id:o,data:S,disabled:D.droppable,resizeObserverConfig:{updateMeasurementsFor:I,...d}}),{active:C,activatorEvent:J,activeNodeRect:Q,attributes:W,setNodeRef:P,listeners:Z,isDragging:A,over:ee,setActivatorNodeRef:te,transform:re}=le({id:o,data:S,attributes:{...De,...t},disabled:D.draggable}),ne=ge(z,P),x=!!C,X=x&&!T&&E(b)&&E(m),_=!O&&A,G=_&&X?re:null,se=X?G??(i??R)({rects:y,activeNodeRect:Q,activeIndex:b,overIndex:m,index:p}):null,w=E(b)&&E(m)?a({id:o,items:c,activeIndex:b,overIndex:m}):p,h=C?.id,l=g.useRef({activeId:h,items:c,newIndex:w,containerId:v}),oe=c!==l.current.items,Y=n({active:C,containerId:v,isDragging:A,isSorting:x,id:o,index:p,items:c,newIndex:l.current.newIndex,previousItems:l.current.items,previousContainerId:l.current.containerId,transition:u,wasDragging:l.current.activeId!=null}),L=Se({disabled:!Y,index:p,node:$,rect:M});return g.useEffect(()=>{x&&l.current.newIndex!==w&&(l.current.newIndex=w),v!==l.current.containerId&&(l.current.containerId=v),c!==l.current.items&&(l.current.items=c)},[x,w,v,c]),g.useEffect(()=>{if(h===l.current.activeId)return;if(h!=null&&l.current.activeId==null){l.current.activeId=h;return}const ie=setTimeout(()=>{l.current.activeId=h},50);return()=>clearTimeout(ie)},[h]),{active:C,activeIndex:b,attributes:W,data:S,rect:M,index:p,newIndex:w,items:c,isOver:U,isSorting:x,isDragging:A,listeners:Z,node:$,overIndex:m,over:ee,setNodeRef:ne,setActivatorNodeRef:te,setDroppableNodeRef:z,setDraggableNodeRef:P,transform:L??se,transition:ae()};function ae(){if(L||oe&&l.current.newIndex===p)return Re;if(!(_&&!pe(J)||!u)&&(x||Y))return F.Transition.toString({...u,property:K})}}function Ce(e,n){var t,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(t=e?.draggable)!=null?t:n.draggable,droppable:(r=e?.droppable)!=null?r:n.droppable}}export{Ae as S,H as a,Le as u,Ne as v};
